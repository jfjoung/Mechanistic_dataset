class_reaction_templates={
    ('Carboxylic acid + amine condensation',):
    {'Condensation using DCC': {'Reagent': ['[N]=[C]=[N]','[#8]=[#6]-[#8]','[#7]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[#6:2]-[N;H0;+0:3]=[C;H0;+0:4]=[N;H0;+0:5]-[#6:6].[O;H1;+0:1]-[C;H0;+0:14](-[#6:13])=[O:15]>>[#6:2]-[N;H1;+1:3]=[C;H0;+0:4]=[N;H0;+0:5]-[#6:6].[O;H0;-1:1]-[C;H0;+0:14](-[#6:13])=[O:15]'],
     'pKa': [None],
     'Description': 'Proton exchange'},

    1: {'Templates': ['[#6:2]-[N;H1;+1:3]=[C;H0;+0:4]=[N;H0;+0:5]-[#6:6].[O;H0;-1:1]-[C;H0;+0:14](-[#6:13])=[O:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14](-[#6:13])=[O:15])=[N;H0;+0:5]-[#6:6]'],
     'pKa': [None],
     'Description': 'Formation of a single bond between carboxylic acid and protonated DCC'},

    2: {'Templates': ['[*:7]-[N;H2;+0:8].[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14](-[#6:13])=[O:15])=[N;H0;+0:5]-[#6:6]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14]([N;H2;+1:8]-[*:7])(-[#6:13])-[O;-1:15])=[N;H0;+0:5]-[#6:6]',
      '[*:7]-[N;H1;+0:8].[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14](-[#6:13])=[O:15])=[N;H0;+0:5]-[#6:6]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14]([N;H1;+1:8]-[*:7])(-[#6:13])-[O;-1:15])=[N;H0;+0:5]-[#6:6]',
      '[*:7]-[O;H1;+0:8].[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14](-[#6:13])=[O:15])=[N;H0;+0:5]-[#6:6]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14]([O;H1;+1:8]-[*:7])(-[#6:13])-[O;-1:15])=[N;H0;+0:5]-[#6:6]'],
     'pKa': [None, None, None],
     'Description': 'Addition of amine (alcohol) into carboxylic acid-DCC complex'},

    3: {'Templates': ['[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14](-[#7;+1:8]-[*:7])(-[#6:13])-[O;-1:15])=[N;H0;+0:5]-[#6:6]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[#6:13]-[C;H0;+0:14](-[N;+1:8]-[*:7])=[O;+0:15]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14](-[#8;+1:8]-[*:7])(-[#6:13])-[O;-1:15])=[N;H0;+0:5]-[#6:6]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[#6:13]-[C;H0;+0:14](-[O;+1:8]-[*:7])=[O;+0:15]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14](-[#7;+1:8])(-[#6:13])-[O;-1:15])=[N;H0;+0:5]-[#6:6]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[#6:13]-[C;H0;+0:14](-[N;+1:8])=[O;+0:15]'],
     'pKa': [None, None, None],
     'Description': 'Cleavage into amide and urea'},
    4: {'Templates': ['[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H3;+1:8]-[*:7])(-[#6:13])=[O;+0:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H2;+0:8]-[*:7])(-[#6:13])=[O;+0:15]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H2;+1:8]-[*:7])(-[#6:13])=[O;+0:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H1;+0:8]-[*:7])(-[#6:13])=[O;+0:15]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H1;+1:8]-[*:7])(-[#6:13])=[O;+0:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H0;+0:8]-[*:7])(-[#6:13])=[O;+0:15]',

      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[#8;H1;+1:8]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[#8;H0;+0:8]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[C;H0;+0:14](-[#8;H1;+1:8])(-[#6:13])=[O;+0:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[C;H0;+0:14](-[#8;H0;+0:8])(-[#6:13])=[O;+0:15]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H3;+1:8])(-[#6:13])=[O;+0:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H2;+0:8])(-[#6:13])=[O;+0:15]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H2;+1:8])(-[#6:13])=[O;+0:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H1;+0:8])(-[#6:13])=[O;+0:15]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H1;+1:8])(-[#6:13])=[O;+0:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H0;+0:8])(-[#6:13])=[O;+0:15]'],
     'pKa': [None, None, None, None, None, None, None, None],
     'Description': 'Proton exchange between amide and urea'}}},


  'Condensation without catalyst': {'Reagent': ['[#8]-[#6]=[#8]','[#7]'], 'Exclude_reagent': ['[N]=[C]=[N]'],
'Stages': {0: {'Templates': ['[N;H3;+0:5].[O:1]-[C;H0;+0:14](-[#6:13])=[O:15]>>[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[N;H3;+1:5]',
                                '[N;H2;+0:5].[O:1]-[C;H0;+0:14](-[#6:13])=[O:15]>>[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[N;H2;+1:5]',
                                '[N;H1;+0:5].[O:1]-[C;H0;+0:14](-[#6:13])=[O:15]>>[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[N;H1;+1:5]',
                                ],
     'pKa': [None, None, None],
     'Description': 'Addition of amine into carboxylic acid'},
    1: {'Templates': ['[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;H3;+1:5]>>[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;H2;+0:5]',
      '[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;H2;+1:5]>>[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;H1;+0:5]',
      '[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;H1;+1:5]>>[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;H0;+0:5]'],
     'pKa': [{'B': 9}, {'B': 9}, {'B': 9}],
     'Description': 'Deprotonation of amine'},

    2: {'Templates': ['[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:2])-[N;+0:5]>>[#6:13]-[C;H0;+0:14](=[O;+0:15])-[N;+0:5].[O;-1:2]'],
     'pKa': [None],
     'Description': 'Hydroxide ion leaves'}}}},

 ('N-Boc deprotection',):
    {'Deprotection with OH-': {'Reagent': ['[O;H1;-1]','[#7]-[C](=[#8])-[#8]'], 'Exclude_reagent': None,
    'Reactive_site': 'NC(OC)=O',
   'Stages': {0: {'Templates': ['[O;+0:3]-[C:2](=[O;H0;+0:1])-[N;+0:8](-[#6:7]).[#8;H1;-1:5]>>[O;+0:3]-[C:2](-[O;H0;-1:1])(-[O;H1;+0:5])-[N;+0:8](-[#6:7])'],
     'pKa': [None],
     'Description': 'Addition of hydroxide ion'},
    1: {'Templates': ['[#6:4]-[O;H0;+0:3]-[C:2](-[O;H0;-1:1])(-[O:5])-[N;+0:8](-[#6:7])>>[#6:4]-[O;H0;-1:3].[C:2](=[O;H0;+0:1])(-[O:5])-[N;+0:8](-[#6:7])'],
     'pKa': [None],
     'Description': 'Alkoxide leaves'},
    2: {'Templates': ['[C:2](=[O;H0;+0:1])(-[O;H1;D1:5])-[N;+0:8](-[#6:7])>>[C:2](=[O;H0;+0:1])(-[O;H0;-1:5])-[N;+0:8](-[#6:7])'],
     'pKa': [{'B': 4.7}],
     'Description': 'Deprotonation of carboxylic acid'},

    3: {'Templates': ['[C:2](=[O;H0;+0:1])(-[O;H0;-1:5])-[N;+0:8](-[#6:7])>>[C:2](=[O;H0;+0:1])=[O;H0;+0:5].[N;-1:8](-[#6:7])'],
     'pKa': [None],
     'Description': 'Evolution of CO2 and production of amide anion'},

    4: {'Templates': ['[N;H1;-1:8](-[#6:7])>>[N;H2;+0:8](-[#6:7])',
      '[N;H0;-1:8](-[#6:7])>>[N;H1;+0:8](-[#6:7])'],
     'pKa': [{'A': 37}, {'A': 37}],
     'Description': 'Protonation of amide anion'}}},

  'Deprotection with Alkali hydroxide': {'Reagent': ['[Li,Na,K][O;H1]','[#7]-[C](=[#8])-[#8]'], 'Exclude_reagent': None,
    'Reactive_site': 'NC(OC)=O',
   'Stages': {0: {'Templates': ['[O;+0:3]-[C:2](=[O;H0;+0:1])-[N;+0:8](-[#6:7]).[Li,Na,K:9][O;H1;+0:5]>>[Li,Na,K;H0;+1:9].[O;+0:3]-[C:2](-[O;H0;-1:1])(-[O;H1;+0:5])-[N;+0:8](-[#6:7])'],
     'pKa': [None],
     'Description': 'Addition of hydroxide ion'},
    1: {'Templates': ['[#6:4]-[O;H0;+0:3]-[C:2](-[O;H0;-1:1])(-[O:5])-[N;+0:8](-[#6:7])>>[#6:4]-[O;H0;-1:3].[C:2](=[O;H0;+0:1])(-[O:5])-[N;+0:8](-[#6:7])'],
     'pKa': [None],
     'Description': 'Alkoxide leaves'},
    2: {'Templates': ['[C:2](=[O;H0;+0:1])(-[O;H1;D1:5])-[N;+0:8](-[#6:7])>>[C:2](=[O;H0;+0:1])(-[O;H0;-1:5])-[N;+0:8](-[#6:7])'],
     'pKa': [{'B': 4.7}],
     'Description': 'Deprotonation of carboxylic acid'},

    3: {'Templates': ['[C:2](=[O;H0;+0:1])(-[O;H0;-1:5])-[N;+0:8](-[#6:7])>>[C:2](=[O;H0;+0:1])=[O;H0;+0:5].[N;-1:8](-[#6:7])'],
     'pKa': [None],
     'Description': 'Evolution of CO2 and production of amide anion'},

    4: {'Templates': ['[N;H1;-1:8](-[#6:7])>>[N;H2;+0:8](-[#6:7])',
      '[N;H0;-1:8](-[#6:7])>>[N;H1;+0:8](-[#6:7])'],
     'pKa': [{'A': 37}, {'A': 37}],
     'Description': 'Protonation of amide anion'}}},

    'Acidic condition': {'Reagent': ['[#7]-[C](=[#8])-[#8]'],  'Exclude_reagent': None,
    'Reactive_site': '[#7][#6]([#8][#6])=[#8]',
    'Stages': {0: {'Templates': ['[#8;+0:3]-[#6:2](=[#8:1])-[#7;+0:8]>>[#8;H1;+1:3]-[#6:2](=[#8:1])-[#7;+0:8]',
                               '[#8;+0:3]-[#6:2](=[#8;H0;+0:1])-[#7;+0:8]>>[#8;+0:3]-[#6:2](=[#8;H1;+1:1])-[#7;+0:8]'],
     'pKa': [{'A': 0.001}, {'A': -6}],
     'Description': 'Protonation of ester or carbonyl oxygen'},
    1: {'Templates': ['[C;+0:4]-[O;H1;+1:3]-[C:2](=[O:1])-[N;+0:8](-[#6:7])>>[C;+1:4].[O;H1;+0:3]-[C:2](=[O:1])-[N;+0:8](-[#6:7])',
                   '[C;+0:4]-[O;H0;+0:3]-[C:2](=[O;H1;+1:1])-[N;+0:8](-[#6:7])>>[C;+1:4].[O;H0;+0:3]=[C:2](-[O;H1;+0:1])-[N;+0:8](-[#6:7])'],
                   'pKa': [None, None],
     'Description': 'Carbocation leaves'},

    2: {'Templates': ['[#6:2](=[#8;H0;+0:1])(-[#8;H1;+0:5])-[#7;+0:8]>>[#6:2](=[#8;H0;+0:1])(=[#8;H1;+1:5]).[#7;-1:8]'],
     'pKa': [None],
     'Description': 'HOCO leaves'},

    3: {'Templates': ['[#6:2](=[#8;H0;+0:1])(=[#8;H1;+1:5]).[#7;H0;-1:8]>>[#6:2](=[#8;H0;+0:1])(=[#8;H0;+0:5]).[#7;H1;+0:8]',
                     '[#6:2](=[#8;H0;+0:1])(=[#8;H1;+1:5]).[#7;H1;-1:8]>>[#6:2](=[#8;H0;+0:1])(=[#8;H0;+0:5]).[#7;H2;+0:8]'],
     'pKa': [None],
     'Description': 'Proton exchange'},
    4: {'Templates': ['[C;+1:1]-[C;H3;+0:2]>>[C;+0:1]=[C;H2;+0:2]',
                     '[C;+1:1].[Cl,Br,I,O;-1:2]>>[C;+0:1]-[Cl,Br,I,O;+0:2]'],
     'pKa': [{'B': -30}, None],
     'Description': 'E1 or SN1 type reaction',}
              }}},


 ('Williamson ether synthesis',):
    {'Reaction':
     {'Reagent': ['[#8]'], 'Exclude_reagent': None,
   'Stages': {0: {
       'Templates': [# Acidic pKa
                     '[#6:1]-[#8;H1;+0:2].[Cl,Br,I:4]-[C:5]>>[Cl,Br,I;H0;-1:4].[#6:1]-[#8;H1;+1:2]-[C:5]',
                     '[#6:1]-[#8;H1;+0:2].[O:3]=[S:4]([O:5]-[C:6])=[O:7]>>[O:3]=[S:4]([O;H0;-1:5])=[O:7].[#6:1]-[#8;H1;+1:2]-[C:6]',
                     #Basic pKa
                     '[#6:1]-[#8;H0,+0:2][Li,Na,K:3]>>[Li,Na,K;+1:3].[#6:1]-[#8;H0,-1:2]',
                     '[#6:1]-[#8;H1;+0:2]>>[#6:1]-[#8;H0;-1:2]',
                    ],
     'pKa': [None, None, None, {'B': 14}],
     'Description': 'Addition of alcohol under acidic condition / deprotonation of alcohol'},
        1: {
       'Templates': [# Acidic pKa
                     '[#6:1]-[#8;H1;+1:2]-[C:5]>>[#6:1]-[#8;H0;+0:2]-[C:5]',
                     # Neutral
                     '[#6:1]-[#8;H0;-1:2].[Cl,Br,I:4]-[C:5]>>[Cl,Br,I;H0;-1:4].[#6:1]-[#8;H0;+0:2]-[C:5]',
                     '[#6:1]-[#8;H0;-1:2].[O:3]=[S:4]([O:5]-[C:6])=[O:7]>>[O:3]=[S:4]([O;H0;-1:5])=[O:7].[#6:1]-[#8;H0;+0:2]-[C:6]',
                    ],
     'pKa': [{'B': -1.7}, None, None],
     'Description': 'Neutralization of protonated ether / Addition of alcohol under basic pKa'},
            }}},

 ('Bromo N-alkylation',
  'Chloro N-alkylation',
  'Iodo N-alkylation',): {'Reaction': {'Reagent': ['[#7]','[Cl,Br,I-C]'], 'Exclude_reagent': None,
   'Stages': {0:
             {'Templates': ['[N;H2;+0:1].[Cl,Br,I:2]-[C:3]>>[N;H2;+1:1]-[C:3].[Cl,Br,I;-1:2]',
                            '[N;H1;+0:1].[Cl,Br,I:2]-[C:3]>>[N;H1;+1:1]-[C:3].[Cl,Br,I;-1:2]',
                            '[n;H2;+0:1].[Cl,Br,I:2]-[C:3]>>[n;H2;+1:1]-[C:3].[Cl,Br,I;-1:2]',
                            '[n;H1;+0:1].[Cl,Br,I:2]-[C:3]>>[n;H1;+1:1]-[C:3].[Cl,Br,I;-1:2]'],
     'pKa': [None, None, None, None],
     'Description': 'Addition of amine'},

    1: {'Templates': ['[N;H2;+1:1]>>[N;H1;+0:1]',
      '[N;H1;+1:1]>>[N;H0;+0:1]',
      '[n;H2;+1:1]>>[n;H1;+0:1]',
      '[n;H1;+1:1]>>[n;H0;+0:1]'],
     'pKa': [{'B': 9.25}, {'B': 9.25}, {'B': 4.63}, {'B': 4.63}],
     'Description': 'Amine deprotonation'}}}},

 ('SNAr ether synthesis',):
    {'reaction with alcohol group': {'Reagent': ['[#8]','[c]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': [ #Basic pKa
                               '[#8;H1;+0:5][*:6]>>[#8;H0;-1:5][*:6]',
                              '[#8;H2;+0:5]>>[#8;H1;-1:5]',
                              '[#8;H1;+0:5][*:6].[Li,Na,K;+0:6]>>[#8;H0;-1:5][*:6].[Li,Na,K;+1:6]',
                              '[#8;H2;+0:5].[Li,Na,K;+0:6]>>[#8;H1;-1:5].[Li,Na,K;+1:6]'],
     'pKa': [{'B': 15.5}, {'B': 14}, None, None],
     'Description': 'Deprotonation of alcohol'},
    1: {'Templates': ['[*;a;+0:1]:[c;+0:2]-[F,Cl,Br,I:3].[*;+1:7][#8;-1;D2:5][*:6]>>[*;a;-1:1]:[c;+0:2]([F,Cl,Br,I:3])-[#8;+0:5][*:6].[*;+1:7]',
      '[*;a;+0:1]:[c;+0:2]-[F,Cl,Br,I:3].[#8;-1;D1:5][*:6]>>[*;a;-1:1]:[c;+0:2]([F,Cl,Br,I:3])-[#8;H0;+0:5][*:6]',
      '[*;a;+0:1]:[c;+0:2]-[F,Cl,Br,I:3].[#8;-1;H1:5]>>[*;a;-1:1]:[c;+0:2]([F,Cl,Br,I:3])-[#8;+0;H1:5]'],
     'pKa': [None, None, None],
     'Description': 'Addition to aromatic ring'},
    2: {'Templates': ['[*;a;-1:1]:[c;+0:2]([F,Cl,Br,I:3])-[#8;+0:5]>>[*;a;+0:1]:[c;+0:2]-[#8;+0:5].[F,Cl,Br,I;-1:3]'],
     'pKa': [None],
     'Description': 'Halide leaving'}}}},


 ('Aldehyde reductive amination',): {'Reaction': {'Reagent': ['[#6]=[#8]','[#7]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[C;H1;+0:1]=[O;+0:2]>>[C;H1;+0:1]=[OH1;+1:2]'],
     'pKa': [{'A': -2}],
     'Description': 'Protonation of aldehyde'},

    1: {'Templates': ['[C;H1;+0:1]=[OH1;+1:2].[N;H3;+0:3]>>[N;H3;+1:3]-[C;H1;+0:1]-[OH1;+0:2]',
      '[C;H1;+0:1]=[OH1;+1:2].[N;H2;+0:3]>>[N;H2;+1:3]-[C;H1;+0:1]-[OH1;+0:2]',
      '[C;H1;+0:1]=[OH1;+1:2].[N;H1;+0:3]>>[N;H1;+1:3]-[C;H1;+0:1]-[OH1;+0:2]',
      '[C;H1;+0:1]=[OH1;+1:2].[n;H3;+0:3]>>[n;H3;+1:3]-[C;H1;+0:1]-[OH1;+0:2]',
      '[C;H1;+0:1]=[OH1;+1:2].[n;H2;+0:3]>>[n;H2;+1:3]-[C;H1;+0:1]-[OH1;+0:2]',
      '[C;H1;+0:1]=[OH1;+1:2].[n;H1;+0:3]>>[n;H1;+1:3]-[C;H1;+0:1]-[OH1;+0:2]'],
     'pKa': [None, None, None, None, None, None],
     'Description': 'Addition of amine'},

    2: {'Templates': ['[#7;H3;+1:3]-[C;H1;+0:1]-[OH1;+0:2]>>[#7;H2;+0:3]-[C;H1;+0:1]-[OH2;+1:2]',
      '[#7;H2;+1:3]-[C;H1;+0:1]-[OH1;+0:2]>>[#7;H1;+0:3]-[C;H1;+0:1]-[OH2;+1:2]',
      '[#7;H1;+1:3]-[C;H1;+0:1]-[OH1;+0:2]>>[#7;H0;+0:3]-[C;H1;+0:1]-[OH2;+1:2]'],
     'pKa': [None, None, None],
     'Description': 'Proton exchange within the molecule'},

    3: {'Templates': ['[#7;H2;+0:3]-[C;H1;+0:1]-[OH2;+1:2]>>[#7;H2;+1:3]=[C;H1;+0:1].[OH2;+0:2]',
      '[#7;H1;+0:3]-[C;H1;+0:1]-[OH2;+1:2]>>[#7;H1;+1:3]=[C;H1;+0:1].[OH2;+0:2]',
      '[#7;H0;+0:3]-[C;H1;+0:1]-[OH2;+1:2]>>[#7;H0;+1:3]=[C;H1;+0:1].[OH2;+0:2]'],
     'pKa': [None, None, None],
     'Description': 'Water leaves'},

    4: {'Templates': ['[B,Al;H4;-1:4].[#7;H1;+1:3]=[C;H1;+0:1]>>[#7;H1;+0:3]-[C;H2;+0:1].[B,Al;H3;+0:4]',
      '[B,Al;H4;-1:4].[#7;H0;+1:3]=[C;H1;+0:1]>>[#7;H0;+0:3]-[C;H2;+0:1].[B,Al;H3;+0:4]',
      '[B,Al;H3;-1:4].[#7;H1;+1:3]=[C;H1;+0:1]>>[#7;H1;+0:3]-[C;H2;+0:1].[B,Al;H2;+0:4]',
      '[B,Al;H3;-1:4].[#7;H0;+1:3]=[C;H1;+0:1]>>[#7;H0;+0:3]-[C;H2;+0:1].[B,Al;H2;+0:4]',
      '[B,Al;H2;-1:4].[#7;H1;+1:3]=[C;H1;+0:1]>>[#7;H1;+0:3]-[C;H2;+0:1].[B,Al;H1;+0:4]',
      '[B,Al;H2;-1:4].[#7;H0;+1:3]=[C;H1;+0:1]>>[#7;H0;+0:3]-[C;H2;+0:1].[B,Al;H1;+0:4]',
      '[B,Al;H1;-1:4].[#7;H1;+1:3]=[C;H1;+0:1]>>[#7;H1;+0:3]-[C;H2;+0:1].[B,Al;H0;+0:4]',
      '[B,Al;H1;-1:4].[#7;H0;+1:3]=[C;H1;+0:1]>>[#7;H0;+0:3]-[C;H2;+0:1].[B,Al;H0;+0:4]'],
     'pKa': [None, None, None, None, None, None, None, None],
     'Description': 'Reduction by borohydride or Alumanuide'}}}},



 ('N-Boc protection',): {'Reaction': {'Reagent':['[#7]','[#8]-[#6](=[#8])-[#8]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[N;!H0;+0:2].[C:10]-[O:3]-[C;H0;+0:4](=[O;+0:5])-[O:6]-[C;H0;+0:7](=[O;+0:8])-[O;+0:9]-[C:11]>>[N;+1:2]-[C;H0;+0:4](=[O;+0:5])-[O;+0:3]-[C:10].[O;-1:6]-[C;H0;+0:7](=[O;+0:8])-[O;+0:9]-[C:11]'],
     'pKa': [None],
     'Description': 'Amine reacted with dicarbonate'},
    1: {'Templates': ['[O;-1:6]-[C;H0;+0:7](=[O;+0:8])-[O;+0:9]-[C:11]>>[O;+0:6]=[C;H0;+0:7]=[O;+0:8].[O;-1:9]-[C:11]'],
     'pKa': [None],
     'Description': 'Carbon dioxide released'},
    2: {'Templates': ['[N;H3;+1:2]-[C;H0;+0:4](=[O;+0:5])[O;+0:3].[O;-1:9]-[C:11]>>[N;H2;+0:2]-[C;H0;+0:4](=[O;+0:5])[O;+0:3].[O;H1;+0:9]-[C:11]',
      '[N;H2;+1:2]-[C;H0;+0:4](=[O;+0:5])[O;+0:3].[O;-1:9]-[C:11]>>[N;H1;+0:2]-[C;H0;+0:4](=[O;+0:5])[O;+0:3].[O;H1;+0:9]-[C:11]',
      '[N;H1;+1:2]-[C;H0;+0:4](=[O;+0:5])[O;+0:3].[O;-1:9]-[C:11]>>[N;H0;+0:2]-[C;H0;+0:4](=[O;+0:5])[O;+0:3].[O;H1;+0:9]-[C:11]'],
     'pKa': [None, None, None],
     'Description': 'Proton exchange'}}}},



 ('Carboxylic ester + amine reaction',): {'Reaction': {'Reagent': ['[#7]','[#6]-[#8]-[#6]=[#8]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates':
                 ['[#7;H3;+0:5].[O:1]-[C;H0;+0:14](-[#6:13])=[O:15]>>[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;H3;+1:5]',
                  '[#7;H2;+0:5].[O:1]-[C;H0;+0:14](-[#6:13])=[O:15]>>[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;H2;+1:5]',
                  '[#7;H1;+0:5].[O:1]-[C;H0;+0:14](-[#6:13])=[O:15]>>[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;H1;+1:5]',
                 ],
     'pKa': [None, None, None],
     'Description': 'Addition of amine to carbonyl'},

    1: {'Templates': ['[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;H3;+1:5]>>[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;H2;+0:5]',
      '[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;H2;+1:5]>>[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;H1;+0:5]',
      '[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;H1;+1:5]>>[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;H0;+0:5]'],
     'pKa': [{'B': 9.25}, {'B': 9.25}, {'B': 9.25}],
     'Description': 'Deprotonation of amine'},
    2: {'Templates': ['[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:2])-[N;+0:5]>>[#6:13]-[C;H0;+0:14](=[O;+0:15])-[N;+0:5].[O;-1:2]'],
     'pKa': [None],
     'Description': 'Alkoxide leaving'}}}},

 ('Carboxy to carbamoyl',): {'Condensation using DCC': {'Reagent': ['[N]=[C]=[N]','[#7]','[#8]-[#6]=[#8]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[#7;H4;+1:5]>>[#7;H3;+0:5]',
      '[#7;H3;+1:5]>>[#7;H2;+0:5]',
      '[#7;H2;+1:5]>>[#7;H1;+0:5]',
      '[#7;H1;+1:5]>>[#7;H0;+0:5]'],
     'pKa': [ {'B': 9.25}, {'B': 9.25}, {'B': 9.25}, {'B': 9.25}],
     'Description': 'Deprotonation of amine'},

    1: {'Templates': ['[#6:2]-[N;H0;+0:3]=[C;H0;+0:4]=[N;H0;+0:5]-[#6:6].[O;H1;+0:1]-[C;H0;+0:14](-[#6:13])=[O:15]>>[#6:2]-[N;H1;+1:3]=[C;H0;+0:4]=[N;H0;+0:5]-[#6:6].[O;H0;-1:1]-[C;H0;+0:14](-[#6:13])=[O:15]'],
     'pKa': [None],
     'Description': 'Proton exchange'},

    2: {'Templates': ['[#6:2]-[N;H1;+1:3]=[C;H0;+0:4]=[N;H0;+0:5]-[#6:6].[O;H0;-1:1]-[C;H0;+0:14](-[#6:13])=[O:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14](-[#6:13])=[O:15])=[N;H0;+0:5]-[#6:6]'],
     'pKa': [None],
     'Description': 'Formation of a single bond between carboxylic acid and protonated DCC'},

    3: {'Templates': ['[N;H3;+0:8].[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14](-[#6:13])=[O:15])=[N;H0;+0:5]-[#6:6]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14]([N;H3;+1:8])(-[#6:13])-[O;-1:15])=[N;H0;+0:5]-[#6:6]',
        '[*:7]-[N;H2;+0:8].[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14](-[#6:13])=[O:15])=[N;H0;+0:5]-[#6:6]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14]([N;H2;+1:8]-[*:7])(-[#6:13])-[O;-1:15])=[N;H0;+0:5]-[#6:6]',
      '[*:7]-[N;H1;+0:8].[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14](-[#6:13])=[O:15])=[N;H0;+0:5]-[#6:6]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14]([N;H1;+1:8]-[*:7])(-[#6:13])-[O;-1:15])=[N;H0;+0:5]-[#6:6]',],
     'pKa': [None, None],
     'Description': 'Addition of amine (alcohol) into carboxylic acid-DCC complex'},

    4: {'Templates': ['[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14](-[#7;+1:8]-[*:7])(-[#6:13])-[O;-1:15])=[N;H0;+0:5]-[#6:6]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[#6:13]-[C;H0;+0:14](-[N;+1:8]-[*:7])=[O;+0:15]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14](-[#7;+1:8])(-[#6:13])-[O;-1:15])=[N;H0;+0:5]-[#6:6]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[#6:13]-[C;H0;+0:14](-[N;+1:8])=[O;+0:15]'],
     'pKa': [None,  None],
     'Description': 'Cleavage into amide and urea'},
    5: {'Templates': ['[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H3;+1:8]-[*:7])(-[#6:13])=[O;+0:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H2;+0:8]-[*:7])(-[#6:13])=[O;+0:15]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H2;+1:8]-[*:7])(-[#6:13])=[O;+0:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H1;+0:8]-[*:7])(-[#6:13])=[O;+0:15]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H1;+1:8]-[*:7])(-[#6:13])=[O;+0:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H0;+0:8]-[*:7])(-[#6:13])=[O;+0:15]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H3;+1:8])(-[#6:13])=[O;+0:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H2;+0:8])(-[#6:13])=[O;+0:15]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H2;+1:8])(-[#6:13])=[O;+0:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H1;+0:8])(-[#6:13])=[O;+0:15]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H1;+1:8])(-[#6:13])=[O;+0:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H0;+0:8])(-[#6:13])=[O;+0:15]'],
     'pKa': [None, None, None, None, None, None],
     'Description': 'Proton exchange between amide and urea'}}},

  'Condensation without catalyst': {'Reagent': ['[#7]','[#8]-[#6]=[#8]'], 'Exclude_reagent': ['[N]=[C]=[N]'],
   'Stages': {0: {'Templates': ['[#7;H4;+1:5]>>[#7;H3;+0:5]',
      '[#7;H3;+1:5]>>[#7;H2;+0:5]',
      '[#7;H2;+1:5]>>[#7;H1;+0:5]',
      '[#7;H1;+1:5]>>[#7;H0;+0:5]'],
     'pKa': [ {'B': 9.25}, {'B': 9.25}, {'B': 9.25}, {'B': 9.25}],
     'Description': 'Deprotonation of amine'},
    1: {'Templates': ['[*:4]-[#7;!H0;+0:5].[O:1]-[C;H0;+0:14](-[#6:13])=[O:15]>>[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;+1:5]-[*:4]',
      '[#7;!H0;+0:5].[O:1]-[C;H0;+0:14](-[#6:13])=[O:15]>>[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;+1:5]'],
     'pKa': [None, None],
     'Description': 'Addition of amine into carboxylic acid'},

    2: {'Templates': ['[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;H3;+1:5]>>[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;H2;+0:5]',
      '[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;H2;+1:5]>>[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;H1;+0:5]',
      '[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;H1;+1:5]>>[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;H0;+0:5]'],
     'pKa': [{'B': 9.25}, {'B': 9.25}, {'B': 9.25}],
     'Description': 'Deprotonation of amine'},

    3: {'Templates': ['[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:2])-[N;+0:5]>>[#6:13]-[C;H0;+0:14](=[O;+0:15])-[N;+0:5].[O;-1:2]'],
     'pKa': [None],
     'Description': 'Hydroxide ion leaves'}}}},

 ('Esterification',
 'Steglich esterification',
 'Fischer-Speier esterification',): {'Condensation using DCC': {'Reagent': ['[N]=[C]=[N]','[#8]-[#6]','[#8]-[#6]=[#8]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[#6:2]-[N;H0;+0:3]=[C;H0;+0:4]=[N;H0;+0:5]-[#6:6].[O;H1;+0:1]-[C;H0;+0:14](-[#6:13])=[O:15]>>[#6:2]-[N;H1;+1:3]=[C;H0;+0:4]=[N;H0;+0:5]-[#6:6].[O;H0;-1:1]-[C;H0;+0:14](-[#6:13])=[O:15]'],
     'pKa': [None],
     'Description': 'Proton exchange'},
    1: {'Templates': ['[#6:2]-[N;H1;+1:3]=[C;H0;+0:4]=[N;H0;+0:5]-[#6:6].[O;H0;-1:1]-[C;H0;+0:14](-[#6:13])=[O:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14](-[#6:13])=[O:15])=[N;H0;+0:5]-[#6:6]'],
     'pKa': [None],
     'Description': 'Formation of a single bond between carboxylic acid and protonated DCC'},
    2: {'Templates': ['[*:7]-[N;H2;+0:8].[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14](-[#6:13])=[O:15])=[N;H0;+0:5]-[#6:6]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14]([N;H2;+1:8]-[*:7])(-[#6:13])-[O;-1:15])=[N;H0;+0:5]-[#6:6]',
      '[*:7]-[N;H1;+0:8].[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14](-[#6:13])=[O:15])=[N;H0;+0:5]-[#6:6]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14]([N;H1;+1:8]-[*:7])(-[#6:13])-[O;-1:15])=[N;H0;+0:5]-[#6:6]',
      '[*:7]-[O;H1;+0:8].[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14](-[#6:13])=[O:15])=[N;H0;+0:5]-[#6:6]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14]([O;H1;+1:8]-[*:7])(-[#6:13])-[O;-1:15])=[N;H0;+0:5]-[#6:6]'],
     'pKa': [None, None, None],
     'Description': 'Addition of amine (alcohol) into carboxylic acid-DCC complex'},
    3: {'Templates': ['[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14](-[#7;+1:8]-[*:7])(-[#6:13])-[O;-1:15])=[N;H0;+0:5]-[#6:6]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[#6:13]-[C;H0;+0:14](-[N;+1:8]-[*:7])=[O;+0:15]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14](-[#8;+1:8]-[*:7])(-[#6:13])-[O;-1:15])=[N;H0;+0:5]-[#6:6]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[#6:13]-[C;H0;+0:14](-[O;+1:8]-[*:7])=[O;+0:15]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14](-[#7;+1:8])(-[#6:13])-[O;-1:15])=[N;H0;+0:5]-[#6:6]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[#6:13]-[C;H0;+0:14](-[N;+1:8])=[O;+0:15]'],
     'pKa': [None, None, None],
     'Description': 'Cleavage into ester and urea'},
    4: {'Templates': ['[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H3;+1:8]-[*:7])(-[#6:13])=[O;+0:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H2;+0:8]-[*:7])(-[#6:13])=[O;+0:15]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H2;+1:8]-[*:7])(-[#6:13])=[O;+0:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H1;+0:8]-[*:7])(-[#6:13])=[O;+0:15]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H1;+1:8]-[*:7])(-[#6:13])=[O;+0:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H0;+0:8]-[*:7])(-[#6:13])=[O;+0:15]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[#8;H1;+1:8]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[#8;H0;+0:8]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[C;H0;+0:14](-[#8;H1;+1:8])(-[#6:13])=[O;+0:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[C;H0;+0:14](-[#8;H0;+0:8])(-[#6:13])=[O;+0:15]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H3;+1:8])(-[#6:13])=[O;+0:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H2;+0:8])(-[#6:13])=[O;+0:15]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H2;+1:8])(-[#6:13])=[O;+0:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H1;+0:8])(-[#6:13])=[O;+0:15]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H1;+1:8])(-[#6:13])=[O;+0:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H0;+0:8])(-[#6:13])=[O;+0:15]'],
     'pKa': [None, None, None, None, None, None, None, None],
     'Description': 'Proton exchange between ester and urea'}}},
  'Esterification': {'Reagent': ['[C](=[O])-[O;H1]','[#6]-[#8]'], 'Exclude_reagent': None,
                                 # Acidic condition
   'Stages': {0: {'Templates': ['[O;H0;+0:1]=[C;H0;+0:2]>>[O;H1;+1:1]=[C;H0;+0:2]',
                               #Basic condition
                               '[O;H1;+0:1]-[C;H0;+0:2]>>[O;H0;-1:1]-[C;H0;+0:2]'],
     'pKa': [{'A': -6}, {'B': 14}],
     'Description': 'Protonation of carbonyl or deprotonation of alcohol'},

                     #Acidic condition
    1: {'Templates': ['[O;H1;+1:1]=[C;H0;+0:2].[O;H1;+0:4]-[#6;+0:5]>>[O;H1;+0:1]-[C;H0;+0:2]-[O;H1;+1:4]-[#6;+0:5]',
                     #Basic condition
                     '[O;H0;+0:1]=[C;H0;+0:2].[O;H0;-1:4][#6;+0:5]>>[O;H0;-1:1]-[C;H0;+0:2][O;H0;+0:4][#6;+0:5]',
                     ],
     'pKa': [None, None],
     'Description': 'Alcohol addition to carbonyl'},
                         #Acidic condition
    2: {'Templates': ['[O;H1;+0:1]-[C;H0;+0:2](-[O;H1;+0:3])-[O;H1;+1:4]-[#6;+0:5]>>[O;H1;+0:1]-[C;H0;+0:2](-[O;H2;+1:3])-[O;H0;+0:4]-[#6;+0:5]',
                       #Basic condition
                     '[O;H0;-1:1]-[C;H0;+0:2](-[O;H1;+0:3])-[O;H0;+0:4]-[#6;+0:5]>>[O;H1;+0:1]-[C;H0;+0:2](-[O;H1;+0:3])-[O;H0;+0:4]-[#6;+0:5]',
                     ],
     'pKa': [None, {'A': 14}],
     'Description': 'Protonation or deprotonation of complex'},

    3: {'Templates': ['[O;H1;+0:1]-[C;H0;+0:2](-[O;H2;+1:3])-[O;H0;+0:4]-[#6;+0:5]>>[O;H1;+1:1]=[C;H0;+0:2]-[O;H0;+0:4]-[#6;+0:5].[O;H2;+0:3]',
                     '[O;H1;+0:1]-[C;H0;+0:2](-[O;H1;+0:3])-[O;H0;+0:4]-[#6;+0:5]>>[O;H1;+1:1]=[C;H0;+0:2]-[O;H0;+0:4]-[#6;+0:5].[O;H1;-1:3]'
                     ],
     'pKa': [None, None],
     'Description': 'Water or hydroxide ion leaving'},
    4: {'Templates': ['[O;H1;+1:1]=[C;H0;+0:2]-[O;H0;+0:4]-[#6;+0:5]>>[O;H0;+0:1]=[C;H0;+0:2]-[O;H0;+0:4]-[#6;+0:5]',
                     '[O;H1;+1:1]=[C;H0;+0:2]-[O;H0;+0:4]-[#6;+0:5].[O;H1;-1:3]>>[O;H0;+0:1]=[C;H0;+0:2]-[O;H0;+0:4]-[#6;+0:5].[O;H2;+0:3]'
                     ],
     'pKa': [{'B': -6}, None],
     'Description': 'Proton exchange'}}},
  'Williamson ether synthesis type': {'Reagent': ['[Cl,Br,I,S&$([S](=O)(-O))]-[C]'], 'Exclude_reagent': ['[N]=[C]=[N]'],
   'Stages': {0: {'Templates': [# Acidic pKa
                     '[#6:1]-[#8;H1;+0:2].[Cl,Br,I:4]-[C:5]>>[Cl,Br,I;H0;-1:4].[#6:1]-[#8;H1;+1:2]-[C:5]',
                     '[#6:1]-[#8;H1;+0:2].[O:3]=[S:4]([O:5]-[C:6])=[O:7]>>[O:3]=[S:4]([O;H0;-1:5])=[O:7].[#6:1]-[#8;H1;+1:2]-[C:6]',
                     #Basic pKa
                     '[#6:1]-[#8;H0,+0:2][Li,Na,K:3]>>[Li,Na,K;+1:3].[#6:1]-[#8;H0,-1:2]',
                     '[#6:1]-[#8;H1;+0:2]>>[#6:1]-[#8;H0;-1:2]',
                    ],
     'pKa': [None, None, None, {'B': 15.5}],
     'Description': 'Addition of alcohol under the acidic conditions / deprotonation of alcohol'},
        1: {'Templates': [# Acidic pKa
                     '[#6:1]-[#8;H1;+1:2]-[C:5]>>[#6:1]-[#8;H0;+0:2]-[C:5]',
                     # Neutral
                     '[#6:1]-[#8;H0;-1:2].[Cl,Br,I:4]-[C:5]>>[Cl,Br,I;H0;-1:4].[#6:1]-[#8;H0;+0:2]-[C:5]',
                     '[#6:1]-[#8;H0;-1:2].[O:3]=[S:4]([O:5]-[C:6])=[O:7]>>[O:3]=[S:4]([O;H0;-1:5])=[O:7].[#6:1]-[#8;H0;+0:2]-[C:6]',
                    ],
     'pKa': [{'B': -2}, None, None],
     'Description': 'Neutralization of protonated ester / Addition of alcohol under the basic conditions'}}}},


 ('Methoxy to hydroxy',):
    {'Demethylation using BBr3':
     {'Reagent': ['[Cl,Br]-[B]','[#6]-[#8]-[#6]'], 'Exclude_reagent': None,
       'Stages': {0: {'Templates': ['[O;D2;H0;+0:1]-[C:2].[Cl,Br:3][B:4]>>[C:2]-[O;H0;+1:1]-[B;-1:4]([Cl,Br:3])'],
         'pKa': [None],
         'Description': 'BBr3 addition'},
        1: {'Templates': ['[C:2]-[O;H0;+1:1]-[B;-1:4][Cl,Br:3]>>[C:2]-[O;H0;+1:1]-[B;+0:4].[Cl,Br;-1:3]'],
         'pKa': [None],
         'Description': 'Halide leaving'},
        2: {'Templates': ['[C:2]-[O;H0;+1:1]-[B;+0:4].[Cl,Br;-1:3]>>[O;D2;H0;+0:1]-[B;+0:4].[C:2]-[Cl,Br;+0:3]'],
         'pKa': [None],
         'Description': 'SN2 type alkyl halide leaving'},

        3: {'Templates': ['[O;H0;+0:1]-[B;+0:4].[O;H2;+0:6]>>[O;H0;-1:1].[O;H2;+1:6]-[B;+0:4]',
                          '[O;H0;+0:1]-[B;+0:4].[O;H1;+0:6]-[C:7]>>[O;H0;-1:1].[C:7]-[O;H1;+1:6]-[B;+0:4]'],
         'pKa': [None, None],
         'Description': 'Addition of water'},
        4: {'Templates': ['[O;H0;-1:1].[O;H2;+1:6]-[B;+0:4]>>[O;H1;+0:1].[O;H1;+0:6]-[B;+0:4]',
                          '[O;H0;-1:1].[C:7]-[O;H1;+1:6]-[B;+0:4]>>[O;H1;+0:1].[C:7]-[O;H0;+0:6]-[B;+0:4]'],
         'pKa': [None, None],
         'Description': 'Proton exchange'}}},
  'Ether acidic cleavage':
    {'Reagent': ['[Cl,Br,I;H1]','[#6]-[#8]-[#6]'], 'Exclude_reagent': None,
       'Stages': {0: {'Templates': ['[#6:1]-[O;+0:2]-[C;+0:3].[Cl,Br,I;H1;+0:4]>>[#6:1]-[O;H1;+1:2]-[C;+0:3].[Cl,Br,I;H0;-1:4]'],
         'pKa': [None],
         'Description': 'Proton exchange between ether and hydrohalic acid'},
                          #SN2 type
        1: {'Templates': ['[#6;D1,D2:1]-[O;H1;+1:2]-[C;D1,D2;+0:3].[Cl,Br,I;H0;-1:4]>>[#6;D1,D2:1]-[O;H1;+0:2].[C;D1,D2;+0:3]-[Cl,Br,I;H0;+0:4]',
                          #SN1 type
                          '[#6;D3:1]-[O;H1;+1:2]-[C;+0:3]>>[#6;D3;+1:1].[O;H1;+0:2]-[C;+0:3]'],
         'pKa': [None],
         'Description': 'Cleavage of ether'},
        2: {'Templates': ['[#6;D3;+1:1].[Cl,Br,I;H0;-1:2]>>[#6;D3;+0:1]-[Cl,Br,I;H0;+0:2]'],
         'pKa': [None],
         'Description': 'SN1 type addition of halide'}}}},


 ('Ester to alcohol reduction',): {'Ester reduction using hydride': {'Reagent': ['[Al,B;!H0]','[#6]-[#6](=[#8])-[#8]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[Li,Na:1][Al,B;H1,H2,H3,H4;+0:2]>>[Li,Na;+1:1].[Al,B;H1,H2,H3,H4;-1:2]'],
     'pKa': [None],
     'Description': 'Preparation of Borohydride or Alumanuide'},

    1: {'Templates': ['[Al,B;H4;-1:2].[#6;+0:4](=[O;+0:5])-[O;+0:6]>>[Al,B;H3;+0:2].[#6;H1;+0:4](-[O;H0;-1:5])-[O;+0:6]',
      '[Al,B;H3;-1:2].[#6;+0:4](=[O;+0:5])-[O;+0:6]>>[Al,B;H2;+0:2].[#6;H1;+0:4](-[O;H0;-1:5])-[O;+0:6]',
      '[Al,B;H2;-1:2].[#6;+0:4](=[O;+0:5])-[O;+0:6]>>[Al,B;H1;+0:2].[#6;H1;+0:4](-[O;H0;-1:5])-[O;+0:6]',
      '[Al,B;H1;-1:2].[#6;+0:4](=[O;+0:5])-[O;+0:6]>>[Al,B;H0;+0:2].[#6;H1;+0:4](-[O;H0;-1:5])-[O;+0:6]'],
     'pKa': [None, None, None, None],
     'Description': 'Hydride transfer'},
    2: {'Templates': ['[#6;H1;+0:4](-[O;H0;-1:5])-[O;H0;+0:6]>>[#6;H1;+0:4](=[O;H0;+0:5]).[O;H0;-1:6]',
                     '[#6;H1;+0:4](-[O;H0;-1:5])-[O;H1;+0:6]>>[#6;H1;+0:4](=[O;H0;+0:5]).[O;H1;-1:6]'],
     'pKa': [None, None],
     'Description': 'hydroxide or alkoxide leaving'},
    3: {'Templates': ['[Al,B;H4;-1:2].[#6;H1;+0:4](=[O;H0;+0:5])>>[Al,B;H3;+0:2].[#6;H2;+0:4](-[O;H0;-1:5])',
      '[Al,B;H3;-1:2].[#6;H1;+0:4](=[O;H0;+0:5])>>[Al,B;H2;+0:2].[#6;H2;+0:4](-[O;H0;-1:5])',
      '[Al,B;H2;-1:2].[#6;H1;+0:4](=[O;H0;+0:5])>>[Al,B;H1;+0:2].[#6;H2;+0:4](-[O;H0;-1:5])',
      '[Al,B;H1;-1:2].[#6;H1;+0:4](=[O;H0;+0:5])>>[Al,B;H0;+0:2].[#6;H2;+0:4](-[O;H0;-1:5])'],
     'pKa': [None, None, None, None],
     'Description': 'Additional hydride transfer'},  ## This steps requires 2 equiv of hydride

    4: {'Templates': ['[#6;H2;+0:4]-[O;H0;-1:5]>>[#6;H2;+0:4]-[O;H1;+0:5]'],
     'pKa': [{'A': 15.5}],
     'Description': 'Protonation of alcohol'}}}},

    # Modified by Jihye
('Bromo Suzuki coupling',
  'Chloro Suzuki coupling',
  'Iodo Suzuki coupling',
  'Bromo Buchwald-Hartwig amination',
  'Chloro Buchwald-Hartwig amination',
  'Iodo Buchwald-Hartwig amination',
  'Bromo Miyaura boration',
  'Chloro Miyaura boration',
  'Triflyloxy Miyaura boration',
  'Iodo Miyaura boration',):

    {'Reaction with element Pd':
     {'Reagent': ['[Pd;D0;+0]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[Cl,Br,I,O$([O]-S):7]-[#6;+0:5].[Pd;D0;+0:6]>>[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]'],
     'pKa': [None],
     'Description': 'Oxidative addition'},
    1: {'Templates': ['[#8;+0;H2:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);H1;+0:7].[#8;H1;+0:8]-[Pd:6]-[#6;+0:5]',
      '[#6&!$([#6]=O):10][#8;H1:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);H1;+0:7].[#6:10][#8;H0;+0:8]-[Pd:6]-[#6;+0:5]',
      '[Li,Na,K,Cs:10][#8:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);-1:7].[Li,Na,K,Cs;+1:10].[#8:8]-[Pd:6]-[#6;+0:5]',
      '[#6&!$([#6]=O):9]-[#8;-1:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);-1:7].[#6:9]-[#8;+0:8]-[Pd:6]-[#6;+0:5]'],
     'pKa': [None, None, None, None],
     'Description': 'Halide leaving'},
                     #Suzuki
    2: {'Templates': ['[#5:2]-[#6;+0:4].[#8:8]-[Pd:6]-[#6;+0:5]>>[#6;+0:4]-[Pd:6]-[#6;+0:5].[#5:2]-[#8;+0:8]',
                      #Buchwald-Hartwig amination
                     '[#7;H3;+0:1].[#8;H1:8]-[Pd:6]-[#6;+0:5]>>[#7;H2;+0:1]-[Pd:6]-[#6;+0:5].[#8;H2;+0:8]',
                      '[#7;H2;+0:1].[#8;H1:8]-[Pd:6]-[#6;+0:5]>>[#7;H1;+0:1]-[Pd:6]-[#6;+0:5].[#8;H2;+0:8]',
                      '[#7;H1;+0:1].[#8;H1:8]-[Pd:6]-[#6;+0:5]>>[#7;H0;+0:1]-[Pd:6]-[#6;+0:5].[#8;H2;+0:8]',
                      '[#7;H3;+0:1].[#8;H0:8]-[Pd:6]-[#6;+0:5]>>[#7;H2;+0:1]-[Pd:6]-[#6;+0:5].[#8;H1;+0:8]',
                      '[#7;H2;+0:1].[#8;H0:8]-[Pd:6]-[#6;+0:5]>>[#7;H1;+0:1]-[Pd:6]-[#6;+0:5].[#8;H1;+0:8]',
                      '[#7;H1;+0:1].[#8;H0:8]-[Pd:6]-[#6;+0:5]>>[#7;H0;+0:1]-[Pd:6]-[#6;+0:5].[#8;H1;+0:8]',
                      #Miyaura boration
                      '[*:2]-[Pd:1]-[Cl,Br,I:3].[B;+0:4]-[B;+0:5]>>[*:2]-[Pd:1]-[B;+0:4].[Cl,Br,I;+0:3]-[B;+0:5]',
                      '[*:2]-[Pd:1]-[O;D2:3]-[S:6].[B;+0:4]-[B;+0:5]>>[*:2]-[Pd:1]-[B;+0:4].[B;+0:5]-[O;D2:3]-[S:6]',
                     ],
     'pKa': [None, None, None, None, None, None, None, None, None],
     'Description': 'Transmetalation'},
    3: {'Templates': ['[#5,#6,#7;+0:4]-[Pd:6]-[#6;+0:5]>>[#5,#6,#7;+0:4]-[#6;+0:5].[Pd:6]'],
     'pKa': [None],
     'Description': 'Reductive elimination'}}},

# Based on the mechanism described in https://chem.libretexts.org/Bookshelves/Inorganic_Chemistry/Supplemental_Modules_and_Websites_(Inorganic_Chemistry)/Catalysis/Catalyst_Examples/Heck_Reaction.
'Reaction with PdX2, PPh3, and water': {'Reagent': ['[Cl,Br,I,O][Pd;+0][Cl,Br,I,O]', '[P]', '[O;H1,H2]'], 'Exclude_reagent': None,
   'Stages': {
        0: {'Templates': ['[Cl,Br,I,O:2]-[Pd;+0:1](-[Cl,Br,I,O:3])(-[P;D4;+0:4])(-[P;D4;+0:5])>>[Cl,Br,I,O:2]-[Pd;+0:1](-[Cl,Br,I,O:3])-[P;D3;+0:4].[P;D3;+0:5]',
                            # '[Cl,Br,I,O:2]-[Pd;+0:1](-[Cl,Br,I,O:3])-[P;D4;+0:4]>>[Cl,Br,I,O:2]-[Pd;+0:1]-[Cl,Br,I,O:3].[P;D3;+0:4]',
                          ],
     'pKa': [None],
     'Description': 'Palladium-ligand dissociation'},
       1: {'Templates': ['[Cl,Br,I,O:2]-[Pd;+0:1]-[Cl,Br,I,O:3].[P;H0;D3:4]>>[Cl,Br,I,O:2]-[Pd;+0:1]-[P;H0;+1:4].[Cl,Br,I,O;-1:3]'],
     'pKa': [None],
     'Description': 'Palladium-ligand formation'},
      2: {'Templates': ['[OH2:1]>>[OH1;-1:1]'],
     'pKa': [{'B': 14}],
     'Description': 'Hydroxide ion preparation'},
       3: {'Templates': ['[Cl,Br,I,O:2]-[Pd;+0:1]-[P;H0;+1:4].[OH1;-1:5]>>[Cl,Br,I,O:2]-[Pd;+0:1]-[P;H0;+0:4]-[OH1;+0:5]',
                         '[Cl,Br,I,O:2]-[Pd;+0:1]-[P;H0;+1:4].[OH2;+0:5]>>[Cl,Br,I,O:2]-[Pd;+0:1]-[P;H0;+0:4]-[OH2;+1:5]'],
     'pKa': [None, None],
     'Description': 'Hydroxide-Phosphine reaction'},
    4: {'Templates': ['[Cl,Br,I,O:2]-[Pd;+0:1]-[P;H0;+0:4]-[OH2;+1:5]>>[Cl,Br,I,O:2]-[Pd;+0:1]-[P;H0;+0:4]-[OH1;+0:5]'],
     'pKa': [{'B': -1.7}],
     'Description': 'Deprotonation'},

     5: {'Templates': ['[Cl,Br,I,O:2]-[Pd;H0;+0:1]-[P;H0;+0:4]-[OH1;+0:5]>>[Cl,Br,I,O:2]-[Pd;H1;+0:1].[P;H0;+0:4]=[OH0;+0:5]'],
     'pKa': [None],
     'Description': 'Palladium reduction'},
    6: {'Templates': ['[Cl,Br,I,O:2]-[Pd;H1;+0:1]>>[Cl,Br,I,O;H1:2].[Pd;H0;+0:1]'],
       'pKa': [None],
       'Description': 'Ligand dissociation - reductive elimination type'},
    7: {'Templates': ['[Cl,Br,I,O$([O]-S):7]-[#6;+0:5].[Pd&!$([Pd]-I)&!$([Pd]-Br)&!$([Pd]-Cl);+0:6]>>[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]'],
     'pKa': [None],
     'Description': 'Oxidative addition'},
    8: {'Templates': ['[#8;+0;H2:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);H1;+0:7].[#8;H1;+0:8]-[Pd:6]-[#6;+0:5]',
      '[#6&!$([#6]=O):10][#8;H1:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);H1;+0:7].[#6:10][#8:8]-[Pd:6]-[#6;+0:5]',
      '[Li,Na,K,Cs:10][#8:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);-1:7].[Li,Na,K,Cs;+1:10].[#8:8]-[Pd:6]-[#6;+0:5]',
                     '[#6&!$([#6]=O):9]-[#8;-1:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);-1:7].[#6:9]-[#8;+0:8]-[Pd:6]-[#6;+0:5]'],
     'pKa': [None, None, None, None],
     'Description': 'Halide leaving'},
                     #Suzuki
    9: {'Templates': ['[#5:2]-[#6;+0:4].[#8:8]-[Pd:6]-[#6;+0:5]>>[#6;+0:4]-[Pd:6]-[#6;+0:5].[#5:2]-[#8;+0:8]',
                      #Buchwald-Hartwig amination
                     '[#7;H3;+0:1].[#8;H1:8]-[Pd:6]-[#6;+0:5]>>[#7;H2;+0:1]-[Pd:6]-[#6;+0:5].[#8;H2;+0:8]',
                      '[#7;H2;+0:1].[#8;H1:8]-[Pd:6]-[#6;+0:5]>>[#7;H1;+0:1]-[Pd:6]-[#6;+0:5].[#8;H2;+0:8]',
                      '[#7;H1;+0:1].[#8;H1:8]-[Pd:6]-[#6;+0:5]>>[#7;H0;+0:1]-[Pd:6]-[#6;+0:5].[#8;H2;+0:8]',
                      '[#7;H3;+0:1].[#8;H0:8]-[Pd:6]-[#6;+0:5]>>[#7;H2;+0:1]-[Pd:6]-[#6;+0:5].[#8;H1;+0:8]',
                      '[#7;H2;+0:1].[#8;H0:8]-[Pd:6]-[#6;+0:5]>>[#7;H1;+0:1]-[Pd:6]-[#6;+0:5].[#8;H1;+0:8]',
                      '[#7;H1;+0:1].[#8;H0:8]-[Pd:6]-[#6;+0:5]>>[#7;H0;+0:1]-[Pd:6]-[#6;+0:5].[#8;H1;+0:8]',
                      #Miyaura boration
                      '[*:2]-[Pd:1]-[Cl,Br,I:3].[B;+0:4]-[B;+0:5]>>[*:2]-[Pd:1]-[B;+0:4].[Cl,Br,I;+0:3]-[B;+0:5]',
                      '[*:2]-[Pd:1]-[O;D2:3]-[S:6].[B;+0:4]-[B;+0:5]>>[*:2]-[Pd:1]-[B;+0:4].[B;+0:5]-[O;D2:3]-[S:6]',
                     ],
     'pKa': [None, None, None, None, None, None, None, None, None],
     'Description': 'Transmetalation'},
    10: {'Templates': ['[#5,#6,#7;+0:4]-[Pd:6]-[#6;+0:5]>>[#5,#6,#7;+0:4]-[#6;+0:5].[Pd:6]'],
     'pKa': [None],
     'Description': 'Reductive elimination'}}},

   'Reaction with Pd2+': {'Reagent': ['[Pd;+2]','[Cl,Br,I,O,-1]', '[P]', '[O;H1,H2]'], 'Exclude_reagent': None,
   'Stages': {
    0: {'Templates': ['[Cl,Br,I,O;-1:2].[Pd;+2:1]>>[Cl,Br,I,O;+0:2]-[Pd;+1:1]'],
     'pKa': [None],
     'Description': 'PdX+ formation'},
     1: {'Templates': ['[Cl,Br,I,O;+0:2]-[Pd;+1:1].[Cl,Br,I,O;-1:3]>>[Cl,Br,I,O;+0:2]-[Pd;+0:1]-[Cl,Br,I,O;+0:3]'],
     'pKa': [None],
     'Description': 'PdX2 formation'},
     2: {'Templates': ['[OH2:1]>>[OH1;-1:1]'],
     'pKa': [{'B': 14}],
     'Description': 'Hydroxide ion preparation'},
     3: {'Templates': ['[Cl,Br,I,O:2]-[Pd;+0:1]-[P;H0;+1:4].[OH1;-1:5]>>[Cl,Br,I,O:2]-[Pd;+0:1]-[P;H0;+0:4]-[OH1;+0:5]',
                         '[Cl,Br,I,O:2]-[Pd;+0:1]-[P;H0;+1:4].[OH2;+0:5]>>[Cl,Br,I,O:2]-[Pd;+0:1]-[P;H0;+0:4]-[OH2;+1:5]'],
     'pKa': [None, None],
     'Description': 'Hydroxide-Phosphine reaction'},
     4: {'Templates': [
           '[Cl,Br,I,O:2]-[Pd;+0:1]-[P;H0;+0:4]-[OH2;+1:5]>>[Cl,Br,I,O:2]-[Pd;+0:1]-[P;H0;+0:4]-[OH1;+0:5]'],
           'pKa': [{'B': -1.7}],
           'Description': 'Deprotonation'},

       5: {'Templates': [
           '[Cl,Br,I,O:2]-[Pd;H0;+0:1]-[P;H0;+0:4]-[OH1;+0:5]>>[Cl,Br,I,O:2]-[Pd;H1;+0:1].[P;H0;+0:4]=[OH0;+0:5]'],
           'pKa': [None],
           'Description': 'Palladium reduction'},
     6: {'Templates': ['[Cl,Br,I,O:2]-[Pd;H1;+1:1]>>[Cl,Br,I,O;H1:2].[Pd;H0;+0:1]'],
       'pKa': [None],
       'Description': 'Ligand dissociation - reductive elimination type'},
     7: {'Templates': ['[Cl,Br,I,O$([O]-S):7]-[#6;+0:5].[Pd&!$([Pd]-I)&!$([Pd]-Br)&!$([Pd]-Cl)!$([Pd]-O);+0:6]>>[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]'],
     'pKa': [None],
     'Description': 'Oxidative addition'},
     8: {'Templates': ['[#8;+0;H2:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);H1;+0:7].[#8;H1;+0:8]-[Pd:6]-[#6;+0:5]',
      '[#6&!$([#6]=O):10][#8;H1:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);H1;+0:7].[#6:10][#8;H0;+0:8]-[Pd:6]-[#6;+0:5]',
      '[Li,Na,K,Cs:10][#8:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);-1:7].[Li,Na,K,Cs;+1:10].[#8:8]-[Pd:6]-[#6;+0:5]',
      '[#6&!$([#6]=O):9]-[#8;-1:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);-1:7].[#6:9]-[#8;+0:8]-[Pd:6]-[#6;+0:5]'],
     'pKa': [None, None, None, None],
     'Description': 'Halide leaving'},
                     #Suzuki
     9: {'Templates': ['[#5:2]-[#6;+0:4].[#8:8]-[Pd:6]-[#6;+0:5]>>[#6;+0:4]-[Pd:6]-[#6;+0:5].[#5:2]-[#8;+0:8]',
                      #Buchwald-Hartwig amination
                     '[#7;H3;+0:1].[#8;H1:8]-[Pd:6]-[#6;+0:5]>>[#7;H2;+0:1]-[Pd:6]-[#6;+0:5].[#8;H2;+0:8]',
                      '[#7;H2;+0:1].[#8;H1:8]-[Pd:6]-[#6;+0:5]>>[#7;H1;+0:1]-[Pd:6]-[#6;+0:5].[#8;H2;+0:8]',
                      '[#7;H1;+0:1].[#8;H1:8]-[Pd:6]-[#6;+0:5]>>[#7;H0;+0:1]-[Pd:6]-[#6;+0:5].[#8;H2;+0:8]',
                      '[#7;H3;+0:1].[#8;H0:8]-[Pd:6]-[#6;+0:5]>>[#7;H2;+0:1]-[Pd:6]-[#6;+0:5].[#8;H1;+0:8]',
                      '[#7;H2;+0:1].[#8;H0:8]-[Pd:6]-[#6;+0:5]>>[#7;H1;+0:1]-[Pd:6]-[#6;+0:5].[#8;H1;+0:8]',
                      '[#7;H1;+0:1].[#8;H0:8]-[Pd:6]-[#6;+0:5]>>[#7;H0;+0:1]-[Pd:6]-[#6;+0:5].[#8;H1;+0:8]',
                      #Miyaura boration
                      '[*:2]-[Pd:1]-[Cl,Br,I:3].[B;+0:4]-[B;+0:5]>>[*:2]-[Pd:1]-[B;+0:4].[Cl,Br,I;+0:3]-[B;+0:5]',
                      '[*:2]-[Pd:1]-[O;D2:3]-[S:6].[B;+0:4]-[B;+0:5]>>[*:2]-[Pd:1]-[B;+0:4].[B;+0:5]-[O;D2:3]-[S:6]',
                     ],
     'pKa': [None, None, None, None, None, None, None, None, None],
     'Description': 'Transmetalation'},
     10: {'Templates': ['[#5,#6,#7;+0:4]-[Pd:6]-[#6;+0:5]>>[#5,#6,#7;+0:4]-[#6;+0:5].[Pd:6]'],
     'pKa': [None],
     'Description': 'Reductive elimination'}}},

    #Based on the mechanism described in https://doi.org/10.1021/ol101106z .
    'Reaction with PdX2 and 1,5-cyclooctadiene': {'Reagent': ['[Cl,Br,I,O][Pd;+0][Cl,Br,I,O]', 'C1=CCCC=CCC1'], 'Exclude_reagent': None,
       'Stages': {
           0: {'Templates': ['[Cl,Br,I,O:2]-[Pd;+0:1]-[Cl,Br,I,O:3].[CH1:4]1=[CH1:5][CH2:6][CH2:7][CH1:8]=[CH1:9][CH2:10][CH2:11]1>>[Cl,Br,I,O:2][Pd;+0:1]123([C@@H:4]4[C@H:5]1[CH2:6][CH2:7][C@H:8]2[C@H:9]3[CH2:10][CH2:11]4)[Cl,Br,I,O:3]'],
         'pKa': [None],
         'Description': 'Palladium-ligand formation'},
          1: {'Templates': ['[OH2:1]>>[OH1;-1:1]',
                            '[OH1:1][C;!$(C=O):2]>>[OH0;-1:1][C;!$(C=O):2]'],
         'pKa': [{'B': 14}, {'B': 14}],
         'Description': 'Hydroxide ion preparation'},
           2: {'Templates': ['[Cl,Br,I,O:2][Pd;+0:1]123([C@@H:4]4[C@H:5]1[CH2:6][CH2:7][C@H:8]2[C@H:9]3[CH2:10][CH2:11]4)[Cl,Br,I,O:3].[O;-1:12]>>[Cl,Br,I,O:2][Pd;+0:1]12([CH20:4]3[C@H:5]1[CH2:6][CH2:7][C@H:8]2[CH:9]([O;+0:12])[CH2:10][CH2:11]3)[Cl,Br,I,O:3]',],
         'pKa': [None],
         'Description': 'Hydroxide-cyclooctadiene reaction'},

         3: {'Templates': ['[Cl,Br,I,O:2][Pd;+0:1]12([CH20:4]3[C@H:5]1[CH2:6][CH2:7][C@H:8]2[CH:9]([O;+0:12])[CH2:10][CH2:11]3)[Cl,Br,I,O:3]>>[Cl,Br,I,O:2]-[Pd;H1;+1:1].[Cl,Br,I,O;-1:3].[CH1:4]1=[CH1:5][CH2:6][CH2:7][CH1:8]=[CH1:9]([O;+0:12])[CH2:10][CH2:11]1',],
         'pKa': [None,],
         'Description': 'Beta-H elimination'},
        4: {'Templates': ['[Cl,Br,I,O:2]-[Pd;H1;+1:1]>>[Cl,Br,I,O;H1:2].[Pd;H0;+0:1]'],
           'pKa': [None],
           'Description': 'Ligand dissociation - reductive elimination type'},
        5: {'Templates': ['[Cl,Br,I,O$([O]-S):7]-[#6;+0:5].[Pd&!$([Pd]-I)&!$([Pd]-Br)&!$([Pd]-Cl)&!$([Pd]-P):6]>>[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]'],
         'pKa': [None],
         'Description': 'Oxidative addition'},
        6: {'Templates': ['[#8;+0;H2:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);H1;+0:7].[#8;H1;+0:8]-[Pd:6]-[#6;+0:5]',
      '[#6&!$([#6]=O):10][#8;H1:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);H1;+0:7].[#6:10][#8;H0;+0:8]-[Pd:6]-[#6;+0:5]',
      '[Li,Na,K,Cs:10][#8:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);-1:7].[Li,Na,K,Cs;+1:10].[#8:8]-[Pd:6]-[#6;+0:5]',
      '[#6&!$([#6]=O):9]-[#8;-1:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);-1:7].[#6:9]-[#8;+0:8]-[Pd:6]-[#6;+0:5]'],
         'pKa': [None, None, None, None],
         'Description': 'Halide leaving'},
                         #Suzuki
        7: {'Templates': ['[#5:2]-[#6;+0:4].[#8:8]-[Pd:6]-[#6;+0:5]>>[#6;+0:4]-[Pd:6]-[#6;+0:5].[#5:2]-[#8;+0:8]',
                          #Buchwald-Hartwig amination
                         '[#7;H3;+0:1].[#8;H1:8]-[Pd:6]-[#6;+0:5]>>[#7;H2;+0:1]-[Pd:6]-[#6;+0:5].[#8;H2;+0:8]',
                          '[#7;H2;+0:1].[#8;H1:8]-[Pd:6]-[#6;+0:5]>>[#7;H1;+0:1]-[Pd:6]-[#6;+0:5].[#8;H2;+0:8]',
                          '[#7;H1;+0:1].[#8;H1:8]-[Pd:6]-[#6;+0:5]>>[#7;H0;+0:1]-[Pd:6]-[#6;+0:5].[#8;H2;+0:8]',
                          '[#7;H3;+0:1].[#8;H0:8]-[Pd:6]-[#6;+0:5]>>[#7;H2;+0:1]-[Pd:6]-[#6;+0:5].[#8;H1;+0:8]',
                          '[#7;H2;+0:1].[#8;H0:8]-[Pd:6]-[#6;+0:5]>>[#7;H1;+0:1]-[Pd:6]-[#6;+0:5].[#8;H1;+0:8]',
                          '[#7;H1;+0:1].[#8;H0:8]-[Pd:6]-[#6;+0:5]>>[#7;H0;+0:1]-[Pd:6]-[#6;+0:5].[#8;H1;+0:8]',
                          #Miyaura boration
                          '[*:2]-[Pd:1]-[Cl,Br,I:3].[B;+0:4]-[B;+0:5]>>[*:2]-[Pd:1]-[B;+0:4].[Cl,Br,I;+0:3]-[B;+0:5]',
                          '[*:2]-[Pd:1]-[O;D2:3]-[S:6].[B;+0:4]-[B;+0:5]>>[*:2]-[Pd:1]-[B;+0:4].[B;+0:5]-[O;D2:3]-[S:6]',
                         ],
         'pKa': [None, None, None, None, None, None, None, None, None],
         'Description': 'Transmetalation'},
        8: {'Templates': ['[#5,#6,#7;+0:4]-[Pd:6]-[#6;+0:5]>>[#5,#6,#7;+0:4]-[#6;+0:5].[Pd:6]'],
         'pKa': [None],
         'Description': 'Reductive elimination'}}},

     # Based on the mechanism described in https://chem.libretexts.org/Bookshelves/Inorganic_Chemistry/Supplemental_Modules_and_Websites_(Inorganic_Chemistry)/Catalysis/Catalyst_Examples/Heck_Reaction. ##
     'Reaction with Pd(OR)2 and amine agent': {'Reagent': ['[O][Pd;+0][O]', '[N;+0]-[C;!H0]'], 'Exclude_reagent': None,
                             'Stages': {0: {'Templates': ['[O:2]-[Pd;+0:1]-[O:3].[N;+0:4]-[C;!H0:5]>>[O:2]-[Pd;+0:1]-[N;+1:4]-[C;!H0:5].[O;-1:3]'],
                                     'pKa': [None],
                                     'Description': 'Amine coordination'},
                                 1: {'Templates': ['[O:2]-[Pd;+0:1]-[N;+1:4]-[C;H3:5]>>[O:2]-[Pd;H1;+0:1].[N;+0:4]=[C;H2:5]',
                                     '[O:2]-[Pd;+0:1]-[N;+1:4]-[C;H2:5]>>[O:2]-[Pd;H1;+0:1].[N;+0:4]=[C;H1:5]',
                                     '[O:2]-[Pd;+0:1]-[N;+1:4]-[C;H1:5]>>[O:2]-[Pd;H1;+0:1].[N;+0:4]=[C;H0:5]',],
                                     'pKa': [None, None, None],
                                     'Description': 'Imine formation'},
                                 2: {'Templates': ['[O:2]-[Pd;H1;+0:1]>>[O;H1:2].[Pd;H0;+0:1]',],
                                     'pKa': [None],
                                     'Description': 'Reductive elimination'},
                                 3: {'Templates': ['[Cl,Br,I,O$([O]-S):7]-[#6;+0:5].[Pd&!$([Pd]-I)&!$([Pd]-Br)&!$([Pd]-Cl):6]>>[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]'],
                                     'pKa': [None],
                                     'Description': 'Oxidative addition'},
                                 4: {'Templates': [
                                     '[#8;+0;H2:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);H1;+0:7].[#8;H1;+0:8]-[Pd:6]-[#6;+0:5]',
                                     '[#6&!$([#6]=O):10][#8;H1:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);H1;+0:7].[#6:10][#8;H0;+0:8]-[Pd:6]-[#6;+0:5]',
                                     '[Li,Na,K,Cs:10][#8:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);-1:7].[Li,Na,K,Cs;+1:10].[#8:8]-[Pd:6]-[#6;+0:5]',
                                     '[#6&!$([#6]=O):9]-[#8;-1:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);-1:7].[#6:9]-[#8;+0:8]-[Pd:6]-[#6;+0:5]'],
                                     'pKa': [None, None, None, None],
                                     'Description': 'Halide leaving'},
                                 # Suzuki
                                 5: {'Templates': [
                                     '[#5:2]-[#6;+0:4].[#8:8]-[Pd:6]-[#6;+0:5]>>[#6;+0:4]-[Pd:6]-[#6;+0:5].[#5:2]-[#8;+0:8]',
                                     # Buchwald-Hartwig amination
                                     '[#7;H3;+0:1].[#8;H1:8]-[Pd:6]-[#6;+0:5]>>[#7;H2;+0:1]-[Pd:6]-[#6;+0:5].[#8;H2;+0:8]',
                                     '[#7;H2;+0:1].[#8;H1:8]-[Pd:6]-[#6;+0:5]>>[#7;H1;+0:1]-[Pd:6]-[#6;+0:5].[#8;H2;+0:8]',
                                     '[#7;H1;+0:1].[#8;H1:8]-[Pd:6]-[#6;+0:5]>>[#7;H0;+0:1]-[Pd:6]-[#6;+0:5].[#8;H2;+0:8]',
                                     '[#7;H3;+0:1].[#8;H0:8]-[Pd:6]-[#6;+0:5]>>[#7;H2;+0:1]-[Pd:6]-[#6;+0:5].[#8;H1;+0:8]',
                                     '[#7;H2;+0:1].[#8;H0:8]-[Pd:6]-[#6;+0:5]>>[#7;H1;+0:1]-[Pd:6]-[#6;+0:5].[#8;H1;+0:8]',
                                     '[#7;H1;+0:1].[#8;H0:8]-[Pd:6]-[#6;+0:5]>>[#7;H0;+0:1]-[Pd:6]-[#6;+0:5].[#8;H1;+0:8]',
                                     # Miyaura boration
                                     '[*:2]-[Pd:1]-[Cl,Br,I:3].[B;+0:4]-[B;+0:5]>>[*:2]-[Pd:1]-[B;+0:4].[Cl,Br,I;+0:3]-[B;+0:5]',
                                     '[*:2]-[Pd:1]-[O;D2:3]-[S:6].[B;+0:4]-[B;+0:5]>>[*:2]-[Pd:1]-[B;+0:4].[B;+0:5]-[O;D2:3]-[S:6]',
                                     ],
                                     'pKa': [None, None, None, None, None, None, None, None, None],
                                     'Description': 'Transmetalation'},
                                 6: {'Templates': [
                                     '[#5,#6,#7;+0:4]-[Pd:6]-[#6;+0:5]>>[#5,#6,#7;+0:4]-[#6;+0:5].[Pd:6]'],
                                     'pKa': [None],
                                     'Description': 'Reductive elimination'}}},

    'Reaction with Pd coordinated with 3 or 4 ligands': {'Reagent': ['[Pd;D3,D4;$([Pd](-[*])(-[*])-[*]),$([Pd](-[*])(-[*])(-[*])-[*]);!$([Pd]([Cl,Br,I,O])[Cl,Br,I,O]);+0]'],
                                                         'Exclude_reagent': None,
                                                         'Stages': {
      0: {'Templates': ['[Pd;D4;+0:1](-[P;H0:6])(-[P;H0:4])(-[P;H0:5])-[P;H0:8]>>[Pd;D3;+0:1](-[P;H0:6])(-[P;H0:4])(-[P;H0:5]).[P;H0:8]',],
     'pKa': [None, ],
     'Description': 'Ligand leaving'},
      1: {'Templates': ['[Pd;D3;+0:1](-[P;H0:6])(-[P;H0:5])-[P;H0:8]>>[Pd;D2;+0:1](-[P;H0:6])(-[P;H0:5]).[P;H0:8]',],
         'pKa': [None, ],
         'Description': 'Ligand leaving'},
      2: {'Templates': ['[Pd;D2;+0:1](-[P;H0:6])-[P;H0:5]>>[Pd;+0:1].[P;H0:6].[P;H0:5]',],
         'pKa': [None, ],
         'Description': 'Ligand leaving'},
     
             3: {'Templates': ['[Cl,Br,I,O$([O]-S):7]-[#6;+0:5].[Pd;D0;+0:6]>>[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]',
                              ],
     'pKa': [None],
     'Description': 'Oxidative addition'},
    4: {'Templates': ['[#8;+0;H2:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);H1;+0:7].[#8;H1;+0:8]-[Pd:6]-[#6;+0:5]',
        '[#8;D0;H1;-1:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I;H0,O$([O]-S);-1:7].[#8;H1;+0:8]-[Pd:6]-[#6;+0:5]',
      '[#6&!$([#6]=O):10][#8;H1:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);H1;+0:7].[#6:10][#8;H0;+0:8]-[Pd:6]-[#6;+0:5]',
      '[Li,Na,K,Cs:10][#8:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);-1:7].[Li,Na,K,Cs;+1:10].[#8:8]-[Pd:6]-[#6;+0:5]',
      '[#6&!$([#6]=O):9]-[#8;-1:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);-1:7].[#6:9]-[#8;+0:8]-[Pd:6]-[#6;+0:5]'],

     'pKa': [None,None, None,None, None, None],
     'Description': 'Halide leaving'},
                     #Suzuki
    5: {'Templates': ['[#5:2]-[#6;+0:4].[#8:8]-[Pd:6]-[#6;+0:5]>>[#6;+0:4]-[Pd:6]-[#6;+0:5].[#5:2]-[#8;+0:8]',
                      #Buchwald-Hartwig amination
                     '[#7;H3;+0:1].[#8;H1:8]-[Pd:6]-[#6;+0:5]>>[#7;H2;+0:1]-[Pd:6]-[#6;+0:5].[#8;H2;+0:8]',
                      '[#7;H2;+0:1].[#8;H1:8]-[Pd:6]-[#6;+0:5]>>[#7;H1;+0:1]-[Pd:6]-[#6;+0:5].[#8;H2;+0:8]',
                      '[#7;H1;+0:1].[#8;H1:8]-[Pd:6]-[#6;+0:5]>>[#7;H0;+0:1]-[Pd:6]-[#6;+0:5].[#8;H2;+0:8]',
                      '[#7;H3;+0:1].[#8;H0:8]-[Pd:6]-[#6;+0:5]>>[#7;H2;+0:1]-[Pd:6]-[#6;+0:5].[#8;H1;+0:8]',
                      '[#7;H2;+0:1].[#8;H0:8]-[Pd:6]-[#6;+0:5]>>[#7;H1;+0:1]-[Pd:6]-[#6;+0:5].[#8;H1;+0:8]',
                      '[#7;H1;+0:1].[#8;H0:8]-[Pd:6]-[#6;+0:5]>>[#7;H0;+0:1]-[Pd:6]-[#6;+0:5].[#8;H1;+0:8]',
                      #Miyaura boration
                      '[*:2]-[Pd:1]-[Cl,Br,I:3].[B;+0:4]-[B;+0:5]>>[*:2]-[Pd:1]-[B;+0:4].[Cl,Br,I;+0:3]-[B;+0:5]',
                      '[*:2]-[Pd:1]-[O;D2:3]-[S:6].[B;+0:4]-[B;+0:5]>>[*:2]-[Pd:1]-[B;+0:4].[B;+0:5]-[O;D2:3]-[S:6]',
                     ],
     'pKa': [None, None, None, None, None, None, None, None, None],
     'Description': 'Transmetalation'},
    6: {'Templates': ['[#5,#6,#7;+0:4]-[Pd:6]-[#6;+0:5]>>[#5,#6,#7;+0:4]-[#6;+0:5].[Pd:6]'],
     'pKa': [None],
     'Description': 'Reductive elimination'}}},

    'Reaction with Pd coordinated with 2 ligands': {'Reagent': ['[!Cl;!Br;!I;!O][Pd;D2;+0;!$([Pd]~[Cl,Br,I,O])][!Cl;!Br;!I;!O]'],
                                                    'Exclude_reagent': None,
    'Stages': {0: {'Templates': ['[Pd;D2;+0;!$([Pd]~[Cl,Br,I,O]:1](-[*;!Cl;!Br;!I;!O:6])-[*;!Cl;!Br;!I;!O:5]>>[Pd;+0:1].[*:6].[*:5]',],
     'pKa': [None],
     'Description': 'Ligand leaving'},
    1: {'Templates': ['[Cl,Br,I,O$([O]-S):7]-[#6;+0:5].[Pd;D0;+0:6]>>[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]'],
     'pKa': [None],
     'Description': 'Oxidative addition'},

    2: {'Templates': ['[#8;+0;H2:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);H1;+0:7].[#8;H1;+0:8]-[Pd:6]-[#6;+0:5]',
        '[#8;D0;H1;-1:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I;H0,O$([O]-S);-1:7].[#8;H1;+0:8]-[Pd:6]-[#6;+0:5]',
      '[#6&!$([#6]=O):10][#8;H1:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);H1;+0:7].[#6:10][#8;H0;+0:8]-[Pd:6]-[#6;+0:5]',
      '[Li,Na,K,Cs:10][#8:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);-1:7].[Li,Na,K,Cs;+1:10].[#8:8]-[Pd:6]-[#6;+0:5]',
      '[#6&!$([#6]=O):9]-[#8;-1:8].[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]>>[Cl,Br,I,O$([O]-S);-1:7].[#6:9]-[#8;+0:8]-[Pd:6]-[#6;+0:5]'],
     'pKa': [None, None, None,None, None],
     'Description': 'Halide leaving'},
                     #Suzuki
    3: {'Templates': ['[#5:2]-[#6;+0:4].[#8:8]-[Pd:6]-[#6;+0:5]>>[#6;+0:4]-[Pd:6]-[#6;+0:5].[#5:2]-[#8;+0:8]',
                      #Buchwald-Hartwig amination
                     '[#7;H3;+0:1].[#8;H1:8]-[Pd:6]-[#6;+0:5]>>[#7;H2;+0:1]-[Pd:6]-[#6;+0:5].[#8;H2;+0:8]',
                      '[#7;H2;+0:1].[#8;H1:8]-[Pd:6]-[#6;+0:5]>>[#7;H1;+0:1]-[Pd:6]-[#6;+0:5].[#8;H2;+0:8]',
                      '[#7;H1;+0:1].[#8;H1:8]-[Pd:6]-[#6;+0:5]>>[#7;H0;+0:1]-[Pd:6]-[#6;+0:5].[#8;H2;+0:8]',
                      '[#7;H3;+0:1].[#8;H0:8]-[Pd:6]-[#6;+0:5]>>[#7;H2;+0:1]-[Pd:6]-[#6;+0:5].[#8;H1;+0:8]',
                      '[#7;H2;+0:1].[#8;H0:8]-[Pd:6]-[#6;+0:5]>>[#7;H1;+0:1]-[Pd:6]-[#6;+0:5].[#8;H1;+0:8]',
                      '[#7;H1;+0:1].[#8;H0:8]-[Pd:6]-[#6;+0:5]>>[#7;H0;+0:1]-[Pd:6]-[#6;+0:5].[#8;H1;+0:8]',
                      #Miyaura boration
                      '[*:2]-[Pd:1]-[Cl,Br,I:3].[B;+0:4]-[B;+0:5]>>[*:2]-[Pd:1]-[B;+0:4].[Cl,Br,I;+0:3]-[B;+0:5]',
                      '[*:2]-[Pd:1]-[O;D2:3]-[S:6].[B;+0:4]-[B;+0:5]>>[*:2]-[Pd:1]-[B;+0:4].[B;+0:5]-[O;D2:3]-[S:6]',
                     ],
     'pKa': [None, None, None, None, None, None, None, None, None],
     'Description': 'Transmetalation'},
    4: {'Templates': ['[#5,#6,#7;+0:4]-[Pd:6]-[#6;+0:5]>>[#5,#6,#7;+0:4]-[#6;+0:5].[Pd:6]'],
     'pKa': [None],
     'Description': 'Reductive elimination'}}}},

 ('Mitsunobu aryl ether synthesis',
  'Mitsunobu imide reaction',
  'Mitsunobu sulfonamide reaction',
  'Mitsunobu ester synthesis',): {'Reaction': {'Reagent': ['[#6]-[P](-[#6])-[#6]','[#6]-[N]=[N]-[#6]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[P;!D0;+0:1].[N;H0;+0:2]=[N;H0;+0:3]>>[P;+1:1]-[N;H0;+0:2]-[N;H0;-1:3]'],
     'pKa': [None],
     'Description': 'Reaction between phosphine and diethylazodicarboxylate (DEAD)'},

    1: {'Templates': ['[P;+1:1]-[N;H0;+0:2]-[N;H0;-1:3].[#7,#16;H1;+0:4]>>[P;+1:1]-[N;H0;+0:2]-[N;H1;+0:3].[#7,#16;H0;-1:4]',
      '[P;+1:1]-[N;H0;+0:2]-[N;H0;-1:3].[#8;H1;+0:4]-[c:5]>>[P;+1:1]-[N;H0;+0:2]-[N;H1;+0:3].[#8;H0;-1:4]-[c:5]',
      '[P;+1:1]-[N;H0;+0:2]-[N;H0;-1:3].[#8;H1;+0:4]-[C:5]=[O:6]>>[P;+1:1]-[N;H0;+0:2]-[N;H1;+0:3].[#8;H0;-1:4]-[C:5]=[O:6]'],
     'pKa': [None, None, None],
     'Description': 'Proton exchange'},

    2: {'Templates': ['[P;+1:1]-[N;H0;+0:2]-[N;H1;+0:3].[#8;H1;+0:5]>>[#8;H1;+1:5]-[P;+0:1]-[N;H0;+0:2]-[N;H1;+0:3]'],
     'pKa': [None],
     'Description': 'Forming a complex'},

    3: {'Templates': ['[#8;H1;+1:5]-[P;+0:1]-[N;H0;+0:2]-[N;H1;+0:3]>>[#8;H0;+1:5]=[P;+0:1].[N;H1;+0:2]-[N;H1;+0:3]'],
     'pKa': [None],
     'Description': 'Bond cleavage and proton exchange'},

    4: {'Templates': ['[P;+0:1]=[#8;H0;+1:5]-[#6;+0:6].[#7,#8,#16;H0;-1:4]>>[P;+0:1]=[#8;H0;+0:5].[#6;+0:6]-[#7,#8,#16;H0;+0:4]'],
     'pKa': [None],
     'Description': 'SN2 type reaction'}}}},


 ('Ketone to alcohol reduction',): {'Reaction': {'Reagent': ['[C]=[O]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[Al,B;H4;-1:2].[#6;+0:4](=[O;H0;+0:5])>>[Al,B;H3;+0:2].[#6;H1;+0:4](-[O;H0;-1:5])',
      '[Al,B;H3;-1:2].[#6;+0:4](=[O;H0;+0:5])>>[Al,B;H2;+0:2].[#6;H1;+0:4](-[O;H0;-1:5])',
      '[Al,B;H2;-1:2].[#6;+0:4](=[O;H0;+0:5])>>[Al,B;H1;+0:2].[#6;H1;+0:4](-[O;H0;-1:5])',
      '[Al,B;H1;-1:2].[#6;+0:4](=[O;H0;+0:5])>>[Al,B;H0;+0:2].[#6;H1;+0:4](-[O;H0;-1:5])'],
     'pKa': [None, None, None, None],
     'Description': 'Hydride transfer'},
    1: {'Templates': ['[#6;H1;+0:4]-[O;H0;-1:5]>>[#6;H1;+0:4]-[O;H1;+0:5]'],
     'pKa': [{'A': 15.5}],
     'Description': 'Protonation of alcohol'}}}},

 ('O-Bn deprotection',): {'Pd with H2': {'Reagent': ['[Pd]', '[H]-[H]','[#8]-[C]-[c]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[Pd:1].[*:2]-[O:3]-[#6:4]>>[*:2]-[O:3]-[Pd:1]-[#6:4]'],
     'pKa': [None],
     'Description': 'Adsorption of ether on Pd'},
    1: {'Templates': ['[*:2]-[O;H0:3]-[Pd:1]-[#6;H2:4].[H:5][H:6]>>[*:2]-[O;H0:3]-[H:5].[H:6]-[#6;H2:4].[Pd:1]'],
     'pKa': [None],
     'Description': 'Hydrogenation'}}},

  'Deprotection using BBr3':{'Reagent': ['[Cl,Br]-[B]','[#8]-[C]-[c]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[C:5]-[O;D2;H0;+0:1]-[C:2].[Cl,Br:3][B:4]>>[C:2]-[O;H0;+1:1](-[C:5])-[B;-1:4]([Cl,Br:3])'],
     'pKa': [None],
     'Description': 'BBr3 addition'},
    1: {'Templates': ['[C:2]-[O;H0;+1:1]-[B;-1:4][Cl,Br:3]>>[C:2]-[O;H0;+1:1]-[B;+0:4].[Cl,Br;-1:3]'],
     'pKa': [None],
     'Description': 'Halide leaving'},
    2: {'Templates': ['[c;H1:10]1[c;H1:9][c;H1:8][c;H1:7][c;H1:6][c;H0:5]1-[C:2]-[O;H0;+1:1]-[B;+0:4].[Cl,Br;-1:3]>>[O;D2;H0;+0:1]-[B;+0:4].[c;H1:10]1[c;H1:9][c;H1:8][c;H1:7][c;H1:6][c;H0:5]1-[C:2]-[Cl,Br;+0:3]'],
     'pKa': [None],
     'Description': 'SN2 type alkyl halide leaving'},

    3: {'Templates': ['[O;H0;+0:1]-[B;+0:4].[O;H2;+0:6]>>[O;H0;-1:1].[O;H2;+1:6]-[B;+0:4]',
                      '[O;H0;+0:1]-[B;+0:4].[O;H1;+0:6]-[C:7]>>[O;H0;-1:1].[C:7]-[O;H1;+1:6]-[B;+0:4]',
                      '[O;H0;+0:1]-[B;+0:4].[O;H0;-1:6]-[C:7]>>[O;H0;-1:1].[C:7]-[O;H0;+0:6]-[B;+0:4]'],
     'pKa': [None, None],
     'Description': 'Addition of water'},
    4: {'Templates': ['[O;H2;+1:6]-[B;+0:4]>>[O;H1;+0:6]-[B;+0:4]',
                      '[C:7]-[O;H1;+1:6]-[B;+0:4]>>[C:7]-[O;H0;+0:6]-[B;+0:4]'],
     'pKa': [{'B': -1.7}, {'B': -1.7}],
     'Description': 'Proton exchange'}}}},


 ('Isocyanate + amine urea coupling',
  'Isocyanate + alcohol reaction',): {'Reaction': {'Reagent': ['[N]=[C]=[O]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[*:5]-[N:1]=[C:2]=[O:3].[N;H3;+0:4]>>[*:5]-[N;-1:1]-[C:2](-[N;H3;+1:4])=[O:3]',
      '[*:5]-[N:1]=[C:2]=[O:3].[N;H2;+0:4]>>[*:5]-[N;-1:1]-[C:2](-[N;H2;+1:4])=[O:3]',
      '[*:5]-[N:1]=[C:2]=[O:3].[N;H1;+0:4]>>[*:5]-[N;-1:1]-[C:2](-[N;H1;+1:4])=[O:3]',
      '[*:5]-[N:1]=[C:2]=[O:3].[n;H3;+0:4]>>[*:5]-[N;-1:1]-[C:2](-[n;H3;+1:4])=[O:3]',
      '[*:5]-[N:1]=[C:2]=[O:3].[n;H2;+0:4]>>[*:5]-[N;-1:1]-[C:2](-[n;H2;+1:4])=[O:3]',
      '[*:5]-[N:1]=[C:2]=[O:3].[n;H1;+0:4]>>[*:5]-[N;-1:1]-[C:2](-[n;H1;+1:4])=[O:3]',
      '[*:5]-[N:1]=[C:2]=[O:3].[#8;H2;+0:4]>>[*:5]-[N;-1:1]-[C:2](-[#8;H2;+1:4])=[O:3]',
      '[*:5]-[N:1]=[C:2]=[O:3].[#8;H1;+0:4]>>[*:5]-[N;-1:1]-[C:2](-[#8;H1;+1:4])=[O:3]'],
     'pKa': [None, None, None, None, None, None, None, None],
     'Description': 'Amine addition to isocyanate'},
    1: {'Templates': ['[N;H0;-1:1]-[C:2](-[N;H3;+1:4])=[O:3]>>[N;H1;+0:1]-[C:2](-[N;H2;+0:4])=[O:3]',
      '[N;H0;-1:1]-[C:2](-[N;H2;+1:4])=[O:3]>>[N;H1;+0:1]-[C:2](-[N;H1;+0:4])=[O:3]',
      '[N;H0;-1:1]-[C:2](-[N;H1;+1:4])=[O:3]>>[N;H1;+0:1]-[C:2](-[N;H0;+0:4])=[O:3]',
      '[N;H0;-1:1]-[C:2](-[n;H3;+1:4])=[O:3]>>[N;H1;+0:1]-[C:2](-[n;H2;+0:4])=[O:3]',
      '[N;H0;-1:1]-[C:2](-[n;H2;+1:4])=[O:3]>>[N;H1;+0:1]-[C:2](-[n;H1;+0:4])=[O:3]',
      '[N;H0;-1:1]-[C:2](-[n;H1;+1:4])=[O:3]>>[N;H1;+0:1]-[C:2](-[n;H0;+0:4])=[O:3]',
      '[N;H0;-1:1]-[C:2](-[#8;H2;+1:4])=[O:3]>>[N;H1;+0:1]-[C:2](-[#8;H1;+0:4])=[O:3]',
      '[N;H0;-1:1]-[C:2](-[#8;H1;+1:4])=[O:3]>>[N;H1;+0:1]-[C:2](-[#8;H0;+0:4])=[O:3]'],
     'pKa': [None, None, None, None, None, None, None, None],
     'Description': 'Proton exchange'}}}},

 ('Ketone reductive amination',): {'Reaction': {'Reagent': ['[C]=[O]','[N]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[#7;H3;+0:1].[C:2]=[O:3]>>[#7;H3;+1:1][C:2]-[O;-1:3]',
      '[#7;H2;+0:1].[C:2]=[O:3]>>[#7;H2;+1:1][C:2]-[O;-1:3]',
      '[#7;H1;+0:1].[C:2]=[O:3]>>[#7;H1;+1:1][C:2]-[O;-1:3]'],
     'pKa': [None, None, None],
     'Description': 'Amine addition'},
    1: {'Templates': ['[#7;H3;+1:1][C:2]-[O;-1:3]>>[#7;H2;+0:1][C:2]-[O;H1;+0:3]',
      '[#7;H2;+1:1][C:2]-[O;-1:3]>>[#7;H1;+0:1][C:2]-[O;H1;+0:3]',
      '[#7;H1;+1:1][C:2]-[O;-1:3]>>[#7;H0;+0:1][C:2]-[O;H1;+0:3]'],
     'pKa': [None, None, None],
     'Description': 'Proton exchange'},
    2: {'Templates': ['[#7;+0:1][C:2]-[O;H1;+0:3]>>[#7;+0:1][C:2]-[O;H2;+1:3]'],
     'pKa': [{'A': 15.5}],
     'Description': 'Protonation of alcohol'},
    3: {'Templates': ['[#7;+0:1]-[C:2]-[O;H2;+1:3]>>[#7;+1:1]=[C:2].[O;H2;+0:3]'],
     'pKa': [None],
     'Description': 'Water leaves'},
    4: {'Templates': ['[Al,B;H4;-1:2].[#6;+0:4](=[N;+1:5])>>[Al,B;H3;+0:2].[#6;H1;+0:4](-[N;+0:5])',
      '[Al,B;H3;-1:2].[#6;+0:4](=[N;+1:5])>>[Al,B;H2;+0:2].[#6;H1;+0:4](-[N;+0:5])',
      '[Al,B;H2;-1:2].[#6;+0:4](=[N;+1:5])>>[Al,B;H1;+0:2].[#6;H1;+0:4](-[N;+0:5])',
      '[Al,B;H1;-1:2].[#6;+0:4](=[N;+1:5])>>[Al,B;H0;+0:2].[#6;H1;+0:4](-[N;+0:5])'],
     'pKa': [None, None, None, None],
     'Description': 'Hydride transfer'}}}},

 ('Sulfanyl to sulfonyl',): {'Reaction using peroxide': {'Reagent': ['[O]-[O]','[S]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[S;D2;H0;+0:1].[O;H1;+0:2]-[O;H0;+0:3]>>[S;H0;+1:1]-[O;H1;+0:2].[O;H0;-1:3]',
      '[S;D2;H0;+0:1].[O;H1;+0:2]-[O;H1;+0:3]>>[S;H0;+1:1]-[O;H1;+0:2].[O;H1;-1:3]',
      '[S;D2;H0;+0:1].[Li,Na,K,Cs:4][O;H0;+0:2]-[O;H0;+0:3]>>[S;H0;+1:1]-[O;H0;+0:2][Li,Na,K,Cs:4].[O;H0;+0:3]'],
     'pKa': [None, None, None],
     'Description': 'Oxidation'},
    1: {'Templates': ['[S;+1:1]-[O;H1;+0:2]>>[S;H0;+0:1]=[O;H0;+0:2]',
      '[S;H0;+1:1]-[O;H0;+0:2][Li,Na,K,Cs:4]>>[S;H0;+0:1]=[O;H0;+0:2].[Li,Na,K,Cs;+1:4]'],
     'pKa': [{'B': -10}, {'B': -10}],
     'Description': 'Deprotonation of S-OH'},
    2: {'Templates': ['[S;D3;H0;+0:1].[O;H1;+0:2]-[O;H0;+0:3]>>[S;H0;+1:1]-[O;H1;+0:2].[O;H0;-1:3]',
      '[S;D3;H0;+0:1].[O;H1;+0:2]-[O;H1;+0:3]>>[S;H0;+1:1]-[O;H1;+0:2].[O;H1;-1:3]',
      '[S;D3;H0;+0:1].[Li,Na,K,Cs:4][O;H0;+0:2]-[O;H0;+0:3]>>[S;H0;+1:1]-[O;H0;+0:2][Li,Na,K,Cs:4].[O;H0;+0:3]'],
     'pKa': [None, None, None],
     'Description': 'Additional oxidation'},
    3: {'Templates': ['[S;+1:1]-[O;H1;+0:2]>>[S;H0;+0:1]=[O;H0;+0:2]',
      '[S;+1:1]-[O;H0;+0:2][Li,Na,K,Cs:4]>>[S;H0;+0:1]=[O;H0;+0:2].[Li,Na,K,Cs;+1:4]'],
     'pKa': [{'B': -10}, {'B': -10}],
     'Description': 'Deprotonation of S-OH'}}}},

 ('N-Cbz deprotection',): {'Strong acid': {'Reagent': ['[Cl,Br,I;D0]','[N]-[C](=[O])-[O]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[O:1]=[C:2]-[O:3].[Cl,Br,I;H1;+0:4]>>[O;H1;+1:1]=[C:2]-[O:3].[Cl,Br,I;H0;-1:4]'],
     'pKa': [None],
     'Description': 'Proton exchange'},
    1: {'Templates': ['[O;H1;+1:1]=[C:2]-[O:3]-[C:5].[Cl,Br,I;H0;-1:4]>>[O;H1;+0:1]-[C:2]=[O:3].[C:5]-[Cl,Br,I;H0;+0:4]'],
     'pKa': [None],
     'Description': 'Nucleophilic substitution'},
    2: {'Templates': ['[O;H1;+0:1]-[C:2]=[O:3]>>[O;H0;-1:1]-[C:2]=[O:3]'],
     'pKa': [None],
     'Description': 'Deprotonation of carboxylic acid'},
    3: {'Templates': ['[N:4]-[C:2](-[O;H0;-1:1])=[O:3]>>[N;-1:4].[O;H0;+0:1]=[C:2]=[O:3]'],
     'pKa': [None],
     'Description': 'CO2 evolution'},
    4: {'Templates': ['[N;H0;-1:4]>>[N;H1;+0:4]', '[N;H1;-1:4]>>[N;H2;+0:4]'],
     'pKa': [{'A': 37}, {'A': 37}],
     'Description': 'Protonation of amide anion'}}}},

 ('Iodo N-methylation',): {'Reaction': {'Reagent': ['[N]','[I]-[#6]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[N;H3;+0:1].[C:3]-[I;+0:2]>>[N;H3;+1:1][C:3].[I;-1:2]',
      '[N;H2;+0:1].[C:3]-[I;+0:2]>>[N;H2;+1:1][C:3].[I;-1:2]',
      '[N;H1;+0:1].[C:3]-[I;+0:2]>>[N;H1;+1:1][C:3].[I;-1:2]',
      '[N;H0;+0:1].[C:3]-[I;+0:2]>>[N;H0;+1:1][C:3].[I;-1:2]',
      '[n;H3;+0:1].[C:3]-[I;+0:2]>>[n;H3;+1:1][C:3].[I;-1:2]',
      '[n;H2;+0:1].[C:3]-[I;+0:2]>>[n;H2;+1:1][C:3].[I;-1:2]',
      '[n;H1;+0:1].[C:3]-[I;+0:2]>>[n;H1;+1:1][C:3].[I;-1:2]',
      '[n;H0;+0:1].[C:3]-[I;+0:2]>>[n;H0;+1:1][C:3].[I;-1:2]'],
     'pKa': [None, None, None, None, None, None, None, None],
     'Description': 'Nucleophilic substitution'},

    1: {'Templates': ['[N;H3;+1:1][C:3]>>[N;H2;+0:1][C:3]',
      '[N;H2;+1:1][C:3]>>[N;H1;+0:1][C:3]',
      '[N;H1;+1:1][C:3]>>[N;H0;+0:1][C:3]',
      '[N;H0;+0:1].[C:3]-[I;+0:2]>>[N;H0;+1:1][C:3].[I;-1:2]',
      '[n;H3;+1:1][C:3]>>[n;H2;+0:1][C:3]',
      '[n;H2;+1:1][C:3]>>[n;H1;+0:1][C:3]',
      '[n;H1;+1:1][C:3]>>[n;H0;+0:1][C:3]',
      '[n;H0;+0:1].[C:3]-[I;+0:2]>>[n;H0;+1:1][C:3].[I;-1:2]'],
     'pKa': [{'B': 9.25}, {'B': 9.25}, {'B': 9.25}, None, {'B': 9.25}, {'B': 9.25}, {'B': 9.25}, None],
     'Description': 'Deprotonation of amine'}}}},

 ('O-TBS deprotection',
  'O-TBDPS deprotection',
  'O-TIPS deprotection',): {'Fluoride condition': {'Reagent': ['[F;+0;H1]','[O]-[Si]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[#8;H0;+0:1]-[Si;+0:2].[F;H1;+0:3]>>[#8;H1;+1:1]-[Si;-1:2]-[F;H0;+0:3]',
      '[#8;H0;+0:1]-[Si;+0:2].[F;H0;-1:3]>>[#8;H0;+0:1]-[Si;-1:2]-[F;H0;+0:3]'],
     'pKa': [None, None],
     'Description': 'Fluoride addition'},
    1: {'Templates': ['[#8;H1;+1:1]-[Si;-1:2]-[F;H0;+0:3]>>[#8;H1;+0:1].[Si;+0:2]-[F;H0;+0:3]',
                      '[#8;H0;+0:1]-[Si;-1:2]-[F;H0;+0:3]>>[#8;H0;-1:1].[Si;+0:2]-[F;H0;+0:3]'
                      ],
     'pKa': [None, None],
     'Description': 'Si group leaves'},
    2: {'Templates': ['[#8;H0;-1:1]>>[#8;H1;+0:1]'],
     'pKa': [{'A': 15.5}],
     'Description': 'Protonation of alkoxide'}}},

    'Aqueous acidic condition': {'Reagent': ['[OH2]','[O]-[Si]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[#8:1]-[Si;+0:2]>>[#8;H1;+1:1]-[Si;+0:2]'],
     'pKa': [{'A': 13}],
     'Description': 'Protonation of ether'},
    1: {'Templates': ['[#8;H1;+1:1]-[Si;+0:2].[#8;H2;+0:3]>>[#8;H1;+0:1].[Si;+0:2]-[#8;H2;+1:3]'],
     'pKa': [None],
     'Description': 'Nucleophilic substitution'},
    2: {'Templates': ['[Si;+0:2]-[#8;H2;+1:3]>>[Si;+0:2]-[#8;H1;+0:3]'],
     'pKa': [{'B': -1.7}],
     'Description': 'Deprotonation of protonated alcohol'},
            }}},


 ('Methyl esterification',): {'Methyl iodide': {'Reagent': ['[CH3]-[I]','[O]=[C]-[O]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[#8;H1;+0:1]>>[#8;H0;-1:1]'],
     'pKa': [{'B': 4.74}],
     'Description': 'Deprotonation of carboxylic acid'},
    1: {'Templates': ['[#8;H0;-1:1].[C:3]-[I;+0:2]>>[#8;H0;+0:1][C:3].[I;-1:2]'],
     'pKa': [None],
     'Description': 'Nucleophilic substitution'}}},
  'Methanol': {'Reagent': ['[CH3]-[OH]','[O]=[C]-[O]'], 'Exclude_reagent': None,
                                 # Acidic condition
   'Stages': {0: {'Templates': ['[O;H0;+0:1]=[C;H0;+0:2]>>[O;H1;+1:1]=[C;H0;+0:2]',
                               #Basic condition
                               '[O;H1;+0:1]-[C;H0;+0:2]>>[O;H0;-1:1]-[C;H0;+0:2]'],
     'pKa': [{'A': -6}, {'B': 15.5}],
     'Description': 'Protonation of carbonyl or deprotonation of alcohol'},

                     #Acidic condition
    1: {'Templates': ['[O;H1;+1:1]=[C;H0;+0:2].[O;H1;+0:4]-[#6;+0:5]>>[O;H1;+0:1]-[C;H0;+0:2]-[O;H1;+1:4]-[#6;+0:5]',
                     #Basic condition
                     '[O;H0;+0:1]=[C;H0;+0:2].[O;H0;-1:4][#6;+0:5]>>[O;H0;-1:1]-[C;H0;+0:2][O;H0;+0:4][#6;+0:5]',
                     ],
     'pKa': [None, None],
     'Description': 'Alcohol addition to carbonyl'},
                         #Acidic condition
    2: {'Templates': ['[O;H1;+0:1]-[C;H0;+0:2](-[O;H1;+0:3])-[O;H1;+1:4]-[#6;+0:5]>>[O;H1;+0:1]-[C;H0;+0:2](-[O;H2;+1:3])-[O;H0;+0:4]-[#6;+0:5]',
                       #Basic condition
                     '[O;H0;-1:1]-[C;H0;+0:2](-[O;H1;+0:3])-[O;H0;+0:4]-[#6;+0:5]>>[O;H1;+0:1]-[C;H0;+0:2](-[O;H1;+0:3])-[O;H0;+0:4]-[#6;+0:5]',
                     ],
     'pKa': [None, {'A': 15.5}],
     'Description': 'Protonation or deprotonation of complex'},

    3: {'Templates': ['[O;H1;+0:1]-[C;H0;+0:2](-[O;H2;+1:3])-[O;H0;+0:4]-[#6;+0:5]>>[O;H1;+1:1]=[C;H0;+0:2]-[O;H0;+0:4]-[#6;+0:5].[O;H2;+0:3]',
                     '[O;H1;+0:1]-[C;H0;+0:2](-[O;H1;+0:3])-[O;H0;+0:4]-[#6;+0:5]>>[O;H1;+1:1]=[C;H0;+0:2]-[O;H0;+0:4]-[#6;+0:5].[O;H1;-1:3]'
                     ],
     'pKa': [None, None],
     'Description': 'Water or hydroxide ion leaving'},
    4: {'Templates': ['[O;H1;+1:1]=[C;H0;+0:2]-[O;H0;+0:4]-[#6;+0:5]>>[O;H0;+0:1]=[C;H0;+0:2]-[O;H0;+0:4]-[#6;+0:5]',
                     '[O;H1;+1:1]=[C;H0;+0:2]-[O;H0;+0:4]-[#6;+0:5].[O;H1;-1:3]>>[O;H0;+0:1]=[C;H0;+0:2]-[O;H0;+0:4]-[#6;+0:5].[O;H2;+0:3]'
                     ],
     'pKa': [{'B': -6}, None],
     'Description': 'Proton exchange'}}}},

 ('Bromination',): {'Bromination on benzene': {'Reagent': ['O=C-[O;H1+0,H0-]','BrBr', '[c;H1]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[Br:1][Br:2].[O:3]=[C:4]-[O;H1;+0:5]>>[Br;H1;+0:1].[O:3]=[C:4]-[O;H0;+0:5][Br;H0:2]',
      '[Br:1][Br:2].[O:3]=[C:4]-[O;H0;+0:5]-[Li,Na,K;+0:6]>>[Br;-1:1].[O:3]=[C:4]-[O;H0;+0:5][Br;H0:2].[Li,Na,K;+1:6]'],
     'pKa': [None, None],
     'Description': 'Complexation of bromine and acetic acid'},

    1: {'Templates': ['[O:3]=[C:4]-[O:5][Br;H0:2].[c;+0:6]:[c;H1;+0:7]>>[c;+1:6]:[c;H1;+0:7][Br;H0:2].[O:3]=[C:4]-[O;H0;-1:5]'],
     'pKa': [None],
     'Description': 'Bromination of aromatic ring'},

    2: {'Templates': ['[c;+1:6]:[c;H1;+0:7][Br;H0:2]>>[c;+0:6]:[c;H0;+0:7][Br;H0:2]'],
     'pKa': [{'B': -24.3}],
     'Description': 'Deprotonation of aromatic ring'}}},


  'Bromination of alpha ketone': {'Reagent': ['O=C-[C;!H0]', 'BrBr'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[C;+0:1]-[C:2]=[O;H0;+0:3]>>[C;+0:1]-[C;+0:2]=[O;H1;+1:3]'],
     'pKa': [{'A': -3}],
    'Description': 'Protonation of carbonyl'},
              1: {'Templates': ['[#8:1]=[#6:2]-[#6;H2:3]-[#6:4]=[#8:5]>>[#8:1]-[#6:2]=[#6;H1;-1:3]-[#6:4]=[#8:5]',
                                '[#8:1]=[#6:2]-[#6;H1:3]-[#6:4]=[#8:5]>>[#8:1]-[#6:2]=[#6;H0;-1:3]-[#6:4]=[#8:5]',
                                '[#8:1]=[#6:2]-[#6;H3:3]>>[#8:1]-[#6:2]=[#6;H2;-1:3]',
                                '[#8:1]=[#6:2]-[#6;H2:3]>>[#8:1]-[#6:2]=[#6;H1;-1:3]',
                                '[#8:1]=[#6:2]-[#6;H1:3]>>[#8:1]-[#6:2]=[#6;H0;-1:3]',
                                '[#7:1]#[#6:2]-[#6;H3:3]>>[#7:1]#[#6:2]-[#6;H3;-1:3]',
                                '[#7:1]#[#6:2]-[#6;H2:3]>>[#7:1]#[#6:2]-[#6;H1;-1:3]',
                                '[#8;H1;+1:1]=[#6:2]-[#6;H2:3]-[#6:4]=[#8:5]>>[#8;H1;+0:1]-[#6:2]=[#6;H1;+0:3]-[#6:4]=[#8:5]',
                                '[#8;H1;+1:1]=[#6:2]-[#6;H1:3]-[#6:4]=[#8:5]>>[#8;H1;+0:1]-[#6:2]=[#6;H0;+0:3]-[#6:4]=[#8:5]',
                                '[#8;H1;+1:1]=[#6:2]-[#6;H3:3]>>[#8;H1;+0:1]-[#6:2]=[#6;H2;+0:3]',
                                '[#8;H1;+1:1]=[#6:2]-[#6;H2:3]>>[#8;H1;+0:1]-[#6:2]=[#6;H1;+0:3]',
                                '[#8;H1;+1:1]=[#6:2]-[#6;H1:3]>>[#8;H1;+0:1]-[#6:2]=[#6;H0;+0:3]',
                                ],
     'pKa': [{'B': 6},{'B': 6},{'B': 17}, {'B': 17}, {'B': 17}, {'B': 17},{'B': 17}, {'B': -3},{'B': -3}, {'B': -3}, {'B': -3}, {'B': -3}],
     'Description': 'Deprotonation of alpha position carbon'},

    2: {'Templates': ['[C:1]=[C:2]-[O;H1:3].[Br:4][Br:5]>>[Br;H0;-1:5].[Br:4][C:1]-[C:2]=[O;H1;+1:3]'],
     'pKa': [None],
     'Description': 'Bromination of alpha carbonyl'},
    3: {'Templates': ['[Br:4][C:1]-[C:2]=[O;H1;+1:3]>>[Br:4][C:1]-[C:2]=[O;H0;+0:3]'],
     'pKa': [{'B': -3}],
     'Description': 'Deprotonation of carbonyl'}}},

  'Using FeBr3 or AlBr3': {'Reagent': ['Br[Fe,Al](Br)Br'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[Br:1][Br:2].[Br:3][Fe,Al:4]([Br:5])[Br:6]>>[Br:3][Fe,Al;-1:4]([Br:5])([Br:6])[Br;+1:1][Br:2]'],
                 'pKa': [None],
                 'Description': 'Activation of Lewis acid'},
    1: {'Templates': ['[Br:3][Fe,Al;-1:4]([Br:5])([Br:6])[Br;+1:1][Br:2].[*;a;+0:7]:[c;H1;+0:8]>>[Br:3][Fe,Al;-1:4]([Br:5])([Br:6])[Br;+0:1].[*;a;+1:7]:[c;H1;+0:8]-[Br;H0:2]'],
        'pKa': [None],
        'Description': 'Bromination of aromatic ring'},

    2: {'Templates': ['[Br;D1:3][Fe;-1:4]([Br;D1:5])([Br;D1:6])[Br;H1;D1;+0:1].[*;a;+1:7]:[c;H1;+0:8]-[Br;H0:2]>>[Br:3][Fe;+0:4]([Br:5])[Br:6].[Br;H1;+0:1].[*;a;+0:7]:[c;H0;+0:8]-[Br;H0:2]'],
     'pKa': [None],
     'Description': 'Proton exchange'}}},

  'Using NBS': {'Reagent': ['BrN'], 'Exclude_reagent': None,
    'Stages': {0: {'Templates': ['[Br,Cl,I:1][N:2]([C:3]=[O:4])[C:5]=[O:6].[*;a;+0:7]:[c;H1;+0:8]>>[N;-1;H0:2]([C:3]=[O:4])[C:5]=[O:6].[*;a;+1:7]:[c;H1;+0:8]-[Br,Cl,I;H0:1]'],
     'pKa': [None],
     'Description': 'Halogenation of aromatic ring'},
    1: {'Templates': ['[N;-1;H0:2].[*;a;+1:7][c;H1;+0:8]-[Br,Cl,I;H0:1]>>[N;H1;+0:2].[*;a;+0:7]:[c;H0;+0:8]-[Br,Cl,I;H0:1]'],
     'pKa': [None],
     'Description': 'Proton exchange'}}},},

 ('Chlorination',): {'NCS': {'Reagent': ['ClN(C=O)C=O'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[Br,Cl,I:1][N:2]([C:3]=[O:4])[C:5]=[O:6].[*;a;+0:7]:[c;H1;+0:8]>>[N;-1;H0:2]([C:3]=[O:4])[C:5]=[O:6].[*;a;+1:7]:[c;H1;+0:8]-[Br,Cl,I;H0:1]'],
     'pKa': [None],
     'Description': 'Halogenation of aromatic ring'},
    1: {'Templates': ['[N;-1;H0:2]([C:3]=[O:4])[C:5]=[O:6].[*;a;+1:7]:[c;H1;+0:8]-[Br,Cl,I;H0:1]>>[N;H1;+0:2]([C:3]=[O:4])[C:5]=[O:6].[*;a;+0:7]:[c;H0;+0:8]-[Br,Cl,I;H0:1]'],
     'pKa': [None],
     'Description': 'Proton exchange'}}},

  'Using FeCl3 or AlCl3': {'Reagent': ['Cl[Fe,Al](Cl)Cl', 'ClCl'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[Cl:1][Cl:2].[Cl:3][Fe,Al:4]([Cl:5])[Cl:6]>>[Cl:3][Fe,Al;-1:4]([Cl:5])([Cl:6])[Cl;+1:1][Cl:2]'],
                 'pKa': [None],
                 'Description': 'Activation of Lewis acid'},
    1: {'Templates': ['[Cl:3][Fe,Al;-1:4]([Cl:5])([Cl:6])[Cl;+1:1][Cl:2].[*;a;+0:7]:[c;H1;+0:8]>>[Cl:3][Fe,Al;-1:4]([Cl:5])([Cl:6])[Cl;+0:1].[*;a;+1:7]:[c;H1;+0:8]-[Cl;H0:2]'],
        'pKa': [None],
        'Description': 'Clorination of aromatic ring'},

    2: {'Templates': ['[Cl;D1:3][Fe;-1:4]([Cl;D1:5])([Cl;D1:6])[Cl;H0;D1;+0:1].[*;a;+1:7]:[c;H1;+0:8]-[Cl;H0:2]>>[Cl:3][Fe;+0:4]([Cl:5])[Cl:6].[Cl;H1;+0:1].[*;a;+0:7]:[c;H0;+0:8]-[Cl;H0:2]'],
     'pKa': [None],
     'Description': 'Proton exchange'}}}},

 ('Hydroxy to chloro',): {'SOCl2 or POCl3': {'Reagent': ['O=[S,P](-[Cl])-[Cl]','[O]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[O;H1;+0:1]>>[O;H0;-1:1]'],
     'pKa': [{'B': 14}],
     'Description': 'Deprotonation of alcohol'},
    1: {'Templates': ['[O;H0;-1:1].[O;+0:2]=[S,P;+0:3]-[Cl;+0:4]>>[O;H0;+0:1]-[S,P;+0:3](-[O;-1:2])-[Cl;+0:4]',
                      '[O;H1;+0:1].[O;+0:2]=[S,P;+0:3]-[Cl;+0:4]>>[O;H1;+1:1]-[S,P;+0:3](-[O;-1:2])-[Cl;+0:4]'],
     'pKa': [None],
     'Description': 'Addition of alkoxide'},
    2: {'Templates': ['[O;H0;+0:1]-[S,P;+0:3](-[O;-1:2])-[Cl;+0:4]>>[O;H0;+0:1]-[S,P;+0:3]=[O;+0:2].[Cl;-1:4]',
                      '[O;H1;+1:1]-[S,P;+0:3](-[O;-1:2])-[Cl;+0:4]>>[O;H1;+1:1]-[S,P;+0:3]=[O;+0:2].[Cl;-1:4]'],
     'pKa': [None],
     'Description': 'Chloride leaves'},
    3: {'Templates': ['[*:5]-[O;H0;+0:1]-[S,P;+0:3](-[Cl;+0:6])=[O;+0:2].[Cl;-1:4]>>[*:5]-[Cl;+0:4].[O;H0;+0:1]=[S,P;+0:3]=[O;+0:2].[Cl;-1:6]',
                      '[*:5]-[O;H1;+1:1]-[S,P;+0:3](-[Cl;+0:6])=[O;+0:2].[Cl;-1:4]>>[*:5]-[Cl;+0:4].[O;H1;+0:1]-[S,P;+1:3]=[O;+0:2].[Cl;-1:6]',
                      '[*:5]-[O;H0;+0:1]-[S,P;+0:3](=[O;+0:6])=[O;+0:2].[Cl;-1:4]>>[*:5]-[Cl;+0:4].[O;H0;-1:1]-[S,P;+0:3](=[O;+0:6])=[O;+0:2]',
                      '[*:5]-[O;H1;+1:1]-[S,P;+0:3](=[O;+0:6])=[O;+0:2].[Cl;-1:4]>>[*:5]-[Cl;+0:4].[O;H1;+0:1]-[S,P;+1:3](=[O;+0:6])=[O;+0:2]'],
     'pKa': [None, None],
     'Description': 'Nucleophilic substitution'},
    4: {'Templates': ['[O;H1;+0:1]-[S,P;+1:3]=[O;+0:2].[Cl;H0;-1:6]>>[O;H0;+0:1]=[S,P;+0:3]=[O;+0:2].[Cl;H1;+0:6]'],
     'pKa': [None,],
     'Description': 'Deprotonation'}}},

  'PCl5': {'Reagent': ['ClP(Cl)(Cl)(Cl)Cl','[O]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[O;H1;+0:1]>>[O;H0;-1:1]'],
     'pKa': [{'B': 14}],
     'Description': 'Deprotonation of alcohol'},
    1: {'Templates': ['[#6:5]-[O;H0;-1:1].[P;+0:2]-[Cl;+0:3]>>[#6:5]-[O;H0;+0:1]-[P;+0:2].[Cl;-1:3]',
                      '[#6:5]-[O;H1;+0:1].[P;+0:2]-[Cl;+0:3]>>[#6:5]-[O;H1;+1:1]-[P;+0:2].[Cl;-1:3]'],
     'pKa': [None, None],
     'Description': 'Addition of alkoxide'},
    2: {'Templates': ['[#6:5]-[O;H0;+0:1]-[P;+0:2]-[Cl;+0:3].[Cl;-1:4]>>[#6:5]-[Cl;+0:4].[O;H0;+0:1]=[P;+0:2].[Cl;-1:3]',
                      '[#6:5]-[O;H1;+1:1]-[P;+0:2]-[Cl;+0:3].[Cl;-1:4]>>[#6:5]-[Cl;+0:4].[O;H1;+0:1]-[P;+1:2].[Cl;-1:3]'],
     'pKa': [None, None],
     'Description': 'Nucleophilic substitution'},
    3: {'Templates': ['[O;H1;+0:1]-[P;+1:2].[Cl;H0;-1:3]>>[O;H0;+0:1]=[P;+0:2].[Cl;H1;+0:3]',],
      'pKa': [None],
      'Description': 'Deprotonation'},}},

  'Oxalyl chloride': {'Reagent': ['O=C(C(Cl)=O)Cl','[O]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[O;H1;+0:1]>>[O;H0;-1:1]'],
     'pKa': [{'B': 14}],
     'Description': 'Deprotonation of alcohol'},
    1: {'Templates': ['[O;H0;-1:1].[C$([C]=O);+0:2]-[Cl;+0:3]>>[O;H0;+0:1]-[C;+0:2].[Cl;-1:3]',
                      '[O;H1;+0:1].[C$([C]=O);+0:2]-[Cl;+0:3]>>[O;H1;+1:1]-[C;+0:2].[Cl;-1:3]'],
     'pKa': [None],
     'Description': 'Addition of alkoxide'},
    2: {'Templates': ['[*;+0:4]-[O;H0;+0:1]-[C;+0:2](=[O;+0:5])-[C;+0:6](=[O;+0:7])-[Cl;+0:8].[Cl;-1:3]>>[Cl;+0:3]-[*;+0:4].[O;H0;+0:1]=[C;+0:2]=[O;+0:5].[C;H0;-1:6]#[O;+1:7].[Cl;H0;-1:8]',
                      '[*;+0:4]-[O;H1;+1:1]-[C;+0:2](=[O;+0:5])-[C;+0:6](=[O;+0:7])-[Cl;+0:8].[Cl;-1:3]>>[Cl;+0:3]-[*;+0:4].[O;H1;+0:1]-[C;-1:2]=[O;+0:5].[C;H0;-1:6]#[O;+1:7].[Cl;H0;-1:8]',
                      ],
        'pKa': [None],
        'Description': 'Nucleophilic substitution'},
    3: {'Templates': ['[O;H1;+0:1]-[C;-1:2]=[O;+0:5].[Cl;H0;-1:8]>>[O;H0;+0:1]=[C;+0:2]=[O;+0:5].[Cl;H1;+0:8]',],
          'pKa': [None],
          'Description': 'Deprotonation'},
              }}},


 ('Iodination',): {'Using NIS': {'Reagent': ['IN(C=O)C=O'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[Br,Cl,I:1][N:2]([C:3]=[O:4])[C:5]=[O:6].[*;a;+0:7]:[c;H1;+0:8]>>[N;-1;H0:2]([C:3]=[O:4])[C:5]=[O:6].[*;a;+1:7]:[c;H1;+0:8]-[Br,Cl,I;H0:1]'],
     'pKa': [None],
     'Description': 'Halogenation of aromatic ring'},
    1: {'Templates': ['[N;-1;H0:2]([C:3]=[O:4])[C:5]=[O:6].[*;a;+1:7]:[c;H1;+0:8]-[Br,Cl,I;H0:1]>>[N;H1;+0:2]([C:3]=[O:4])[C:5]=[O:6].[*;a;+0:7]:[c;H0;+0:8]-[Br,Cl,I;H0:1]'],
     'pKa': [None],
     'Description': 'Proton exchange'}}},
  'Peroxide': {'Reagent': ['[O]-[O]', 'I-I'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[I;+0:1]-[I;+0:2].[O;H1;+0:3]-[O;H1;+0:4]>>[I;-1:1].[I:2]-[O;H1:3].[O;H1;-1:4]',
      '[I;+0:1]-[I;+0:2].[O;H1;+0:3]-[O;H0;+0:4]>>[I;-1:1].[I:2]-[O;H1:3].[O;H0;-1:4]'],
     'pKa': [None, None],
     'Description': 'Reaction of peroxide and iodine'},
    1: {'Templates': ['[I:1]-[O;H1:2].[*;a;+0:7]:[c;H1;+0:8]>>[O;H1;-1:2].[*;a;+1:7]:[c;H1;+0:8][I;H0:1]'],
     'pKa': [None],
     'Description': 'Halogenation of aromatic ring'},
    2: {'Templates': ['[O;H1;-1:2].[*;a;+1:7]:[c;H1;+0:8][I;H0:1]>>[O;H2;+0:2].[*;a;+0:7]:[c;H0;+0:8][I;H0:1]'],
     'pKa': [None],
     'Description': 'Proton exchange'}}}},


     ('Amide to amine reduction',): {'Reaction': {'Reagent': ['[Al,B;!H0]','[O]=[C]-[N]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[Li,Na:1][Al,B;H1,H2,H3,H4;+0:2]>>[Li,Na;+1:1].[Al,B;H1,H2,H3,H4;-1:2]'],
     'pKa': [None],
     'Description': 'Preparation of Borohydride or Alumanuide'},

    1: {'Templates': ['[Al,B;H4;-1;!$([Al,B]~[O]):2].[#7:6]-[#6;+0:4](=[O;+0:5])>>[#7:6]-[#6;H1;+0:4]-[O;H0;+0:5]-[Al,B;H3;-1:2]',
      '[Al,B;H3;-1;!$([Al,B]~[O]):2].[#7:6]-[#6;+0:4](=[O;+0:5])>>[#7:6]-[#6;H1;+0:4]-[O;H0;+0:5]-[Al,B;H2;-1:2]',
      '[Al,B;H2;-1;!$([Al,B]~[O]):2].[#7:6]-[#6;+0:4](=[O;+0:5])>>[#7:6]-[#6;H1;+0:4]-[O;H0;+0:5]-[Al,B;H1;-1:2]',
      '[Al,B;H1;-1;!$([Al,B]~[O]):2].[#7:6]-[#6;+0:4](=[O;+0:5])>>[#7:6]-[#6;H1;+0:4]-[O;H0;+0:5]-[Al,B;H0;-1:2]'],
     'pKa': [None, None, None, None],
     'Description': 'Hydride transfer'},
    2: {'Templates': ['[#7:6]-[#6;H1;+0:4]-[O;H0;+0:5]-[Al,B;H3;-1:2].[Li,Na,K;+1:1]>>[#7;+1:6]=[#6;H1;+0:4].[Li,Na,K;+0:1][O;H0;+0:5]-[Al,B;H3;-1:2]'],
     'pKa': [None],
     'Description': 'Oxygen leaves'},
    3: {'Templates': ['[Al,B;H4;-1;!$([Al,B]~[O]):2].[#7;+1:6]=[#6;H1;+0:4]>>[#7;+0:6]-[#6;H2;+0:4].[Al,B;H3;+0:2]',
                     '[Al,B;H3;-1;!$([Al,B]~[O]):2].[#7;+1:6]=[#6;H1;+0:4]>>[#7;+0:6]-[#6;H2;+0:4].[Al,B;H2;+0:2]',
                     '[Al,B;H2;-1;!$([Al,B]~[O]):2].[#7;+1:6]=[#6;H1;+0:4]>>[#7;+0:6]-[#6;H2;+0:4].[Al,B;H1;+0:2]',
                     '[Al,B;H1;-1;!$([Al,B]~[O]):2].[#7;+1:6]=[#6;H1;+0:4]>>[#7;+0:6]-[#6;H2;+0:4].[Al,B;H0;+0:2]'],
     'pKa': [None, None, None, None],
     'Description': 'Additional hydride transfer'}}}},


 ('Alcohol + amine condensation',): {'Mitsunobu style reaction': {'Reagent': ['C-N=N-C','[P]','[#6]-[O]','[N]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[P;!D0;+0:1].[N;H0;+0:2]=[N;H0;+0:3]>>[P;+1:1]-[N;H0;+0:2]-[N;H0;-1:3]'],
     'pKa': [None],
     'Description': 'Reaction between phosphine and diethylazodicarboxylate (DEAD)'},

    1: {'Templates': ['[P;+1:1]-[N;H0;+0:2]-[N;H0;-1:3].[#7,#16;H1;+0:4]>>[P;+1:1]-[N;H0;+0:2]-[N;H1;+0:3].[#7,#16;H0;-1:4]',
      '[P;+1:1]-[N;H0;+0:2]-[N;H0;-1:3].[#8;H1;+0:4]-[c:5]>>[P;+1:1]-[N;H0;+0:2]-[N;H1;+0:3].[#8;H0;-1:4]-[c:5]',
      '[P;+1:1]-[N;H0;+0:2]-[N;H0;-1:3].[#8;H1;+0:4]-[C:5]=[O:6]>>[P;+1:1]-[N;H0;+0:2]-[N;H1;+0:3].[#8;H0;-1:4]-[C:5]=[O:6]'],
     'pKa': [None, None, None],
     'Description': 'Proton exchange'},

    2: {'Templates': ['[P;+1:1]-[N;H0;+0:2]-[N;H1;+0:3].[#8;H1;+0:5]>[#8;H1;+1:5]-[P;+0:1]-[N;H0;+0:2]-[N;H1;+0:3]'],
     'pKa': [None],
     'Description': 'Forming a complex'},

    3: {'Templates': ['[#8;H1;+1:5]-[P;+0:1]-[N;H0;+0:2]-[N;H1;+0:3]>>[#8;H0;+1:5]=[P;+0:1].[N;H1;+0:2]-[N;H1;+0:3]'],
     'pKa': [None],
     'Description': 'Bond cleavage and proton exchange'},

    4: {'Templates': ['[P;+0:1]=[#8;H0;+1:5]-[#6;+0:6].[#7;H3;+0:4]>>[P;+0:1]=[#8;H0;+0:5].[#6;+0:6]-[#7;H3;+1:4]',
                     '[P;+0:1]=[#8;H0;+1:5]-[#6;+0:6].[#7;H2;+0:4]>>[P;+0:1]=[#8;H0;+0:5].[#6;+0:6]-[#7;H2;+1:4]',
                          '[P;+0:1]=[#8;H0;+1:5]-[#6;+0:6].[#7;H1;+0:4]>>[P;+0:1]=[#8;H0;+0:5].[#6;+0:6]-[#7;H1;+1:4]',
                     ],
     'pKa': [None, None, None],
     'Description': 'SN2 type reaction'},
     5: {'Templates': ['[#7;H3;+1:4]-[*:5]>>[#7;H2;+0:4]-[*:5]',
                     '[#7;H2;+1:4]-[*:5]>>[#7;H1;+0:4]-[*:5]',
                     '[#7;H1;+1:4]-[*:5]>>[#7;H0;+0:4]-[*:5]',],
     'pKa': [{'B': 9.25},{'B': 9.25},{'B': 9.25}],
     'Description': 'Deprotonation of protonated amine'}}},

  'React with SOCl2 or POCl3': {'Reagent': ['O=[S,P]-[Cl]','[#6]-[O]','[N]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[O;H1;+0:1]>>[O;H0;-1:1]'],
     'pKa': [{'B': 14}],
     'Description': 'Deprotonation of alcohol'},
    1: {'Templates': ['[O;H0;-1:1].[O;+0:2]=[S,P;+0:3]-[Cl;+0:4]>>[O;H0;+0:1]-[S,P;+0:3](-[O;-1:2])-[Cl;+0:4]'],
     'pKa': [None],
     'Description': 'Addition of alkoxide'},
    2: {'Templates': ['[O;H0;+0:1]-[S,P;+0:3](-[O;-1:2])-[Cl;+0:4]>>[O;H0;+0:1]-[S,P;+0:3]=[O;+0:2].[Cl;-1:4]'],
     'pKa': [None],
     'Description': 'Chloride leaves'},
    3: {'Templates': ['[*:5]-[O;H0;+0:1]-[S,P;+0:3](-[Cl;+0:6])=[O;+0:2].[#7;H3;+0:4]>>[#7;H3;+1:4]-[*:5].[O;H0;+0:1]=[S,P;+0:3]=[O;+0:2].[Cl;-1:6]',
                     '[*:5]-[O;H0;+0:1]-[S,P;+0:3](-[Cl;+0:6])=[O;+0:2].[#7;H2;+0:4]>>[#7;H2;+1:4]-[*:5].[O;H0;+0:1]=[S,P;+0:3]=[O;+0:2].[Cl;-1:6]',
                     '[*:5]-[O;H0;+0:1]-[S,P;+0:3](-[Cl;+0:6])=[O;+0:2].[#7;H1;+0:4]>>[#7;H1;+1:4]-[*:5].[O;H0;+0:1]=[S,P;+0:3]=[O;+0:2].[Cl;-1:6]'],
     'pKa': [None,None,None],
     'Description': 'Nucleophilic substitution'},
    4: {'Templates': ['[#7;H3;+1:4]-[*:5]>>[#7;H2;+0:4]-[*:5]',
                     '[#7;H2;+1:4]-[*:5]>>[#7;H1;+0:4]-[*:5]',
                     '[#7;H1;+1:4]-[*:5]>>[#7;H0;+0:4]-[*:5]',],
     'pKa': [{'B': 9.25},{'B': 9.25},{'B': 9.25}],
     'Description': 'Deprotonation of protonated amine'}}}},

 ('Friedel-Crafts acylation',): {'Reaction': {'Reagent': ['Cl[Al](Cl)Cl','[O]=[C]-[Cl]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates':['[Al;+3:1].[Cl;-1:2].[Cl;-1:3].[Cl;-1:4]>>[Al:1](-[Cl:2])(-[Cl:3])-[Cl:4]'],  #added this because all of the templates seemed to have AlCl3 ionically written
                  'pKa':[None],
                  'Description':'Interconversion between ionic and covalent form'},
              1: {'Templates': ['[Al:1](-[Cl:2])(-[Cl:3])-[Cl:4].[Cl:5]-[C:6]=[O:7]>>[O:7]=[C:6]-[Cl;+1:5]-[Al;-1:1](-[Cl:2])(-[Cl:3])-[Cl:4]'],
                 'pKa': [None],
                 'Description': 'Lewis acid activation'},
    2: {'Templates': ['[O:7]=[C:6]-[Cl;+1:5]-[Al;-1:1](-[Cl:2])(-[Cl:3])-[Cl:4]>>[O:7]=[C;+1:6].[Cl;+0:5]-[Al;-1:1](-[Cl:2])(-[Cl:3])-[Cl:4]'],
        'pKa': [None],
        'Description': 'AlCl4 leaves'},
    3: {'Templates': ['[O:7]=[C;+1:6].[a;+0:8]:[c;H1;+0:9]>>[a;+1:8]-[c;H1;+0:9]-[C;+0:6]=[O:7]'],
     'pKa': [None],
     'Description': 'Addition to aromatic ring'},
    4: {'Templates': ['[a;+1:8]-[c;H1;+0:9]-[C;+0:6]=[O:7].[Cl;+0:5]-[Al;-1:1]([Cl;+0:2])([Cl;+0:3])-[Cl;+0:4]>>[a;+0:8]:[c;H0;+0:9]-[C;+0:6]=[O:7].[Cl;H1;+0:5].[Al;+0:1]([Cl:2])([Cl:3])-[Cl:4]'],
     'pKa': [None],
     'Description': 'Proton exchange'}}}},

#read through more carefully again
  # Modified by Jihye
 ('Bromo Sonogashira coupling',
  'Iodo Sonogashira coupling',
  'Chloro Sonogashira coupling',
  'Triflyloxy Sonogashira coupling',
 'Bromo Stille reaction',
  'Chloro Stille reaction',
  'Iodo Stille reaction',): {'Reaction with element Pd':
     {'Reagent': ['[Pd;D0;+0]'], 'Exclude_reagent': None,
   'Stages': {
       0: {'Templates': ['[Cu:1]-[Cl,Br,I;H0:2].[#6;H1:3]#[#6;H0:4]>>[Cu:1]-[#6;H0;+0:3]#[#6:4].[Cl,Br,I;H1;+0:2]'],
     'pKa': [None], #TODO: NEEDS BASE FOR THIS STEP, need to add pKa
     'Description': 'Copper activation'},
       1: {'Templates': ['[Cl,Br,I,O$([O]-S):7]-[#6;+0:5].[Pd;D0;+0:6]>>[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]'],
     'pKa': [None],
     'Description': 'Oxidative addition'},
    2: {'Templates': ['[Cl,Br,I,O$([O]-S):5]-[Pd:1]-[#6:6].[Cu:2]-[#6:3]#[#6:4]>>[Cl,Br,I,O$([O]-S):5]-[Cu:2].[#6:6]-[Pd:1]-[#6:3]#[#6:4]',
                     '[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5].[Sn:1]-[#6;$([#6]=,:[#6]):2]>>[#6:2]-[Pd:6]-[#6;+0:5].[Sn:1]-[Cl,Br,I,O$([O]-S):7]'],
     'pKa': [None, None],
     'Description': 'Transmetalation'},
    3: {'Templates': ['[#6:6]-[Pd:1]-[#6:3]>>[Pd:1].[#6:6]-[#6:3]'],
     'pKa': [None],
     'Description': 'Reductive elimination'}}},

   'Reaction with PdX2, PPh3, and water': {'Reagent': ['[Cl,Br,I,O][Pd;+0][Cl,Br,I,O]', '[P]', '[O;H1,H2]'], 'Exclude_reagent': None,
    'Stages': {
        0: {'Templates': ['[Cl,Br,I,O:2]-[Pd;+0:1](-[Cl,Br,I,O:3])-[P;D4;+0:4]>>[Cl,Br,I,O:2]-[Pd;+0:1]-[Cl,Br,I,O:3].[P;D3;+0:4]',
                          '[Cl,Br,I,O:2]-[Pd;+0:1](-[Cl,Br,I,O:3])(-[P;D4;+0:4])(-[P;D4;+0:5])>>[Cl,Br,I,O:2]-[Pd;+0:1]-[Cl,Br,I,O:3].[P;D3;+0:4].[P;D3;+0:5]',],
     'pKa': [None],
     'Description': 'Palladium-ligand dissociation'},
       1: {'Templates': ['[Cl,Br,I,O:2]-[Pd;+0:1]-[Cl,Br,I,O:3].[P;D3:4]>>[Cl,Br,I,O:2]-[Pd;+0:1]-[P;H0;+1:4].[Cl,Br,I,O;-1:3]'],
     'pKa': [None],
     'Description': 'Palladium-ligand formation'},
      2: {'Templates': ['[OH2:1]>>[OH1;-1:1]'],
     'pKa': [{'B': 14}],
     'Description': 'Hydroxide ion preparation'},
       3: {'Templates': ['[Cl,Br,I,O:2]-[Pd;+0:1]-[P;H0;+1:4].[OH1;-1:5]>>[Cl,Br,I,O:2]-[Pd;+0:1]-[P;H0;+0:4]-[OH1;+0:5]',
                         '[Cl,Br,I,O:2]-[Pd;+0:1]-[P;H0;+1:4].[OH2;+0:5]>>[Cl,Br,I,O:2]-[Pd;+0:1]-[P;H0;+0:4]-[OH2;+1:5]'],
     'pKa': [None, None],
     'Description': 'Hydroxide-Phosphine reaction'},
    4: {'Templates': ['[Cl,Br,I,O:2]-[Pd;+0:1]-[P;H0;+0:4]-[OH2;+1:5]>>[Cl,Br,I,O:2]-[Pd;+0:1]-[P;H0;+0:4]-[OH1;+0:5]'],
     'pKa': [{'B': -1.7}],
     'Description': 'Deprotonation'},

     5: {'Templates': ['[Cl,Br,I,O:2]-[Pd;H0;+0:1]-[P;H0;+0:4]-[OH1;+0:5]>>[Cl,Br,I,O:2]-[Pd;H1;+0:1].[P;H0;+0:4]=[OH0;+0:5]'],
     'pKa': [None],
     'Description': 'Palladium reduction'},
    6: {'Templates': ['[Cl,Br,I,O:2]-[Pd;H1;+0:1]>>[Cl,Br,I,O;H1:2].[Pd;H0;+0:1]'],
       'pKa': [None],
       'Description': 'Ligand dissociation - reductive elimination type'},

     7: {'Templates': ['[Cu:1]-[Cl,Br,I;H0:2].[#6;H1:3]#[#6;H0:4]>>[Cu:1]-[#6;H0;+0:3]#[#6:4].[Cl,Br,I;H1;+0:2]'],
     'pKa': [None],
     'Description': 'Copper activation'},
      8: {'Templates': ['[Cl,Br,I,O$([O]-S):7]-[#6;+0:5].[Pd;+0:6]>>[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]'],
     'pKa': [None],
     'Description': 'Oxidative addition'},
    9: {'Templates': ['[Cl,Br,I,O$([O]-S):5]-[Pd:1]-[#6:6].[Cu:2]-[#6:3]#[#6:4]>>[Cl,Br,I,O$([O]-S):5]-[Cu:2].[#6:6]-[Pd:1]-[#6:3]#[#6:4]',
                     '[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5].[Sn:1]-[#6;$([#6]=,:[#6]):2]>>[#6:2]-[Pd:6]-[#6;+0:5].[Sn:1]-[Cl,Br,I,O$([O]-S):7]'],
     'pKa': [None, None],
     'Description': 'Transmetalation'},
    10: {'Templates': ['[#6:6]-[Pd:1]-[#6:3]>>[Pd:1].[#6:6]-[#6:3]'],
     'pKa': [None],
     'Description': 'Reductive elimination'}}},

'Reaction with Pd2+': {'Reagent': ['[Pd;+2]','[Cl,Br,I,O,-1]', '[P]', '[O;H1,H2]'], 'Exclude_reagent': None,
   'Stages': {
    0: {'Templates': ['[Cl,Br,I,O;-1:2].[Pd;+2:1]>>[Cl,Br,I,O;+0:2]-[Pd;+1:1]'],
     'pKa': [None],
     'Description': 'PdX+ formation'},
     1: {'Templates': ['[Cl,Br,I,O;+0:2]-[Pd;+1:1].[Cl,Br,I,O;-1:3]>>[Cl,Br,I,O;+0:2]-[Pd;+0:1]-[Cl,Br,I,O;+0:3]'],
     'pKa': [None],
     'Description': 'PdX2 formation'},
     2: {'Templates': ['[OH2:1]>>[OH1;-1:1]'],
     'pKa': [{'B': 14}],
     'Description': 'Hydroxide ion preparation'},
     3: {'Templates': ['[Cl,Br,I,O:2]-[Pd;+0:1]-[P;H0;+1:4].[OH1;-1:5]>>[Cl,Br,I,O:2]-[Pd;+0:1]-[P;H0;+0:4]-[OH1;+0:5]',
                         '[Cl,Br,I,O:2]-[Pd;+0:1]-[P;H0;+1:4].[OH2;+0:5]>>[Cl,Br,I,O:2]-[Pd;+0:1]-[P;H0;+0:4]-[OH2;+1:5]'],
     'pKa': [None, None],
     'Description': 'Hydroxide-Phosphine reaction'},
     4: {'Templates': [
           '[Cl,Br,I,O:2]-[Pd;+0:1]-[P;H0;+0:4]-[OH2;+1:5]>>[Cl,Br,I,O:2]-[Pd;+0:1]-[P;H0;+0:4]-[OH1;+0:5]'],
           'pKa': [{'B': -1.7}],
           'Description': 'Deprotonation'},

       5: {'Templates': [
           '[Cl,Br,I,O:2]-[Pd;H0;+0:1]-[P;H0;+0:4]-[OH1;+0:5]>>[Cl,Br,I,O:2]-[Pd;H1;+0:1].[P;H0;+0:4]=[OH0;+0:5]'],
           'pKa': [None],
           'Description': 'Palladium reduction'},
     6: {'Templates': ['[Cl,Br,I,O:2]-[Pd;H1;+1:1]>>[Cl,Br,I,O;H1:2].[Pd;H0;+0:1]'],
       'pKa': [None],
       'Description': 'Ligand dissociation - reductive elimination type'},
       7: {'Templates': ['[Cu:1]-[Cl,Br,I;H0:2].[#6;H1:3]#[#6;H0:4]>>[Cu:1]-[#6;H0;+0:3]#[#6:4].[Cl,Br,I;H1;+0:2]'],
           'pKa': [None],
           'Description': 'Copper activation'},
       8: {'Templates': ['[Cl,Br,I,O$([O]-S):7]-[#6;+0:5].[Pd;+0:6]>>[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]'],
           'pKa': [None],
           'Description': 'Oxidative addition'},
       9: {'Templates': [
           '[Cl,Br,I,O$([O]-S):5]-[Pd:1]-[#6:6].[Cu:2]-[#6:3]#[#6:4]>>[Cl,Br,I,O$([O]-S):5]-[Cu:2].[#6:6]-[Pd:1]-[#6:3]#[#6:4]',
           '[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5].[Sn:1]-[#6;$([#6]=,:[#6]):2]>>[#6:2]-[Pd:6]-[#6;+0:5].[Sn:1]-[Cl,Br,I,O$([O]-S):7]'],
           'pKa': [None, None],
           'Description': 'Transmetalation'},
       10: {'Templates': ['[#6:6]-[Pd:1]-[#6:3]>>[Pd:1].[#6:6]-[#6:3]'],
            'pKa': [None],
            'Description': 'Reductive elimination'}}},
    # Based on the mechanism described in https://doi.org/10.1021/ol101106z .
    'Reaction with PdX2 and 1,5-cyclooctadiene': {
                'Reagent': ['[Cl,Br,I,O][Pd;+0][Cl,Br,I,O]', 'C1=CCCC=CCC1'], 'Exclude_reagent': None,
    'Stages': {
        0: {'Templates': [
            '[Cl,Br,I,O:2]-[Pd;+0:1]-[Cl,Br,I,O:3].[CH1:4]1=[CH1:5][CH2:6][CH2:7][CH1:8]=[CH1:9][CH2:10][CH2:11]1>>[Cl,Br,I,O:2][Pd;+0:1]123([C@@H:4]4[C@H:5]1[CH2:6][CH2:7][C@H:8]2[C@H:9]3[CH2:10][CH2:11]4)[Cl,Br,I,O:3]'],
            'pKa': [None],
            'Description': 'Palladium-ligand formation'},
        1: {'Templates': ['[OH2:1]>>[OH1;-1:1]',
                          '[OH1:1][C;!$(C=O):2]>>[OH0;-1:1][C;!$(C=O):2]'],
            'pKa': [{'B': 14}, {'B': 14}],
            'Description': 'Hydroxide ion preparation'},
        2: {'Templates': [
            '[Cl,Br,I,O:2][Pd;+0:1]123([C@@H:4]4[C@H:5]1[CH2:6][CH2:7][C@H:8]2[C@H:9]3[CH2:10][CH2:11]4)[Cl,Br,I,O:3].[O;-1:12]>>[Cl,Br,I,O:2][Pd;+0:1]12([CH20:4]3[C@H:5]1[CH2:6][CH2:7][C@H:8]2[CH:9]([O;+0:12])[CH2:10][CH2:11]3)[Cl,Br,I,O:3]', ],
            'pKa': [None],
            'Description': 'Hydroxide-cyclooctadiene reaction'},

        3: {'Templates': [
            '[Cl,Br,I,O:2][Pd;+0:1]12([CH20:4]3[C@H:5]1[CH2:6][CH2:7][C@H:8]2[CH:9]([O;+0:12])[CH2:10][CH2:11]3)[Cl,Br,I,O:3]>>[Cl,Br,I,O:2]-[Pd;H1;+1:1].[Cl,Br,I,O;-1:3].[CH1:4]1=[CH1:5][CH2:6][CH2:7][CH1:8]=[CH1:9]([O;+0:12])[CH2:10][CH2:11]1', ],
            'pKa': [None, ],
            'Description': 'Beta-H elimination'},
        4: {'Templates': ['[Cl,Br,I,O:2]-[Pd;H1;+1:1]>>[Cl,Br,I,O;H1:2].[Pd;H0;+0:1]'],
            'pKa': [None],
            'Description': 'Ligand dissociation - reductive elimination type'},
       5: {'Templates': ['[Cu:1]-[Cl,Br,I;H0:2].[#6;H1:3]#[#6;H0:4]>>[Cu:1]-[#6;H0;+0:3]#[#6:4].[Cl,Br,I;H1;+0:2]'],
           'pKa': [None],
           'Description': 'Copper activation'},
       6: {'Templates': ['[Cl,Br,I,O$([O]-S):7]-[#6;+0:5].[Pd;+0:6]>>[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]'],
           'pKa': [None],
           'Description': 'Oxidative addition'},
       7: {'Templates': [
           '[Cl,Br,I,O$([O]-S):5]-[Pd:1]-[#6:6].[Cu:2]-[#6:3]#[#6:4]>>[Cl,Br,I,O$([O]-S):5]-[Cu:2].[#6:6]-[Pd:1]-[#6:3]#[#6:4]',
           '[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5].[Sn:1]-[#6;$([#6]=,:[#6]):2]>>[#6:2]-[Pd:6]-[#6;+0:5].[Sn:1]-[Cl,Br,I,O$([O]-S):7]'],
           'pKa': [None, None],
           'Description': 'Transmetalation'},
        9: {'Templates': ['[#6:6]-[Pd:1]-[#6:3]>>[Pd:1].[#6:6]-[#6:3]'],
            'pKa': [None],
            'Description': 'Reductive elimination'}}},
# Based on the mechanism described in https://chem.libretexts.org/Bookshelves/Inorganic_Chemistry/Supplemental_Modules_and_Websites_(Inorganic_Chemistry)/Catalysis/Catalyst_Examples/Heck_Reaction. ##
'Reaction with Pd(OR)2 and amine agent': {'Reagent': ['[O][Pd;+0][O]', '[N;+0]-[C;!H0]'], 'Exclude_reagent': None,
'Stages': {0: {'Templates': [
  '[O:2]-[Pd;+0:1]-[O:3].[N;+0:4]-[C;!H0:5]>>[O:2]-[Pd;+0:1]-[N;+1:4]-[C;!H0:5].[O;-1:3]'],
             'pKa': [None],
             'Description': 'Amine coordination'},
         1: {'Templates': [
             '[O:2]-[Pd;+0:1]-[N;+1:4]-[C;H3:5]>>[O:2]-[Pd;H1;+0:1].[N;+0:4]=[C;H2:5]',
             '[O:2]-[Pd;+0:1]-[N;+1:4]-[C;H2:5]>>[O:2]-[Pd;H1;+0:1].[N;+0:4]=[C;H1:5]',
             '[O:2]-[Pd;+0:1]-[N;+1:4]-[C;H1:5]>>[O:2]-[Pd;H1;+0:1].[N;+0:4]=[C;H0:5]', ],
             'pKa': [None, None, None],
             'Description': 'Imine formation'},
         2: {'Templates': [
             '[O:2]-[Pd;H1;+0:1]>>[O;H1:2].[Pd;H0;+0:1]', ],
             'pKa': [None],
             'Description': 'Reductive elimination'},
        3: {'Templates': ['[Cu:1]-[Cl,Br,I;H0:2].[#6;H1:3]#[#6;H0:4]>>[Cu:1]-[#6;H0;+0:3]#[#6:4].[Cl,Br,I;H1;+0:2]'],
           'pKa': [None],
           'Description': 'Copper activation'},
       4: {'Templates': ['[Cl,Br,I,O$([O]-S):7]-[#6;+0:5].[Pd;+0:6]>>[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]'],
           'pKa': [None],
           'Description': 'Oxidative addition'},
       5: {'Templates': [
           '[Cl,Br,I,O$([O]-S):5]-[Pd:1]-[#6:6].[Cu:2]-[#6:3]#[#6:4]>>[Cl,Br,I,O$([O]-S):5]-[Cu:2].[#6:6]-[Pd:1]-[#6:3]#[#6:4]',
           '[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5].[Sn:1]-[#6;$([#6]=,:[#6]):2]>>[#6:2]-[Pd:6]-[#6;+0:5].[Sn:1]-[Cl,Br,I,O$([O]-S):7]'],
           'pKa': [None, None],
           'Description': 'Transmetalation'},
       6: {'Templates': ['[#6:6]-[Pd:1]-[#6:3]>>[Pd:1].[#6:6]-[#6:3]'],
            'pKa': [None],
            'Description': 'Reductive elimination'}}},

'Reaction with Pd coordinated with 3 or 4 ligands': {'Reagent': ['[Pd;D3,D4;$([Pd](-[*])(-[*])-[*]),$([Pd](-[*])(-[*])(-[*])-[*]);!$([Pd]([Cl,Br,I,O])[Cl,Br,I,O]);+0]'],
                                                     'Exclude_reagent': None,
     'Stages': {0: {'Templates': ['[Pd;D4;+0:1](-[*:6])(-[*:4])(-[*:5])-[*:8]>>[Pd;D3;+0:1](-[*:6])(-[*:4])(-[*:5]).[*:8]',],
     'pKa': [None, ],
     'Description': 'Ligand leaving'},
      1: {'Templates': ['[Pd;D3;+0:1](-[*:6])(-[*:5])-[*:8]>>[Pd;D2;+0:1](-[*:6])(-[*:5]).[*:8]',],
         'pKa': [None, ],
         'Description': 'Ligand leaving'},
      2: {'Templates': ['[Pd;D2;+0;!$([Pd]~[Cl,Br,I,O]:1](-[*;!Cl;!Br;!I;!O:6])-[*;!Cl;!Br;!I;!O:5]>>[Pd;+0:1].[*:6].[*:5]',],
         'pKa': [None, ],
         'Description': 'Ligand leaving'},
            3: {'Templates': ['[Cu:1]-[Cl,Br,I;H0:2].[#6;H1:3]#[#6;H0:4]>>[Cu:1]-[#6;H0;+0:3]#[#6:4].[Cl,Br,I;H1;+0:2]'],
     'pKa': [None],
     'Description': 'Copper activation'},
             4: {'Templates': ['[Cl,Br,I,O$([O]-S):7]-[#6;+0:5].[Pd;D0;+0:6]>>[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]'],
     'pKa': [None],
     'Description': 'Oxidative addition'},
    5:{'Templates': ['[Cl,Br,I,O$([O]-S):5]-[Pd:1]-[#6:6].[Cu:2]-[#6:3]#[#6:4]>>[Cl,Br,I,O$([O]-S):5]-[Cu:2].[#6:6]-[Pd:1]-[#6:3]#[#6:4]',
                     '[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5].[Sn:1]-[#6;$([#6]=,:[#6]):2]>>[#6:2]-[Pd:6]-[#6;+0:5].[Sn:1]-[Cl,Br,I,O$([O]-S):7]'],
     'pKa': [None, None],
     'Description': 'Transmetalation'},
    6: {'Templates': ['[#6:6]-[Pd:1]-[#6:3]>>[Pd:1].[#6:6]-[#6:3]'],
     'pKa': [None],
     'Description': 'Reductive elimination'}}},

        'Reaction with Pd coordinated with 2 ligands': {'Reagent': ['[!Cl;!Br;!I;!O][Pd;D2;+0][!Cl;!Br;!I;!O]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[Cu:1]-[Cl,Br,I;H0:2].[#6;H1:3]#[#6;H0:4]>>[Cu:1]-[#6;H0;+0:3]#[#6:4].[Cl,Br,I;H1;+0:2]'],
     'pKa': [None],
     'Description': 'Copper activation'},

             1: {'Templates': ['[Cl,Br,I,O$([O]-S):7]-[#6;+0:5].[Pd;+0:6]>>[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5]'],
     'pKa': [None],
     'Description': 'Oxidative addition'},

    2:{'Templates': ['[Cl,Br,I,O$([O]-S):5]-[Pd:1]-[#6:6].[Cu:2]-[#6:3]#[#6:4]>>[Cl,Br,I,O$([O]-S):5]-[Cu:2].[#6:6]-[Pd:1]-[#6:3]#[#6:4]',
                     '[Cl,Br,I,O$([O]-S):7]-[Pd:6]-[#6;+0:5].[Sn:1]-[*:2]>>[*:2]-[Pd:6]-[#6;+0:5].[Sn:1]-[Cl,Br,I,O$([O]-S):7]'],
     'pKa': [None, None],
     'Description': 'Transmetalation'},
    3: {'Templates': ['[#6:6]-[Pd:1]-[#6:3]>>[Pd:1].[#6:6]-[#6:3]'],
     'pKa': [None],
     'Description': 'Reductive elimination'}}}},

 ('Knoevenagel condensation',
 'Claisen-Schmidt condensation',
  'Aldol condensation',): {'Basic condition': {'Reagent': ['[O]=[C]-[C]','[C]=[O]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[#8:1]=[#6:2]-[#6;H2:3]-[#6:4]=[#8:5]>>[#8:1]=[#6:2]-[#6;H1;-1:3]-[#6:4]=[#8:5]',
                               '[#8:1]=[#6:2](-[!#8:4])-[#6;H3:3]>>[#8:1]=[#6:2](-[!#8:4])-[#6;H2;-1:3]',
                               '[#8:1]=[#6:2]-[#6;H2:3]>>[#8:1]=[#6:2]-[#6;H1;-1:3]',
                               '[#7:1]#[#6:2]-[#6;H3:3]>>[#7:1]#[#6:2]-[#6;H3;-1:3]',
                               '[#7:1]#[#6:2]-[#6;H2:3]>>[#7:1]#[#6:2]-[#6;H1;-1:3]'],
     'pKa': [{'B': 6},{'B': 14}, {'B': 14}, {'B': 14}, {'B': 14}],
     'Description': 'Deprotonation of alpha position carbon'},
    1: {'Templates': ['[#6;D1;H2;-1:3].[#6:4]=[#8:5]>>[#6;D2;H2;+0:3]-[#6:4]-[#8;-1:5]',
                      '[#6;D2;H1;-1:3].[#6:4]=[#8:5]>>[#6;D3;H1;+0:3]-[#6:4]-[#8;-1:5]'],
     'pKa': [None,None],
     'Description': 'Addition of enolate'},
     2: {'Templates': ['[#6;D2;H2;+0:3]-[#6:4]-[#8;H0;-1:5]>>[#6;D2;H2;+0:3]-[#6:4]-[#8;H1;+0:5]',
                       '[#6;D3;H1;+0:3]-[#6:4]-[#8;H0;-1:5]>>[#6;D3;H1;+0:3]-[#6:4]-[#8;H1;+0:5]'],
     'pKa': [{'A': 14}, {'A': 14}],
     'Description': 'Protonation of alkoxide'},

    3: {'Templates': ['[#8:1]=[#6:2][#6;H1;+0:3]-[#6:4]-[#8;H1;+0:5]>>[#8:1]=[#6:2][#6;H0;+0:3]=[#6:4].[#8;H1;-1:5]',
                      '[#8:1]=[#6:2][#6;H1;+0:3](-[#6:4]-[#8;H1;+0:5])-[#6:6]=[#8:7]>>[#8:1]=[#6:2][#6;H0;+0:3](=[#6:4])-[#6:6]=[#8:7].[#8;H1;-1:5]',
                      '[#8:1]=[#6:2][#6;H2;+0:3]-[#6:4]-[#8;H1;+0:5]>>[#8:1]=[#6:2][#6;H1;+0:3]=[#6:4].[#8;H1;-1:5]',
                      '[#8:1]=[#6:2][#6;H2;+0:3](-[#6:4]-[#8;H1;+0:5])-[#6:6]=[#8:7]>>[#8:1]=[#6:2][#6;H1;+0:3](=[#6:4])-[#6:6]=[#8:7].[#8;H1;-1:5]',
      '[#7:1]#[#6:2]-[#6;H1;+0:3]-[#6:4]-[#8;H1;+0:5]>>[#7:1]#[#6:2]-[#6;H0;+0:3]=[#6:4].[#8;H1;-1:5]'],
     'pKa': [{'B': 14},{'B': 6},{'B': 14},{'B': 6}, {'B': 14}],
     'Description': 'Condensation'}}},

    'Acidic condition': {'Reagent': ['[O]=[C]-[C]','[C]=[O]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[#8;+0;H0:1]=[#6:2]>>[#8;H1;+1:1]=[#6:2]'],
     'pKa': [{'A': 0.001}],
     'Description': 'Protonation of carbonyl'},

    1: {'Templates': ['[#8;H1;+1:1]=[#6:2]-[#6;H3;+0:3]>>[#8;H1;+0:1]-[#6:2]=[#6;H2;+0:3]',
                      '[#8;H1;+1:1]=[#6:2]-[#6;H2;+0:3]>>[#8;H1;+0:1]-[#6:2]=[#6;H1;+0:3]'],
     'pKa': [{'B': -3}, {'B': -3}],
     'Description': 'Formation of enol'},

    2:{'Templates': ['[#8;H1;+0:1]-[#6:2]=[#6;H2;+0:3].[#6:4]=[#8:5]>>[#8;H1;+1:1]=[#6:2]-[#6;H2;+0:3]-[#6:4]-[#8;-1:5]',
                     '[#8;H1;+0:1]-[#6:2]=[#6;H1;+0:3].[#6:4]=[#8:5]>>[#8;H1;+1:1]=[#6:2]-[#6;H1;+0:3]-[#6:4]-[#8;-1:5]',],
     'pKa': [None,None],
     'Description': 'Addition of enol'},
    3: {'Templates': ['[#8;H1;+1:1]=[#6:2]-[#6:3]-[#6:4]-[#8;-1:5]>>[#8;H0;+0:1]=[#6:2]-[#6:3]-[#6:4]-[#8;H1;+0:5]'],
     'pKa': [None],
     'Description': 'Proton transfer'},
    4: {'Templates': ['[#8;H0;+0:1]=[#6:2]-[#6:3]-[#6:4]-[#8;H1;+0:5]>>[#8;H0;+0:1]=[#6:2]-[#6:3]-[#6:4]-[#8;H2;+1:5]'],
     'pKa': [{'A': 0.0001}],
     'Description': 'Protonation of alcohol'},

    5: {'Templates': ['[#8;H0;+0:1]=[#6:2]-[#6;H2:3]-[#6:4]-[#8;H2;+1:5]>>[#8;H0;+0:1]=[#6:2]-[#6;H1:3]=[#6:4].[#8;H2;+0:5]',
                      '[#8;H0;+0:1]=[#6:2]-[#6;H1:3]-[#6:4]-[#8;H2;+1:5]>>[#8;H0;+0:1]=[#6:2]-[#6;H0:3]=[#6:4].[#8;H2;+0:5]'],
     'pKa': [{'B': -3}, {'B': -3}],
     'Description': 'Condensation'}}}},

#### TODO: Chem.MolFromSmarts('[Br:1]') generates implicit hydrogen.
 ('Wohl-Ziegler bromination',): {'Reaction with radical': {'Reagent': ['[#7,#8;D2]-,=[#7,#8;D2]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[#6:1]-[C:2](=[O:3])-[O:4]-[O:5]-[C:6](=[O:7])-[#6:8]>>[#6;H0;+0:1].[#6;H0;+0:8].[O:4]=[C:2]=[O:3].[O:5]=[C:6]=[O:7]',
      '[*:1]-[N:2]=[N:3]-[*:4]>>[*;H0;+0:1].[*;H0;+0:4].[N:3]#[N:4]'],
     'pKa': [None, None],
     'Description': 'Radical formation'},
    1: {'Templates': ['[Br:1][N:2]([C:3]=[O:4])[C:5]=[O:6].[#6;v3;H0;+0:7]>>[Br;H0;+0:1].[O:4]=[C:3][N:2]=[C:5]-[O:6]-[#6;H0;+0:7]'],
     'pKa': [None],
     'Description': 'Reaction with NBS'},
    2: {'Templates': ['[Br;D0;H0;+0:1].[C;D1;H3;+0:2]-[#6:3]=[#6:4]>>[Br;H1;+0:1].[C;D1;H2;+0:2]-[#6:3]=[#6:4]',
      '[Br;D0;H0;+0:1].[C;D2;H2;+0:2]-[#6:3]=[#6:4]>>[Br;H1;+0:1].[C;D2;H1;+0:2]-[#6:3]=[#6:4]',
      '[Br;D0;H0;+0:1].[C;D3;H1;+0:2]-[#6:3]=[#6:4]>>[Br;H1;+0:1].[C;D3;H0;+0:2]-[#6:3]=[#6:4]',
      '[Br;D0;H0;+0:1].[C;D1;H3;+0:2]-[#6:3]=[#6:4]>>[Br;H1;+0:1].[C;D1;H2;+0:2]=[#6:3]-[#6;+0:4]',
      '[Br;D0;H0;+0:1].[C;D2;H2;+0:2]-[#6:3]=[#6:4]>>[Br;H1;+0:1].[C;D2;H1;+0:2]=[#6:3]-[#6;+0:4]',
      '[Br;D0;H0;+0:1].[C;D3;H1;+0:2]-[#6:3]=[#6:4]>>[Br;H1;+0:1].[C;D3;H0;+0:2]-[#6:3]-[#6;+0:4]',
      '[Br;D0;H0;+0:1].[C;D1;H3;+0:2]-[#6:3]:[#6:4]>>[Br;H1;+0:1].[C;D1;H2;+0:2]-[#6:3]:[#6:4]',
      '[Br;D0;H0;+0:1].[C;D2;H2;+0:2]-[#6:3]:[#6:4]>>[Br;H1;+0:1].[C;D2;H1;+0:2]-[#6:3]:[#6:4]',
      '[Br;D0;H0;+0:1].[C;D3;H1;+0:2]-[#6:3]:[#6:4]>>[Br;H1;+0:1].[C;D3;H0;+0:2]-[#6:3]:[#6:4]',
      '[Br;D0;H0;+0:1].[C;D1;H3;+0:2]-[#6:3]=[#7,#8:4]>>[Br;H1;+0:1].[C;D1;H2;+0:2]-[#6:3]=[#7,#8:4]',
      '[Br;D0;H0;+0:1].[C;D2;H2;+0:2]-[#6:3]=[#7,#8:4]>>[Br;H1;+0:1].[C;D2;H1;+0:2]-[#6:3]=[#7,#8:4]',
      '[Br;D0;H0;+0:1].[C;D3;H1;+0:2]-[#6:3]=[#7,#8:4]>>[Br;H1;+0:1].[C;D3;H0;+0:2]-[#6:3]=[#7,#8:4]'],
     'pKa': [None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None],
     'Description': 'Propagation'},
    3: {'Templates': ['[Br;D0;H0;+0:1].[C;D1;H2;+0:2]-[#6:3]=[#6:4]>>[Br;H0;+0:1]-[C;H2;+0:2]-[#6:3]=[#6:4]',
      '[Br;D0;H0;+0:1].[C;D2;H1;+0:2]-[#6:3]=[#6:4]>>[Br;H0;+0:1]-[C;H1;+0:2]-[#6:3]=[#6:4]',
      '[Br;D0;H0;+0:1].[C;D3;H0;+0:2]-[#6:3]=[#6:4]>>[Br;H0;+0:1]-[C;H0;+0:2]-[#6:3]=[#6:4]',
      '[Br;D0;H0;+0:1].[C;D1;H2;+0:2]=[#6:3]-[#6;+0:4]>>[C;H2;+0:2]=[#6:3]-[#6;+0:4]-[Br;H0;+0:1]',
      '[Br;D0;H0;+0:1].[C;D2;H1;+0:2]=[#6:3]-[#6;+0:4]>>[C;H1;+0:2]=[#6:3]-[#6;+0:4]-[Br;H0;+0:1]',
      '[Br;D0;H0;+0:1].[C;D3;H0;+0:2]=[#6:3]-[#6;+0:4]>>[C;H0;+0:2]=[#6:3]-[#6;+0:4]-[Br;H0;+0:1]',
      '[Br;D0;H0;+0:1].[C;D1;H2;+0:2]-[#6:3]:[#6:4]>>[Br;H0;+0:1]-[C;H2;+0:2]-[#6:3]:[#6:4]',
      '[Br;D0;H0;+0:1].[C;D2;H1;+0:2]-[#6:3]:[#6:4]>>[Br;H0;+0:1]-[C;H1;+0:2]-[#6:3]:[#6:4]',
      '[Br;D0;H0;+0:1].[C;D3;H0;+0:2]-[#6:3]:[#6:4]>>[Br;H0;+0:1]-[C;H0;+0:2]-[#6:3]:[#6:4]',
      '[Br;D0;H0;+0:1].[C;D1;H2;+0:2]-[#6:3]=[#7,#8:4]>>[Br;H0;+0:1]-[C;H2;+0:2]-[#6:3]=[#7,#8:4]',
      '[Br;D0;H0;+0:1].[C;D2;H1;+0:2]-[#6:3]=[#7,#8:4]>>[Br;H0;+0:1]-[C;H1;+0:2]-[#6:3]=[#7,#8:4]',
      '[Br;D0;H0;+0:1].[C;D3;H0;+0:2]-[#6:3]=[#7,#8:4]>>[Br;H0;+0:1]-[C;H0;+0:2]-[#6:3]=[#7,#8:4]'],
     'pKa': [None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None],
     'Description': 'Termination'}}},

  'Reaction with NBS': {'Reagent': None,  'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[Br:1][N:2]([C:3]=[O:4])[C:5]=[O:6]>>[Br;H0;+0:1].[N;H0;+0:2]([C:3]=[O:4])[C:5]=[O:6]'],
     'pKa': [None],
     'Description': 'Radical formation'},
    1: {'Templates': ['[Br;D0;H0;+0:1].[C;H3;+0:2]-[#6:3]=[#6:4]>>[Br;H1;+0:1].[C;H2;+0:2]-[#6:3]=[#6:4]',
      '[Br;D0;H0;+0:1].[C;H2;+0:2]-[#6:3]=[#6:4]>>[Br;H1;+0:1].[C;H1;+0:2]-[#6:3]=[#6:4]',
      '[Br;D0;H0;+0:1].[C;H1;+0:2]-[#6:3]=[#6:4]>>[Br;H1;+0:1].[C;H0;+0:2]-[#6:3]=[#6:4]',
      '[Br;D0;H0;+0:1].[C;H3;+0:2]-[#6:3]=[#6:4]>>[Br;H1;+0:1].[C;H2;+0:2]=[#6:3]-[#6;+0:4]',
      '[Br;D0;H0;+0:1].[C;H2;+0:2]-[#6:3]=[#6:4]>>[Br;H1;+0:1].[C;H1;+0:2]=[#6:3]-[#6;+0:4]',
      '[Br;D0;H0;+0:1].[C;H1;+0:2]-[#6:3]=[#6:4]>>[Br;H1;+0:1].[C;H0;+0:2]-[#6:3]-[#6;+0:4]',
      '[Br;D0;H0;+0:1].[C;H3;+0:2]-[#6:3]:[#6:4]>>[Br;H1;+0:1].[C;H2;+0:2]-[#6:3]:[#6:4]',
      '[Br;D0;H0;+0:1].[C;H2;+0:2]-[#6:3]:[#6:4]>>[Br;H1;+0:1].[C;H1;+0:2]-[#6:3]:[#6:4]',
      '[Br;D0;H0;+0:1].[C;H1;+0:2]-[#6:3]:[#6:4]>>[Br;H1;+0:1].[C;H0;+0:2]-[#6:3]:[#6:4]',
      '[Br;D0;H0;+0:1].[C;H3;+0:2]-[#6:3]=[#7,#8:4]>>[Br;H1;+0:1].[C;H2;+0:2]-[#6:3]=[#7,#8:4]',
      '[Br;D0;H0;+0:1].[C;H2;+0:2]-[#6:3]=[#7,#8:4]>>[Br;H1;+0:1].[C;H1;+0:2]-[#6:3]=[#7,#8:4]',
      '[Br;D0;H0;+0:1].[C;H1;+0:2]-[#6:3]=[#7,#8:4]>>[Br;H1;+0:1].[C;H0;+0:2]-[#6:3]=[#7,#8:4]',
      '[N&!$([N]-Br);H0;+0:5]([C:6]=[O:7])[C:8]=[O:9].[C;H3;+0:2]-[#6:3]=[#6:4]>>[N;H1;+0:5]([C:6]=[O:7])[C:8]=[O:9].[C;H2;+0:2]-[#6:3]=[#6:4]',
      '[N&!$([N]-Br);H0;+0:5]([C:6]=[O:7])[C:8]=[O:9].[C;H2;+0:2]-[#6:3]=[#6:4]>>[N;H1;+0:5]([C:6]=[O:7])[C:8]=[O:9].[C;H1;+0:2]-[#6:3]=[#6:4]',
      '[N&!$([N]-Br);H0;+0:5]([C:6]=[O:7])[C:8]=[O:9].[C;H1;+0:2]-[#6:3]=[#6:4]>>[N;H1;+0:5]([C:6]=[O:7])[C:8]=[O:9].[C;H0;+0:2]-[#6:3]=[#6:4]',
      '[N&!$([N]-Br);H0;+0:5]([C:6]=[O:7])[C:8]=[O:9].[C;H3;+0:2]-[#6:3]=[#6:4]>>[N;H1;+0:5]([C:6]=[O:7])[C:8]=[O:9].[C;H2;+0:2]=[#6:3]-[#6;+0:4]',
      '[N&!$([N]-Br);H0;+0:5]([C:6]=[O:7])[C:8]=[O:9].[C;H2;+0:2]-[#6:3]=[#6:4]>>[N;H1;+0:5]([C:6]=[O:7])[C:8]=[O:9].[C;H1;+0:2]=[#6:3]-[#6;+0:4]',
      '[N&!$([N]-Br);H0;+0:5]([C:6]=[O:7])[C:8]=[O:9].[C;H1;+0:2]-[#6:3]=[#6:4]>>[N;H1;+0:5]([C:6]=[O:7])[C:8]=[O:9].[C;H0;+0:2]-[#6:3]-[#6;+0:4]',
      '[N&!$([N]-Br);H0;+0:5]([C:6]=[O:7])[C:8]=[O:9].[C;H3;+0:2]-[#6:3]:[#6:4]>>[N;H1;+0:5]([C:6]=[O:7])[C:8]=[O:9].[C;H2;+0:2]-[#6:3]:[#6:4]',
      '[N&!$([N]-Br);H0;+0:5]([C:6]=[O:7])[C:8]=[O:9].[C;H2;+0:2]-[#6:3]:[#6:4]>>[N;H1;+0:5]([C:6]=[O:7])[C:8]=[O:9].[C;H1;+0:2]-[#6:3]:[#6:4]',
      '[N&!$([N]-Br);H0;+0:5]([C:6]=[O:7])[C:8]=[O:9].[C;H1;+0:2]-[#6:3]:[#6:4]>>[N;H1;+0:5]([C:6]=[O:7])[C:8]=[O:9].[C;H0;+0:2]-[#6:3]:[#6:4]',
      '[N&!$([N]-Br);H0;+0:5]([C:6]=[O:7])[C:8]=[O:9].[C;H3;+0:2]-[#6:3]=[#7,#8:4]>>[N;H1;+0:5]([C:6]=[O:7])[C:8]=[O:9].[C;H2;+0:2]-[#6:3]=[#7,#8:4]',
      '[N&!$([N]-Br);H0;+0:5]([C:6]=[O:7])[C:8]=[O:9].[C;H2;+0:2]-[#6:3]=[#7,#8:4]>>[N;H1;+0:5]([C:6]=[O:7])[C:8]=[O:9].[C;H1;+0:2]-[#6:3]=[#7,#8:4]',
      '[N&!$([N]-Br);H0;+0:5]([C:6]=[O:7])[C:8]=[O:9].[C;H1;+0:2]-[#6:3]=[#7,#8:4]>>[N;H1;+0:5]([C:6]=[O:7])[C:8]=[O:9].[C;H0;+0:2]-[#6:3]=[#7,#8:4]'],
     'pKa': [None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None],
     'Description': 'Propagation'},
    2: {'Templates': ['[Br;D0;H0;+0:1].[C;H2;+0:2]-[#6:3]=[#6:4]>>[Br;H0;+0:1]-[C;H2;+0:2]-[#6:3]=[#6:4]',
      '[Br;D0;H0;+0:1].[C;H1;+0:2]-[#6:3]=[#6:4]>>[Br;H0;+0:1]-[C;H1;+0:2]-[#6:3]=[#6:4]',
      '[Br;D0;H0;+0:1].[C;H0;+0:2]-[#6:3]=[#6:4]>>[Br;H0;+0:1]-[C;H0;+0:2]-[#6:3]=[#6:4]',
      '[Br;D0;H0;+0:1].[C;H2;+0:2]=[#6:3]-[#6;+0:4]>>[C;H2;+0:2]=[#6:3]-[#6;+0:4]-[Br;H0;+0:1]',
      '[Br;D0;H0;+0:1].[C;H1;+0:2]=[#6:3]-[#6;+0:4]>>[C;H1;+0:2]=[#6:3]-[#6;+0:4]-[Br;H0;+0:1]',
      '[Br;D0;H0;+0:1].[C;H0;+0:2]=[#6:3]-[#6;+0:4]>>[C;H0;+0:2]=[#6:3]-[#6;+0:4]-[Br;H0;+0:1]',
      '[Br;D0;H0;+0:1].[C;H2;+0:2]-[#6:3]:[#6:4]>>[Br;H0;+0:1]-[C;H2;+0:2]-[#6:3]:[#6:4]',
      '[Br;D0;H0;+0:1].[C;H1;+0:2]-[#6:3]:[#6:4]>>[Br;H0;+0:1]-[C;H1;+0:2]-[#6:3]:[#6:4]',
      '[Br;D0;H0;+0:1].[C;H0;+0:2]-[#6:3]:[#6:4]>>[Br;H0;+0:1]-[C;H0;+0:2]-[#6:3]:[#6:4]',
      '[Br;D0;H0;+0:1].[C;H2;+0:2]-[#6:3]=[#7,#8:4]>>[Br;H0;+0:1]-[C;H2;+0:2]-[#6:3]=[#7,#8:4]',
      '[Br;D0;H0;+0:1].[C;H1;+0:2]-[#6:3]=[#7,#8:4]>>[Br;H0;+0:1]-[C;H1;+0:2]-[#6:3]=[#7,#8:4]',
      '[Br;D0;H0;+0:1].[C;H0;+0:2]-[#6:3]=[#7,#8:4]>>[Br;H0;+0:1]-[C;H0;+0:2]-[#6:3]=[#7,#8:4]'],
     'pKa': [None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None,
      None],
     'Description': 'Termination'}}}},


 ('Bromo Grignard reaction',
  'Bromo Grignard + ester reaction', #TODO: Water is missing
  'Chloro Grignard reaction',
  'Chloro Grignard + ester reaction',
  'Grignard ester substitution',
  'Iodo Grignard reaction',
  'Grignard + acid chloride ketone synthesis',): {'Reaction': {'Reagent':['[C]=[O]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[C:1]=[#8:2].[Cl,Br,I:3]-[Mg:4]-[*:5]>>[#8;-1:2]-[C:1]-[*:5].[Mg;+1:4](-[Cl,Br,I:3])',
      '[c:1]=[#8:2].[Cl,Br,I:3]-[Mg:4]-[*:5]>>[#8;-1:2]-[c:1]-[*:5].[Mg;+1:4](-[Cl,Br,I:3])'],
     'pKa': [None, None],
     'Description': 'Addition'},
    1: {'Templates': ['[#8;-1:2]-[#6:1]-[O:5]>>[#8;+0:2]=[#6:1].[O;H0;-1:5]',
      '[#8;-1:2]-[#6:1]-[#6:5]>>[#8;H1;+0:2]-[#6:1]-[#6:5]'],
     'pKa': [None, {'A': 14}],
     'Description': 'Leaving or workup'},
    2: {'Templates': ['[C:1]=[#8:2].[Cl,Br,I:3]-[Mg:4]-[*:5]>>[#8;-1:2]-[C:1]-[*:5].[Mg;+1:4](-[Cl,Br,I:3])',
      '[c:1]=[#8:2].[Cl,Br,I:3]-[Mg:4]-[*:5]>>[#8;-1:2]-[c:1]-[*:5].[Mg;+1:4](-[Cl,Br,I:3])'],
     'pKa': [None, None],
     'Description': 'Addition'},
    3: {'Templates': ['[#8;-1:2]-[#6:1]-[O:5]>>[#8;+0:2]=[#6:1].[O;H0;-1:5]',
      '[#8;-1:2]-[#6:1]-[#6:5]>>[#8;H1;+0:2]-[#6:1]-[#6:5]'],
     'pKa': [None, {'A': 14}],
     'Description': 'Leaving or workup'},


              }}},


 ('Bromo Grignard preparation',
  'Iodo Grignard preparation',
  'Chloro Grignard preparation',): {'Reaction': {'Reagent': ['[#6]-[Cl,Br,I]','[Mg]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[#6;H2:1]-[F,Cl,Br,I:2].[Mg;+0:3]>>[#6;H2;+0:1].[Mg;+0:3][F,Cl,Br,I;H0:2]',
      '[#6;H1:1]-[F,Cl,Br,I:2].[Mg;+0:3]>>[#6;H1;+0:1].[Mg;+0:3][F,Cl,Br,I;H0:2]',
      '[#6;H0:1]-[F,Cl,Br,I:2].[Mg;+0:3]>>[#6;H0;+0:1].[Mg;+0:3][F,Cl,Br,I;H0:2]'],
     'pKa': [None, None, None],
     'Description': 'Radical formation'},
    1: {'Templates': ['[#6;H2;+0:1].[Mg;+0:3][F,Cl,Br,I;H0:2]>>[#6;H2;+0:1]-[Mg;+0:3][F,Cl,Br,I;H0:2]',
      '[#6;H1;+0:1].[Mg;+0:3][F,Cl,Br,I;H0:2]>>[#6;H1;+0:1]-[Mg;+0:3][F,Cl,Br,I;H0:2]',
      '[#6;H0;+0:1].[Mg;+0:3][F,Cl,Br,I;H0:2]>>[#6;H0;+0:1]-[Mg;+0:3][F,Cl,Br,I;H0:2]'],
     'pKa': [None, None, None],
     'Description': 'Termination'}}}},

 ('Wittig olefination',): {'Reaction': {'Reagent': ['[C]=[O]','[P]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[P;+1:1]-[*;-1:2].[#6:3]=[#8:4]>>[P;+0:1]1-[*:2]-[#6:3]-[#8:4]1',
      '[P;+0:1]=[*:2].[#6:3]=[#8:4]>>[P;+0:1]1-[*:2]-[#6:3]-[#8:4]1'],
     'pKa': [None, None],
     'Description': 'Cycloaddition'},
    1: {'Templates': ['[P;+0:1]1-[*:2]-[#6:3]-[#8:4]1>>[P;+0:1]=[#8:4].[*:2]=[#6:3]'],
     'pKa': [None],
     'Description': 'Cyclo-reversion'}}}},


 ('Darzens chlorination',
  'Darzens bromination',): {'Reaction': {'Reagent': ['[#6]-[O]','[Cl,Br]-[S](=[O]-[Cl,Br])'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[#6X4][#8;H1:1]>>[#8;H0;-1:1]'],
     'pKa': [{'B': 14}],
     'Description': 'Deprotonation of alcohol'},
    1: {'Templates': ['[#6:4]-[#8;H0;-1:1].[S:2]-[Cl,Br:3]>>[#6:4]-[#8;H0;+0:1]-[S:2].[Cl,Br;-1:3]',
                      '[#6:4]-[#8;H1;+0:1].[S:2]-[Cl,Br:3]>>[#6:4]-[#8;H1;+1:1]-[S:2].[Cl,Br;-1:3]'],
     'pKa': [None, None],
     'Description': 'Addition'},
    2: {'Templates': ['[#6:4]-[#8;H1;+1:1]-[S:2]>>[#6:4]-[#8;H0;+0:1]-[S:2]',],
     'pKa': [{'B': -6}],
     'Description': 'Deprotonation'},
    3: {'Templates': ['[*:5]-[O;H0;+0:1]-[S,P;+0:3](-[Cl;+0:6])=[O;+0:2].[Cl,Br;-1:4]>>[*:5]-[Cl,Br;+0:4].[O;H0;+0:1]=[S,P;+0:3]=[O;+0:2].[Cl;-1:6]',
      '[*:5]-[O;H0;+0:1]-[S,P;+0:3](=[O;+0:6])=[O;+0:2].[Cl,Br;-1:4]>>[*:5]-[Cl,Br;+0:4].[O;H0;-1:1]-[S,P;+0:3](=[O;+0:6])=[O;+0:2]'],
     'pKa': [None, None],
     'Description': 'Nucleophilic substitution'}}},

                           },



 ('Weinreb amide synthesis',): {'Reaction': {'Reagent': ['[C]=[O]','[N]-[O]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[#6:1](=[#8:2])-[#8,Cl,Br,I:3].[#7;H3:4]>>[#7;H3;+1:4]-[#6:1](-[#8;-1:2])-[#8,Cl,Br,I:3]',
      '[#6:1](=[#8:2])-[#8,Cl,Br,I:3].[#7;H2:4]>>[#7;H2;+1:4]-[#6:1](-[#8;-1:2])-[#8,Cl,Br,I:3]',
      '[#6:1](=[#8:2])-[#8,Cl,Br,I:3].[#7;H1:4]>>[#7;H1;+1:4]-[#6:1](-[#8;-1:2])-[#8,Cl,Br,I:3]'],
     'pKa': [None, None, None],
     'Description': 'Amine addition'},
    1: {'Templates': ['[#7;H3;+1:4]-[#6:1](-[#8;-1:2])-[#8,Cl,Br,I:3]>>[#7;H3;+1:4]-[#6:1]=[#8;+0:2].[#8,Cl,Br,I;-1:3]',
      '[#7;H2;+1:4]-[#6:1](-[#8;-1:2])-[#8,Cl,Br,I:3]>>[#7;H2;+1:4]-[#6:1]=[#8;+0:2].[#8,Cl,Br,I;-1:3]',
      '[#7;H1;+1:4]-[#6:1](-[#8;-1:2])-[#8,Cl,Br,I:3]>>[#7;H1;+1:4]-[#6:1]=[#8;+0:2].[#8,Cl,Br,I;-1:3]'],
     'pKa': [None, None, None],
     'Description': 'Leaving group leaves'},
    2: {'Templates': ['[#7;H3;+1:4]-[#6:1]=[#8;+0:2]>>[#7;H2;+0:4]-[#6:1]=[#8;+0:2]',
      '[#7;H2;+1:4]-[#6:1]=[#8;+0:2]>>[#7;H1;+0:4]-[#6:1]=[#8;+0:2]',
      '[#7;H1;+1:4]-[#6:1]=[#8;+0:2]>>[#7;H0;+0:4]-[#6:1]=[#8;+0:2]'],
     'pKa': [{'B': -0.4}, {'B': -0.4}, {'B': -0.4}],
     'Description': 'Deprotonation of amide'}}}},


 ('Weinreb ketone synthesis',): {'Reaction': {'Reagent': ['[O]=[C]-[N]-[O]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[*:1]-[#6:2](=[#8:3])-[#7;H0:4]-[#8:5].[#6:6]-[Li,Mg;+0:7]>>[*:1]-[#6:2]1(-[*#6:6])-[#8:3]-[Li,Mg;-1:7]-[#8;+1:5]-[#7;H0:4]1'],
     'pKa': [None],
     'Description': 'Nucleophilic addition'},
    1: {'Templates': ['[*:1]-[#6:2]1(-[*#6:6])-[#8:3]-[Li,Mg;-1:7]-[#8;+1:5]-[#7;H0:4]1>>[*:1]-[#6:2](-[*#6:6])(-[#8;H1;+0:3])-[#7;H0:4]-[#8;+0:5].[Li,Mg;+1:7]'],
     'pKa': [{'A': 10}],
     'Description': 'Protonation and metal leaving'},
    2: {'Templates': ['[*:1]-[#6:2](-[*#6:6])(-[#8;H1;+0:3])-[#7;H0:4]-[#8;+0:5]>>[*:1]-[#6:2](-[*#6:6])(-[#8;H1;+0:3])-[#7;H1;+1:4]-[#8;+0:5]'],
     'pKa': [{'A': 10}],
     'Description': 'Protonation'},
    3:{'Templates': ['[*:1]-[#6:2](-[*#6:6])(-[#8;H1;+0:3])-[#7;H1;+1:4]-[#8;+0:5]>>[*:1]-[#6:2](-[*#6:6])(=[#8;H1;+1:3]).[#7;H1;+0:4]-[#8;+0:5]'],
     'pKa': [None],
     'Description': 'Amine leaving',},
    4:{'Templates': ['[#6:2]=[#8;H1;+1:3]>>[#6:2]=[#8;H0;+0:3]'],
     'pKa': [{'B': -6}],
     'Description': 'Deprotonation of ketone',},}}},



 ('Azide-alkyne Huisgen cycloaddition',): {'Reaction': {'Reagent': ['[#6]-[N]=[N]=[N]','[C]#[C]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[N;-1:1]=[N;+1:2]=[N:3].[*:4]#[#6:5]>>[#7;+0:1]1=[#7;+0:2][#7:3][*:4]=[#6:5]1'],
                 'pKa': [None],
                 'Description': 'Cycloaddition'}}}},


 ('Aldehyde Dess-Martin oxidation',
  'Ketone Dess-Martin oxidation',): {'Reaction': {'Reagent': ['[C]-[O]','[#6]-[I](-[O])-[O]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[#8:1]-[#6:2].[#8:3]=[#6:4]1[#6:5][#6:6][I:7]([#8:8][#6:9]([#6:10])=[#8:11])[#8:12]1>>[#8:3]=[#6:4]1[#6:5][#6:6][I:7]([#8;H1;+1:1]-[#6:2])[#8:12]1.[#8;-1:8][#6:9]([#6:10])=[#8:11]'],
     'pKa': [None],
     'Description': 'Substitution'},
    1: {'Templates': ['[#8:3]=[#6:4]1[#6:5][#6:6][I:7]([#8;H1;+1:1]-[#6:2])[#8:12]1>>[#8:3]=[#6:4]1[#6:5][#6:6][I:7]([#8;H0;+0:1]-[#6:2])[#8:12]1'],
     'pKa': [{'B': -1.7}],
     'Description': 'Deprotonation'},
    2: {'Templates': ['[#8:3]=[#6:4]1[#6:5][#6:6][I:7]([#8;H0;+0:1]-[#6;H2:2])([#8:8][#6:9]([#6:10])=[#8:11])[#8:12]1>>[#8:3]=[#6:4]1[#6:5][#6:6][I:7][#8:12]1.[#8;H0;+0:1]=[#6;H1;+0:2].[#8:8]=[#6:9]([#6:10])-[#8;H1;+0:11]',
      '[#8:3]=[#6:4]1[#6:5][#6:6][I:7]([#8;H0;+0:1]-[#6;H1:2])([#8:8][#6:9]([#6:10])=[#8:11])[#8:12]1>>[#8:3]=[#6:4]1[#6:5][#6:6][I:7][#8:12]1.[#8;H0;+0:1]=[#6;H0;+0:2].[#8:8]=[#6:9]([#6:10])-[#8;H1;+0:11]'],
     'pKa': [None, None],
     'Description': 'Oxidation'}}}},

 ('Pinner reaction',): {'Reaction': {'Reagent': ['[#6]-[C]#[N]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[#6:1]#[#7:2]>>[#6:1]#[#7;H1;+1:2]'],
     'pKa': [{'A': -10}],
     'Description': 'Protonation of nitrile'},
                         #Acidic condition pKa < -10
    1: {'Templates': ['[#6:1]#[#7;H1;+1:2].[#8;H1:3]>>[#8;H1;+1:3]-[#6:1]=[#7;H1;+0:2]',
                      '[#6:1]#[#7;H1;+1:2].[#7;H2:3]>>[#7;H2;+1:3]-[#6:1]=[#7;H1;+0:2]',
                      '[#6:1]#[#7;H1;+1:2].[#7;H1:3]>>[#7;H1;+1:3]-[#6:1]=[#7;H1;+0:2]',
                     # Relatively milder condition
                     '[#6:1]#[#7;H0;+0:2].[#8;H1:3]>>[#8;H1;+1:3]-[#6:1]=[#7;H0;-1:2]',
                     '[#6:1]#[#7;H0;+0:2].[#7;H2:3]>>[#7;H2;+1:3]-[#6:1]=[#7;H0;-1:2]',
                     '[#6:1]#[#7;H0;+0:2].[#7;H1:3]>>[#7;H1;+1:3]-[#6:1]=[#7;H0;-1:2]',
                     ],
     'pKa': [None, None, None, None, None, None],
     'Description': 'Addition of alcohol or amine'},

    2: {'Templates': ['[#8;H1;+1:3]-[#6:1]=[#7;H1;+0:2]>>[#8;H0;+0:3]-[#6:1]=[#7;H1;+0:2]',
      '[#7;H2;+1:3]-[#6:1]=[#7;H1;+0:2]>>[#7;H1;+0:3]-[#6:1]=[#7;H1;+0:2]',
      '[#7;H1;+1:3]-[#6:1]=[#7;H1;+0:2]>>[#7;H0;+0:3]-[#6:1]=[#7;H1;+0:2]',
     '[#8;H1;+1:3]-[#6:1]=[#7;H0;-1:2]>>[#8;H0;+0:3]-[#6:1]=[#7;H1;+0:2]',
     '[#7;H2;+1:3]-[#6:1]=[#7;H0;-1:2]>>[#7;H1;+0:3]-[#6:1]=[#7;H1;+0:2]',
     '[#7;H1;+1:3]-[#6:1]=[#7;H0;-1:2]>>[#7;H0;+0:3]-[#6:1]=[#7;H1;+0:2]',],
     'pKa': [{'B': -1.7}, {'B': 5}, {'B': 5},None, None, None],
     'Description': 'Deprotonation or proton exchange'}}}},

 ('Amide Schotten-Baumann',
  'Sulfonamide Schotten-Baumann',
  'Sulfonic ester Schotten-Baumann',
  'Carbamate Schotten-Baumann',
  'Ester Schotten-Baumann',
  'Carbonate Schotten-Baumann',
  'Phosphonamide Schotten-Baumann',
  'N-Cbz protection',): {'Reaction': {'Reagent': None, 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[#7;H2;+0:1]-[#6:2].[F,Cl,Br,I:3]-[C,S,P;H0;+0:4](=[O:5])>>[F,Cl,Br,I:3]-[C,S,P;H0;+0:4](-[#7;H2;+1:1]-[#6:2])(-[O;-1:5])',
      '[#7;H1;+0:1]-[#6:2].[F,Cl,Br,I:3]-[C,S,P;H0;+0:4](=[O:5])>>[F,Cl,Br,I:3]-[C,S,P;H0;+0:4](-[#7;H1;+1:1]-[#6:2])(-[O;-1:5])',
      '[#8;H1;+0:1]-[#6:2].[F,Cl,Br,I:3]-[C,S,P;H0;+0:4](=[O:5])>>[F,Cl,Br,I:3]-[C,S,P;H0;+0:4](-[#8;H1;+1:1]-[#6:2])(-[O;-1:5])'],
     'pKa': [None, None, None],
     'Description': 'Amine addition'},
    1: {'Templates': ['[F,Cl,Br,I:3]-[C,S,P;H0;+0:4](-[#7;H2;+1:1]-[#6:2])(-[O;-1:5])>>[F,Cl,Br,I:3]-[C,S,P;H0;+0:4](-[#7;H1;+0:1]-[#6:2])(-[O;H0;-1:5])',
      '[F,Cl,Br,I:3]-[C,S,P;H0;+0:4](-[#7;H1;+1:1]-[#6:2])(-[O;-1:5])>>[F,Cl,Br,I:3]-[C,S,P;H0;+0:4](-[#7;H0;+0:1]-[#6:2])(-[O;H0;-1:5])',
      '[F,Cl,Br,I:3]-[C,S,P;H0;+0:4](-[#8;H1;+1:1]-[#6:2])(-[O;-1:5])>>[F,Cl,Br,I:3]-[C,S,P;H0;+0:4](-[#8;H0;+0:1]-[#6:2])(-[O;H0;-1:5])'],
     'pKa': [{'B': -1.7}, {'B': 5}, {'B': 5}],
     'Description': 'Deprotonation'},
    2: {'Templates': ['[F,Cl,Br,I:3]-[C,S,P;H0;+0:4](-[#7,#8;+0:1]-[#6:2])(-[O;H0;-1:5])>>[F,Cl,Br,I;-1:3].[C,S,P;H0;+0:4](-[#7,#8;+0:1]-[#6:2])(=[O;H0;+0:5])'],
     'pKa': [None],
     'Description': 'Halide leaves'}}}},


 ('Mesyloxy N-alkylation',): {'Reaction': {'Reagent': ['[CH3]-[S](=[O])=[O]','[N]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[#7;H2;+0:1]-[#6:2].[S;H0;+0:3]-[O:4]-[#6:5]>>[#6:5]-[#7;H2;+1:1]-[#6:2].[S;H0;+0:3]-[O;H0;-1:4]',
      '[#7;H1;+0:1]-[#6:2].[S;H0;+0:3]-[O:4]-[#6:5]>>[#6:5]-[#7;H1;+1:1]-[#6:2].[S;H0;+0:3]-[O;H0;-1:4]'],
     'pKa': [None, None],
     'Description': 'Substitution'},
    1: {'Templates': ['[#6:5]-[#7;H2;+1:1]-[#6:2]>>[#6:5]-[#7;H1;+0:1]-[#6:2]',
      '[#6:5]-[#7;H1;+1:1]-[#6:2]>>[#6:5]-[#7;H0;+0:1]-[#6:2]'],
     'pKa': [{'B': 5}, {'B': 5}],
     'Description': 'Deprotonation'}}}},


 ('Keto alpha-alkylation',): {'Reaction': {'Reagent': ['[C]-[C]=[O]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[#8:1]=[#6:2]-[#6;H2:3]-[#6:4]=[#8:5]>>[#8:1]=[#6:2]-[#6;H1;-1:3]-[#6:4]=[#8:5]',
                               '[#8:1]=[#6:2]-[#6;H3:3]>>[#8:1]=[#6:2]-[#6;H2;-1:3]',
                               '[#8:1]=[#6:2]-[#6;H2:3]>>[#8:1]=[#6:2]-[#6;H1;-1:3]',
                               '[#7:1]#[#6:2]-[#6;H3:3]>>[#7:1]#[#6:2]-[#6;H3;-1:3]',
                               '[#7:1]#[#6:2]-[#6;H2:3]>>[#7:1]#[#6:2]-[#6;H1;-1:3]'],
     'pKa': [{'B': 6},{'B': 17}, {'B': 17}, {'B': 17}, {'B': 17}],
     'Description': 'Deprotonation of alpha position carbon'},

    1: {'Templates': ['[#6;H2;-1:3].[F,Cl,Br,I:4]-[#6;+0:5]>>[#6;H2;+0:3]-[#6;+0:5].[F,Cl,Br,I;-1:4]',
                      '[#6;H1;-1:3].[F,Cl,Br,I:4]-[#6;+0:5]>>[#6;H1;+0:3]-[#6;+0:5].[F,Cl,Br,I;-1:4]',
                      '[#6;H0;-1:3].[F,Cl,Br,I:4]-[#6;+0:5]>>[#6;H0;+0:3]-[#6;+0:5].[F,Cl,Br,I;-1:4]',
                      '[#6;H2;-1:3].[S:6]-[O:4]-[#6;+0:5]>>[#6;H2;+0:3]-[#6;+0:5].[S:6]-[O;-1:4]',
                     '[#6;H1;-1:3].[S:6]-[O:4]-[#6;+0:5]>>[#6;H1;+0:3]-[#6;+0:5].[S:6]-[O;-1:4]',
                     '[#6;H0;-1:3].[S:6]-[O:4]-[#6;+0:5]>>[#6;H0;+0:3]-[#6;+0:5].[S:6]-[O;-1:4]'],
     'pKa': [None, None, None, None, None, None],
     'Description': 'Substitution'}}}},

 ('CO2H-Me deprotection',
  'CO2H-Et deprotection',
  'CO2H-tBu deprotection',
  'Ester hydrolysis',): {'Deprotection with OH-': {'Reagent': ['[O;H1;-1]','[O]=[C]-[O]-[C]'], 'Exclude_reagent': None,
                                                  'Reactive_site': '[#6:4]-[#8;H0;+0:1]-[#6;H0;+0:2]=[#8:3]',
   'Stages': {0: {'Templates': ['[#8;H1;-1:5].[#6:4]-[#8;H0;+0:1]-[#6;H0;+0:2]=[#8:3]>>[#6:4]-[#8;H0;+0:1]-[#6;H0;+0:2]([#8;D1;H1;+0:5])-[#8;H0;-1:3]',
      '[Li,Na,K:9][O;H1;+0:5].[#6:4]-[O;H0;+0:1]-[C;H0;+0:2]=[O:3]>>[Li,Na,K;H0;+1:9].[#6:4]-[O;H0;+0:1]-[C;H0;+0:2]([#8;D1;H1;+0:5])-[O;H0;-1:3]'],
     'pKa': [None, None],
     'Description': 'Hydroxide addition'},
    1: {'Templates': ['[#6:4]-[O;H0;+0:1]-[C;H0;+0:2]([#8;+0:5])-[O;H0;-1:3]>>[O;H0;+0:3]=[C;H0;+0:2]-[#8;+0:5].[#6:4]-[O;H0;-1:1]'],
     'pKa': [None],
     'Description': 'Alkoxide leaves'}}},
  'Deprotection with Alkali hydroxide': {'Reagent': ['[Li,Na,K][O;H1]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[#8;H1;-1:5].[#6:4]-[O;H0;+0:1]-[C;H0;+0:2]=[O:3]>>[#6:4]-[O;H0;+0:1]-[C;H0;+0:2]([#8;D1;H1;+0:5])-[O;H0;-1:3]',
      '[Li,Na,K:9][O;H1;+0:5].[#6:4]-[O;H0;+0:1]-[C;H0;+0:2]=[O:3]>>[Li,Na,K;H0;+1:9].[#6:4]-[O;H0;+0:1]-[C;H0;+0:2]([#8;D1;H1;+0:5])-[O;H0;-1:3]'],
     'pKa': [None, None],
     'Description': 'Hydroxide addition'},
    1: {'Templates': ['[#6:4]-[O;H0;+0:1]-[C;H0;+0:2]([#8;+0:5])-[O;H0;-1:3]>>[O;H0;+0:3]=[C;H0;+0:2]-[#8;+0:5].[#6:4]-[O;H0;-1:1]'],
     'pKa': [None],
     'Description': 'Alkoxide leaves'}}},
  'Deprotection with water': {'Reagent': ['[O;H2]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[#8;H2;+0:5].[#6:4]-[O;H0;+0:1]-[C;H0;+0:2]=[O:3]>>[#6:4]-[O;H0;+0:1]-[C;H0;+0:2]([#8;H2;+1:5])-[O;H0;-1:3]'],
     'pKa': [None],
     'Description': 'Water addition'},
    1: {'Templates': ['[#6:4]-[O;H0;+0:1]-[C;H0;+0:2]([#8;H2;+1:5])-[O;H0;-1:3]>>[#6:4]-[O;H0;+0:1]-[C;H0;+0:2]([#8;H1;+0:5])-[O;H0;-1:3]'],
     'pKa': [{'B': -1.7}],
     'Description': 'Deprotonation'},
    2: {'Templates': ['[#6:4]-[O;H0;+0:1]-[C;H0;+0:2]([#8;+0:5])-[O;H0;-1:3]>>[O;H0;+0:3]=[C;H0;+0:2]-[#8;+0:5].[#6:4]-[O;H0;-1:1]'],
     'pKa': [None],
     'Description': 'Alkoxide leaves'}}}},

  ('Carboxylic acid to acid chloride',): {'SOCl2 or POCl3': {'Reagent': ['O=[S,P](-[Cl])-[Cl]','[O]=[C]-[O]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[C:1](-[O;H1;+0:2])=[O;D1:3].[S,P:4](=[O;H0;+0:5])-[Cl:6]>>[C:1](=[O;H1;+1:2])-[O:3]-[S,P:4](-[O;-;H0:5])-[Cl:6]'],
     'pKa': [None],
     'Description': 'Nucleophilic attack on chloride source'},
    1: {'Templates': ['[C:1](=[O;H1;+1:2])-[O:3]-[S,P:4](-[O;-;H0:5])-[Cl;+0:6]>>[C:1](=[O;H1;+1:2])-[O:3]-[S,P:4]=[O;+0;H0:5].[Cl;-:6]'],
     'pKa': [None],
     'Description': 'Chloride/Fluoride leaves'},
    2: {'Templates': ['[C:1](=[O;H1;+1:2])-[O:3]-[S,P:4]=[O;+0;H0:5].[Cl;-:6]>>[C:1](-[Cl;+0:6])(-[O;H1;+0:2])-[O:3]-[S,P:4]=[O;+0;H0:5]'],
     'pKa': [None],
     'Description': 'Nucleophilic attack on carbonyl'},
    3: {'Templates': ['[C:1](-[Cl;+0:6])(-[O;H1;+0:2])-[O:3]-[S,P:4](=[O;+0;H0:5])-[Cl:7]>>[C:1](-[Cl;+0:6])(=[O;H1;+1:2]).[O:3]=[S,P:4]=[O;+0;H0:5].[Cl;-:7]'],
     'pKa': [None],
     'Description': 'Leaving group removal'},
    4: {'Templates': ['[C:1](-[Cl;+0:2])(=[O;H1;+1:3]).[Cl;-:4]>>[C:1](-[Cl;+0:2])(=[O;H0;+0:3]).[Cl;H1;+0:4]'],
     'pKa': [None],
     'Description': 'Deprotonation'}}},
    'PCl5': {'Reagent': ['ClP(Cl)(Cl)(Cl)Cl','[O]=[C]-[O]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[C:1](-[O;H1;+0:2])=[O;H0:3].[P:4]-[Cl:5]>>[C:1](=[O;H1;+1:2])-[O:3]-[P:4].[Cl;-:5]'],
     'pKa': [None],
     'Description': 'Nucleoophilic attack on chloride source'},
    1: {'Templates': ['[C:1](=[O;H1;+1:2])-[O:3]-[P:4].[Cl;-:5]>>[C:1](-[O;H1;+0:2])([Cl;+0:5])-[O:3]-[P:4]'],
     'pKa': [None],
     'Description': 'Nucleophilic attach on carbonyl'},
    2: {'Templates': ['[C:1](-[O;H1;+0:2])([Cl;+0:5])-[O:3]-[P:4]-[Cl:5]>>[C:1](=[O;H0;+0:2])([Cl;+0:5]).[O:3]=[P:4].[Cl;H1:5]'],
     'pKa': [None],
     'Description': 'Leaving Group Removal + Deprotonation'}}},
  'Oxalyl chloride + DMF': {'Reagent': ['O=C(C(Cl)=O)Cl', 'CN(C)C=O','[O]=[C]-[O]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[Cl:1][C:2](=[O:3])[C:4](=[O;H0;+0:5])[Cl:6].[O:7]=[C:8][N;H0;+0:9]>>[Cl:1][C:2](=[O:3])[C:4](-[O;H0;-:5])([Cl:6])-[O:7]-[C:8]=[N;H0;+1:9]'],
     'pKa': [None],
     'Description': 'Oxalyl chloride + DMF'},
    1: {'Templates': ['[C:1](-[O;H0;-:2])[Cl;+0:3]>>[C:1](=[O;H0;+0:2]).[Cl;-:3]'],
     'pKa': [None],
     'Description': 'Chloride leaves'},
    2: {'Templates': ['[C:1]=[N;H0;+1:2].[Cl;-:3]>>[C:1](-[N;H0;+0:2])[Cl;+0:3]'],
        'pKa': [None],
        'Description': 'Nucleophilic attack'},
    3: {'Templates': ['[Cl;+0:1][C;+0:2](=[O;+0:3])[C:4](=[O:5])-[O:6]-[C:7]([Cl:8])-[N;H0;+0:9]>>[Cl;-:1].[C;-:2]#[O;+:3].[C:4](=[O:5])=[O:6].[C:7]([Cl:8])=[N;H0;+1:9]'],
        'pKa': [None],
        'Description': 'Activated chloride species forms'},
    4: {'Templates': ['[C:1](=[O:2])[O;H1;+0:3]>>[C:1](=[O:2])[O;H0;-:3]'],
        'pKa': [{'B':4.74}],
        'Description': 'Carboxylic acid deprotonation'},
    5: {'Templates': ['[C:1](=[O:2])[O;H0;-:3].[C:4]([Cl:5])=[N;H0;+1:6]>>[C:1](=[O:2])[O;H0;+0:3]-[C:4]([Cl:5])-[N;H0;+0:6]'],
        'pKa': [None],
        'Description': 'Carboxylate attack'},
    6: {'Templates': ['[C:1](=[O:2])[O;H0;+0:3]-[C:4]([Cl;+0:5])-[N;H0;+0:6]>>[C:1](=[O:2])[O;H0;+0:3]-[C:4]=[N;H0;+1:6].[Cl;-:5]'],
        'pKa': [None],
        'Description': 'Chloride leaves'},
    7: {'Templates': ['[C:1](=[O;+0:2])[O;H0;+0:3]-[C:4]=[N;H0;+1:6].[Cl;-:5]>>[C:1]([O;-:2])([Cl;+0:5])[O;H0;+0:3]-[C:4]=[N;H0;+1:6]'],
        'pKa': [None],
        'Description': 'Nucleophilic attack on carbonyl'},
    8: {'Templates': ['[C:1](-[O;-:2])([Cl:5])[O;H0;+0:3]-[C:4]=[N;H0;+1:6]>>[C:1](=[O;+0:2])([Cl:5]).[O;H0;+0:3]=[C:4]-[N;H0;+0:6]'],
        'pKa': [None],
        'Description': 'Leaving group leaves'}}},
  'Oxalyl chloride': {'Reagent': ['O=C(C(Cl)=O)Cl','[O]=[C]-[O]'], 'Exclude_reagent': ['CN(C)C=O'],
   'Stages': {0: {'Templates': ['[C:1](=[O:2])[O;H1;+0:3]>>[C:1](=[O:2])[O;H0;-1:3]'],
     'pKa': [{'B': 4.74}],
     'Description': 'Deprotonation of carboxylic acid'},
    1: {'Templates': ['[C:1](=[O:2])[O;H0;-1:3].[C;+0:4]-[Cl;+0:5]>>[C:1](=[O:2])[O;H0;+0:3][C;+0:4].[Cl;-:5]'],
     'pKa': [None],
     'Description': 'Addition of carbonate'},
    2: {'Templates': ['[C:1](=[O:2])[O;H0;+0:3][C;+0:4](=[O:6])[C;+0:7](=[O;+0:8])[Cl:9].[Cl;-:5]>>[C:1](=[O:2])[Cl;+0:5].[O;H0;+0:3]=[C;+0:4](=[O:6]).[C;-:7]#[O;+:8].[Cl;-:9].[Cl;-:5]'],
        'pKa': [None],
        'Description': 'Nucleophilic substitution'}}}},

  ('O-TBS protection',
   'O-TMS protection',
   'O-TIPS protection',
   'O-TES protection',): {'Reaction': {'Reagent': ['[Si]([C])([C])([C])[Cl,Br,I,O]','[#6]-[O]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[O;H1;+0:1].[Si;H0;+0:2][Cl,Br,I,O;+0:3]>>[O;H1;+1:1]-[Si:2].[Cl,Br,I,O;-1:3]'],
     'pKa': [None],
     'Description': 'Nucleophilic substitution'},
    1: {'Templates': ['[C:1][O;H1;+1:2]-[Si:3]>>[C:1][O;H0;+0:2]-[Si:3]',
                      '[c:1][O;H1;+1:2]-[Si:3]>>[c:1][O;H0;+0:2]-[Si:3]',],
     'pKa': [{'B': -6.0}, {'B': -6.0}],
     'Description': 'Deprotonation'}}}},

    ('Nitration',): {'Sulfuric acid': {'Reagent': ['[N+]([O-])(=[O])[O;H0,H1;+0,-1]', '[S](=[O])(=[O])([OH])[OH]', '[c;H1]'], 'Exclude_reagent': None,
                                        'Stages': {0: {'Templates': [
                                            '[N+:1]([O-:2])(=[O:3])[O;H0;-1:4].[S:5](=[O:6])(=[O:7])([OH:8])[OH:9]>>[N+:1]([O-:2])(=[O:3])[OH1;+0:4].[S:5](=[O:6])(=[O:7])([OH:8])[O;H0;-1:9]'],
                                                       'pKa': [None],
                                                       'Description': 'Protonation of nitrate'},
                                            1: {'Templates': [
                                            '[N+:1]([O-:2])(=[O:3])[OH:4].[S:5](=[O:6])(=[O:7])([OH:8])[OH:9]>>[N+:1]([O-:2])(=[O:3])[OH2;+1:4].[S:5](=[O:6])(=[O:7])([OH:8])[O;H0;-1:9]'],
                                                       'pKa': [None],
                                                       'Description': 'Protonation of nitric acid'},
                                                   2: {'Templates': ['[N+:1]([O-:2])(=[O:3])[OH2;+1:4]>>[N+:1](=[O;+0:2])(=[O:3]).[OH2;+0:4]',],
                                                       'pKa': [None],
                                                       'Description': 'Formation of nitronium ion'},
                                                   3: {'Templates': ['[N+:1](=[O;+0:2])(=[O:3]).[*;a;+0:8]:[c;H1;+0:9]>>[*;a;+1:8]:[c;H1;+0:9]-[N+:1](-[O-:2])(=[O:3])',],
                                                       'pKa': [None],
                                                       'Description': 'Electrophile aromatic substitution'},
                                                   4: {'Templates': [
                                                        '[*;a;+1:8]:[c;H1;+0:9]-[N+:1](-[O-:2])(=[O:3]).[OH2;+0:4]>>[*;a;+0:8]:[c;H0;+0:9]-[N+:1](-[O-:2])(=[O:3]).[OH3;+1:4]', ],
                                                        'pKa': [None],
                                                        'Description': 'Deprotonation'},
                                        }},
                     'Acetic anhydride': {'Reagent': ['[N+]([O-])(=[O])[OH]', '[C]([O][C](=[O])[CH3])(=[O])[CH3]', '[c;H1]'], 'Exclude_reagent': None,
                                        'Stages': {0: {'Templates': [
                                            '[N+:1]([O-:2])(=[O:3])[OH:4].[C:11]([O:12][C:13](=[O:14])[CH3:15])(=[O:16])[CH3:17]>>[OH:4][N+:1]([O;+0:2][C:11]([CH3:17])=[O:16])=[O:3].[O;-1:12][C:13]([CH3:15])=[O:14]'],
                                                       'pKa': [None],
                                                       'Description': 'Formation of nitric acetic anhydride'},
                                                   1: {'Templates': [
                                            '[OH:4][N+:1]([O;+0:2][C:11]([CH3:17])=[O:16])=[O:3].[O;-1:12][C:13]([CH3:15])=[O:14]>>[O;H0;-1:4][N+:1]([O;+0:2][C:11]([CH3:17])=[O:16])=[O:3].[O;H1;+0:12][C:13]([CH3:15])=[O:14]'],
                                                       'pKa': [None],
                                                       'Description': 'Deprotonation of nitric acetic anhydride'},
                                                   2: {'Templates': ['[O;H0;-1:4][N+:1]([O;+0:2][C:11]([CH3:17])=[O:16])=[O:3].[*;a;+0:8]:[c;H1;+0:9]>>[*;a;+1:8]:[c;H1;+0:9]-[N+:1](-[O-:4])(=[O:3]).[O;H0;-1:2][C:11]([CH3:17])=[O:16]',],
                                                       'pKa': [None],
                                                       'Description': 'Electrophile aromatic substitution'},
                                                   3: {'Templates': [
                                                        '[*;a;+1:8]:[c;H1;+0:9]-[N+:1](-[O-:4])(=[O:3]).[O;H0;-1:2][C:11]([CH3:17])=[O:16]>>[*;a;+0:8]:[c;H0;+0:9]-[N+:1](-[O-:4])(=[O:3]).[O;H1;+0:2][C:11]([CH3:17])=[O:16]', ],
                                                        'pKa': [None],
                                                        'Description': 'Deprotonation'}}},
                     'Nitric anhydride': {
                                        'Reagent': ['[*]O[N+]([O-])=O','[c;H1]'], 'Exclude_reagent': None,
                                        'Stages': {
                                            0: {'Templates': [
                                                '[*:1][O:2][N+:3]([O-:4])=[O:5].[*;a;+0:8]:[c;H1;+0:9]>>[*;a;+1:8]:[c;H1;+0:9]-[N+:3](-[O-:4])(=[O:5]).[*:1][O;H0;-1:2]', ],
                                                'pKa': [None],
                                                'Description': 'Electrophile aromatic substitution'},
                                            1: {'Templates': [
                                                '[*;a;+1:8]:[c;H1;+0:9]-[N+:3](-[O-:4])(=[O:5]).[*:1][O;H0;-1:2]>>[*;a;+0:8]:[c;H0;+0:9]-[N+:3](-[O-:4])(=[O:5]).[*:1][O;H1;+0:2]', ],
                                                'pKa': [None],
                                                'Description': 'Deprotonation'},

                                        }},

                     },
   ('Fluoro thioether synthesis',
   'Chloro thioether synthesis',
   'Bromo thioether synthesis',
   'Iodo thioether synthesis',): {'Alkyl carbon': {'Reagent':['[S]','[F,Cl,Br,I]-[C]'], 'Exclude_reagent': None,
     'Stages':{0: {'Templates': ['[S;H1;+0:1]>>[S;H0;-1:1]'],
      'pKa' : [{'B':10}],
      'Description' : 'Deprotonation'},
      1: {'Templates' : ['[S;H0;-1:1].[C:2]-[F,Cl,Br,I:3]>>[S;H0;+0:1]-[C:2].[F,Cl,Br,I;-1:3]'],
      'pKa': [None],
      'Description':'Substitution'}}},

      'Aryl carbon': {'Reagent':['[S]','[F,Cl,Br,I]-[c]'],'Exclude_reagent':None,
      'Stages':{0:{'Templates':['[S;H1:1]>>[S;H0;-1:1]'],
      'pKa' : [{'B':10}],
      'Description': 'Deprotonation'},
      1: {'Templates': ['[S;H0;-1:1].[F,Cl,Br,I:3]-[c:2]:[a:4]>>[S;H0;+0:1]-[c:2](-[F,Cl,Br,I:3])-[a;-1:4]'],
          'pKa' : [None],
          'Description': 'Nucleophilic Addition'},
      2: {'Templates': ['[S;H0;+0:1]-[c:2](-[F,Cl,Br,I:3])-[a;-1:4]>>[S;H0;+0:1]-[c:2]:[a;+0:4].[F,Cl,Br,I;-1:3]'],
          'pKa':[None],
          'Description': 'Elimination'}
          
      }},
      },
  ('Transesterification',): {'Acid-catalyzed':{'Reagent':['[O]=[C]-[O]-[#6]','[O]-[#6]'],'Exclude_reagent':None,
                            'Stages':{0:{'Templates':['[O:1]=[C:2]-[O:3]-[#6:4]>>[O;H1;+1:1]=[C:2]-[O:3]-[#6:4]'],
                                         'pKa':[{'A':-10}],
                                         'Description':'Protonation'},
                                      1:{'Templates':['[O;H1;+1:1]=[C:2]-[O:3]-[#6:4].[O;H1:5]-[#6:6]>>[O;H1;+0:1]-[C:2](-[O:3]-[#6:4])-[O;H1;+1:5]-[#6:6]'],
                                         'pKa':[None],
                                         'Description':'Nucleophilic addition'},
                                      2:{'Templates':['[O;H1;+0:1]-[C:2](-[O:3]-[#6:4])-[O;H1;+1:5]-[#6:6]>>[O;H1;+0:1]-[C:2](-[O;H1;+1:3]-[#6:4])-[O;H0;+0:5]-[#6:6]'],
                                         'pKa':[None],
                                         'Description':'Proton transfer'},
                                      3:{'Templates':['[O;H1;+0:1]-[C:2](-[O;H1;+1:3]-[#6:4])-[O;H0;+0:5]-[#6:6]>>[O;H1;+1:1]-[C:2]-[O;H0;+0:5]-[#6:6].[O;H1;+0:3]-[#6:4]'],
                                         'pKa':[None],
                                         'Description':'Tetrahedral intermediate collapse'},
                                      4:{'Templates':['[O;H1;+1:1]-[C:2]-[O;H0;+0:5]-[#6:6]>>[O;H0;+0:1]-[C:2]-[O:5]-[#6:6]'],
                                         'pKa':[{'B':-10}],
                                         'Description':'Deprotonation'}}},
  'Neutral':{'Reagent':['[O]=[C]-[O]-[#6]','[O]-[#6]'],'Exclude_reagent':None,
  'Stages':{0:{'Templates':['[O:1]=[C:2]-[O:3]-[#6:4].[O;H1:5]-[#6:6]>>[O;-1:1]-[C:2](-[O;H1;+1:5]-[#6:6])-[O:3]-[#6:4]'],
               'pKa':[None],
               'Description':'Nucleophilic addition'},
  1:{'Templates':['[O;-1:1]-[C:2](-[O;H1;+1:5]-[#6:6])-[O:3]-[#6:4]>>[O;-1:1]-[C:2](-[O;H0;+0:5]-[#6:6])-[O;H1;+1:3]-[#6:4]'],
     'pKa':[None],
     'Description':'Proton exchange'},
  2:{'Templates':['[O;-1:1]-[C:2](-[O:5]-[#6:6])-[O;H1;+1:3]-[#6:4]>>[O;+0:1]=[C:2]-[O:5]-[#6:6].[O;H1;+0:3]-[#6:4]'],
     'pKa':[None],
     'Description':'Tetrahedral intermediate collapse'} 
  }},
  'Base-catalyzed':{'Reagent':['[O]=[C]-[O]-[#6]','[O]-[#6]'],'Exclude_reagent':None,
                            'Stages':{0:{'Templates':['[O;H1:5]-[#6:6]>>[O;H0;-1:5]-[#6:6]'], #>>[O:1]=[C:2]-[O:3]-[#6:4].[O;H0;-1:5]-[#6:6]
                                         'pKa':[{'B':16}], 
                                         'Description':'Deprotonation'},
                                      1:{'Templates':['[O:1]=[C:2]-[O:3]-[#6:4].[O;H0;-1:5]-[#6:6]>>[O;H0;-1:1]-[C:2](-[O:3]-[#6:4])-[O;H0;+0:5]-[#6:6]'],
                                         'pKa':[None],
                                         'Description':'Nucleophilic addition'},
                                      2:{'Templates':['[O;H0;-1:1]-[C:2](-[O:3]-[#6:4])-[O;H0;+0:5]-[#6:6]>>[O;H0;+0:1]=[C:2]-[O;H0;+0:5]-[#6:6].[O;H0;-1:3]-[#6:4]'],
                                         'pKa':[None],
                                         'Description':'Tetrahedral intermediate collapse'},
                                      3:{'Templates':['[O;H0;-1:3]-[#6:4]>>[O;H1;+0:3]-[#6:4]'],
                                      'pKa':[{'A':16}],
                                      'Description':'Protonation'},
                                         }}},

('Azido to amino',):{'Direct Hydrogenation':{'Reagent':['[#6]-[N]=[N;+1]=[N;-1]','[H]-[H]'],'Exclude_reagent':None,
                    'Stages':{0:{'Templates':['[#6:1]-[N:2]=[N;+1:3]=[N;-1:4].[H:5]-[H:6]>>[#6:1]-[N;H0;+0:2](-[H:5])-[N;H0;+1:3](-[H:6])=[N;H0;-1:4]'],
                                 'pKa':[None],
                                 'Description':'Addition of H2'},
                              1:{'Templates':['[#6:1]-[N;H0;+0:2](-[H:5])-[N;H0;+1:3](-[H:6])=[N;H0;-1:4]>>[#6:1]-[N;H0;+0:2](-[H:5])(-[H:6])-[N;H0;+1:3]=[N;H0;-1:4]'],
                                 'pKa':[None],
                                 'Description':'Proton transfer'},
                              2:{'Templates':['[#6:1]-[N;H0;+0:2](-[H:5])(-[H:6])-[N;H0;+0:3]=[N;H0;-1:4]>>[#6:1]-[N;H0;+0:2](-[H:5])(-[H:6]).[N;H0:3]#[N;H0;+0:4]'],
                                 'pKa':[None],
                                 'Description':'Expulsion of N2'},
          }},
'Staudinger':{'Reagent':['[#6]-[N]=[N;+1]=[N;-1]','[P]'],'Exclude_reagent':None,
                      'Stages':{0:{'Templates':['[#6:1]-[N:2]=[N;+1:3]=[N;-1:4].[PX3:5]>>[#6:1]-[N;-1;H0:2]-[N;H0;+0:3]=[N;-1:4]-[PX4;+1:5]'],
                                   'pKa':[None],
                                   'Description':'Nucleophilic addition'},
                                1:{'Templates':['[#6:1]-[N;-1;H0:2]-[N;H0;+0:3]=[N;-1:4]-[PX4;+1:5]>>[#6:1]-[N;-1;H0:2]-[PX4;+1:5].[N;H0;+0:3]#[N;H0;+0:4]'],
                                   'pKa':[None],
                                   'Description':'Expulsion of N2'},
                                2:{'Templates':['[#6:1]-[N;-1;H0:2]-[PX4;+1:5].[O;H2;+0:6]>>[#6:1]-[N;-1;H0:2]-[PX5;+0:5]-[O;H2;+1:6]'],
                                   'pKa':[None],
                                   'Description':'Formation of P-O bond'},
                                3:{'Templates':['[#6:1]-[N;-1;H0:2]-[PX5;+0:5]-[O;H2;+1:6]>>[#6:1]-[N;+0;H1:2]-[PX5;+0:5]-[O;H1;+0:6]'],
                                   'pKa':[None],
                                   'Description':'Proton transfer'},
                                4:{'Templates':['[#6:1]-[N;+0;H1:2]-[PX5;+0:5]-[O;H1;+0:6]>>[#6:1]-[N;+0;H2:2].[PX5;+0:5]=[O;H0;+0:6]'],
                                   'pKa':[None],
                                   'Description':'Elimination of TPPO'}}},
'Hydride reduction':{'Reagent':['[#6]-[N]=[N;+1]=[N;-1]','[B,Al;H1,H2,H3,H4;-1]'],'Exclude_reagent':None,
                     'Stages':{0:{'Templates':['[B,Al;H4;-1:4].[#6:1]-[N:2]=[N;+1:3]=[N;-1:5]>>[#6:1]-[N;H1;+0:2]-[N;H0;+0:3]=[N;-1:5].[B,Al;H3;+0:4]',
      '[B,Al;H3;-1:4].[#6:1]-[N:2]=[N;+1:3]=[N;-1:5]>>[#6:1]-[N;H1;+0:2]-[N;H0;+0:3]=[N;-1:5].[B,Al;H2;+0:4]',
      '[B,Al;H2;-1:4].[#6:1]-[N:2]=[N;+1:3]=[N;-1:5]>>[#6:1]-[N;H1;+0:2]-[N;H0;+0:3]=[N;-1:5].[B,Al;H1;+0:4]',
      '[B,Al;H1;-1:4].[#6:1]-[N:2]=[N;+1:3]=[N;-1:5]>>[#6:1]-[N;H1;+0:2]-[N;H0;+0:3]=[N;-1:5].[B,Al;H0;+0:4]'],
      'pKa':[None,None,None,None],
      'Description':'boro/alumino hydride reduction'},
      1: {'Templates':['[#6:1]-[N;H1;+0:2]-[N;H0;+0:3]=[N;-1:5]>>[#6:1]-[N;H1;-1:2].[N;H0;+0:3]#[N;H0;+0:5]'],
      'pKa':[None],
      'Description':'N2 expulsion'},
      2: {'Templates':['[#6:1]-[N;H1;-1:2]>>[#6:1]-[N;H2;+0:2]'],
      'pKa':[{'A':35}],
      'Description':'Protonation of amide anion'},
      }},

},
('Sulfide + amine reaction',):{'Reaction':{'Reagent':['[N]','[S]-[c]'],'Exclude_reagent':None,
      'Stages':{0: {'Templates': ['[N;H1:1].[S:3]-[c:2]:[a:4]>>[N;H1;+1:1]-[c:2](-[S:3])-[a;-1:4]',
                                  '[N;H2:1].[S:3]-[c:2]:[a:4]>>[N;H2;+1:1]-[c:2](-[S:3])-[a;-1:4]'],
          'pKa' : [None],
          'Description': 'Nucleophilic Addition'},
      1: {'Templates': ['[N;H1;+1:1]-[c:2](-[S:3])-[a;-1:4]>>[N;H1;+1:1]-[c:2]:[a;+0:4].[S;-1:3]',
                        '[N;H2;+1:1]-[c:2](-[S:3])-[a;-1:4]>>[N;H2;+1:1]-[c:2]:[a;+0:4].[S;-1:3]'],
          'pKa':[None],
          'Description': 'Elimination'},
2: {'Templates': ['[N;H1;+1:1]-[c:2]:[a;+0:4].[S;H0;-1:3]>>[N;H0;+0:1]-[c:2]:[a;+0:4].[S;H1;+0:3]',
                  '[N;H2;+1:1]-[c:2]:[a;+0:4].[S;H0;-1:3]>>[N;H1;+0:1]-[c:2]:[a;+0:4].[S;H1;+0:3]'],
    'pKa': [None],
    'Description': 'Proton transfer'},
                                           }
                                           
    }},
('Nitrogen oxidation',):{'Peroxy acid':{'Reagent':['[n]','[#8]=[#6]-[#8]-[#8]'],'Exclude_reagent':None,
      'Stages':{0:{'Templates':['[n:1].[O;H0:2]=[C:3]-[O;H0:4]-[O;H1:5]>>[n;+1:1]-[O;H0;-1:5].[O;H0:4]=[C:3]-[O;H1:2]',
                                '[n:1].[O;H0:2]=[C:3]-[O;H0:4]-[O;H0;-1:5]>>[n;+1:1]-[O;H0;-1:5].[O;H0:4]=[C:3]-[O;H0;-1:2]'],
                   'pKa':[None],
                   'Description':'Butterfly mechanism'}}},
                  },
('Cyano to carbamoyl',):{'Acid-catalyzed':{'Reagent':['[C]#[N]'],'Exclude_reagent':None,
                        'Stages':{0:{'Templates':['[C:1]#[N:2]>>[C:1]#[N;H1;+1:2]'],
                                     'pKa':[{'A':0}],
                                     'Description':'Protonation'},
                                  1:{'Templates':['[C:1]#[N;H1;+1:2].[O;H2;+0:3]>>[N;H1;+0:2]=[C:1]-[O;H2;+1:3]'],
                                     'pKa':[None],
                                     'Description':'Nucleophilic addition'},
                                  2:{'Templates':['[N;H1;+0:2]=[C:1]-[O;H2;+1:3]>>[N;H2;+1:2]=[C:1]-[O;H1;+0:3]'],
                                     'pKa':[None],
                                     'Description':'Proton transfer'},
                                  3:{'Templates':['[N;H2;+1:2]=[C:1]-[O;H1;+0:3]>>[N;H2;+0:2]-[C:1]=[O;H0;+0:3]'],
                                     'pKa':[{'B':0}],
                                     'Description':'Deprotonation'}}},
                        'Base-catalyzed':{'Reagent':['[C]#[N]'],'Exclude_reagent':None,
                        'Stages':{0:{'Templates':['[C:1]#[N:2].[O;H1;-1:3]>>[N;-1:2]=[C:1]-[O;H1;+0:3]'],
                                     'pKa':[None],
                                     'Description':'Nucleophilic addition'},
                                  1:{'Templates':['[N;-1:2]=[C:1]-[O;H1;+0:3]>>[N;H1;+0:2]=[C:1]-[O;H1;+0:3]'],
                                      'pKa':[{'A':20}],
                                      'Description':'Protonation'},
                                  2:{'Templates':['[N;H1;+0:2]=[C:1]-[O;H1;+0:3]>>[N;H1;-1:2]-[C:1]=[O;H0;+0:3]'],
                                     'pKa':[{'B':20}],
                                     'Description':'Deprotonation'},
                                  3:{'Templates':['[N;H1;-1:2]-[C:1]=[O;H0;+0:3]>>[N;H2;+0:2]-[C:1]=[O;H0;+0:3]'],
                                     'pKa':[{'A':20}],
                                     'Description':'Protonation'}}
                              }},
 ('Ethyl esterification',): {'Acid-catalyzed': {'Reagent': ['[C]-[C]-[O]','[O]=[C]-[O]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates':['[O:1]=[C:2]-[O:3]>>[O;H1;+1:1]=[C:2]-[O:3]'],
                  'pKa':[{'A':-6}],
                  'Description':'Protonation'},
              1:{'Templates':['[O;H1;+1:1]=[C:2]-[O:3].[C;H3:4]-[C;H2:5]-[O;H1:6]>>[O;H1;+0:1]-[C:2](-[O:3])-[O;H1;+1:6]-[C;H2:5]-[C;H3:4]'],
                 'pKa':[None],
                 'Description':'Nucleophilic addition'},
              2:{'Templates':['[O;H1;+0:1]-[C:2](-[O;H1;+0:3])-[O;H1;+1:6]-[C;H2:5]-[C;H3:4]>>[O;H1;+0:1]-[C:2](-[O;H2;+1:3])-[O;H0;+0:6]-[C;H2:5]-[C;H3:4]'],
                 'pKa':[None],
                 'Description':'Proton transfer'},
              3:{'Templates':['[O;H1;+0:1]-[C:2](-[O;H2;+1:3])-[O;H0;+0:6]-[C;H2:5]-[C;H3:4]>>[O;H1;+1:1]=[C:2]-[O;H0;+0:6]-[C;H2:5]-[C;H3:4].[O;H2;+0:3]'],
                  'pKa':[None],
                  'Description':'Tetrahedral intermediate collapse'},
              4:{'Templates':['[O;H1;+1:1]=[C:2]-[O;H0;+0:6]-[C;H2:5]-[C;H3:4]>>[O;H0;+0:1]=[C:2]-[O;H0;+0:6]-[C;H2:5]-[C;H3:4]'],
                 'pKa':[{'B':-6}],
                 'Description':'Deprotonation'}}},
  'Base-catalyzed':{'Reagent':['[C]-[C]-[O]','[O]=[C]-[O]'],'Exclude_reagent':None,
    'Stages':{0:{'Templates':['[O:1]=[C:2]-[O;H1;+0:3]>>[O:1]=[C:2]-[O;H0;-1:3]'], #'[C;H3:4]-[C;H2:5]-[O;H1;+0:6]>>[C;H3:4]-[C;H2:5]-[O;H0;-1:6]'],
                 'pKa':[{'B':4.74}],
                 'Description':'Deprotonation'},
              1:{'Templates':['[O:1]=[C:2]-[O;H0;-1:3].[C;H3:4]-[C;H2:5]-[O;H0;-1:6]>>[O;H0;-1:1]-[C:2](-[O;H0;-1:3])-[O;H0;+0:6]-[C;H2:5]-[C;H3:4]',
                              '[O:1]=[C:2]-[O;H0;-1:3].[C;H3:4]-[C;H2:5]-[O;H1;+0:6]>>[O;H0;-1:1]-[C:2](-[O;H0;-1:3])-[O;H1;+1:6]-[C;H2:5]-[C;H3:4]'],
                 'pKa':[None, None],
                 'Description':'Nucleophilic addition'},
               2:{'Templates':['[O;H0;-1:1]-[C:2](-[O;H0;-1:3])-[O;H0;+0:6]-[C;H2:5]-[C;H3:4]>>[O;H0;-1:1]-[C:2](-[O;H1;+0:3])-[O;H0;+0:6]-[C;H2:5]-[C;H3:4]',
                              '[O;H0;-1:1]-[C:2](-[O;H0;-1:3])-[O;H1;+1:6]-[C;H2:5]-[C;H3:4]>>[O;H0;-1:1]-[C:2](-[O;H1;+0:3])-[O;H0;+0:6]-[C;H2:5]-[C;H3:4]'],
                 'pKa':[{'A':14}, None],
                 'Description':'Proton exchange'},
              3:{'Templates':['[O;H0;-1:1]-[C:2](-[O;H1;+0:3])-[O;H0;+0:6]-[C;H2:5]-[C;H3:4]>>[O;H0;+0:1]=[C:2]-[O;H0;+0:6]-[C;H2:5]-[C;H3:4].[O;H1;-1:3]'],
                 'pKa':[None],
                 'Description':'Tetrahedral intermediate collapse'}}},
  'Thionyl chloride':{'Reagent':['[C]-[C]-[O]','[O]=[C]-[O]','[Cl]-[S](=[O])-[Cl]'],'Exclude_reagent':None,
    'Stages':{0:{'Templates':['[O:1]=[C:2]-[O;H1:3].[Cl:7]-[S:8](=[O:9])-[Cl:10]>>[O;H1;+1:3]=[C:2]-[O:1]-[S:8](-[O;H0;-1:9])(-[Cl:7])(-[Cl:10])'],
                 'pKa':[None],
                 'Description':'Addition to thionyl chloride'},
              1:{'Templates':['[O;H1;+1:3]=[C:2]-[O:1]-[S:8](-[O;H0;-1:9])(-[Cl:7])(-[Cl:10])>>[O;H1;+1:3]=[C:2]-[O:1]-[S:8](=[O;H0;+0:9])(-[Cl:7]).[Cl;-1:10]'],
                 'pKa':[None],
                 'Description':'Loss of chloride'},
              2:{'Templates':['[O;H1;+1:3]=[C:2]-[O:1]-[S:8](=[O;H0;+0:9])(-[Cl:7]).[Cl;-1:10]>>[O;H1;+0:3]-[C:2](-[Cl;+0:10])-[O:1]-[S:8](=[O;H0;+0:9])(-[Cl:7])'],
                 'pKa':[None],
                 'Description':'Addition of chloride'},
              3:{'Templates':['[O;H1;+0:3]-[C:2](-[Cl;+0:10])-[O:1]-[S:8](=[O;H0;+0:9])(-[Cl:7])>>[O;H0;+0:3]=[C:2]-[Cl;+0:10].[O:1]=[S:8]=[O;H0;+0:9].[Cl;H1;+0:7]'],
                  'pKa':[None],
                  'Description':'Pseudo-pericyclic expulsion of SO2, HCl'},
              4:{'Templates':['[O;H0;+0:3]=[C:2]-[Cl;+0:10].[O;H1+0:6]-[C;H2:5]-[C;H3:4]>>[O;H0;-1:3]-[C:2](-[Cl;+0:10])-[O;H1;+1:6]-[C;H2:5]-[C;H3:4]'],
                 'pKa':[None],
                 'Description':'Nucleophilic addition'},
              5:{'Templates':['[O;H0;-1:3]-[C:2](-[Cl;+0:10])-[O;H1;+1:6]-[C;H2:5]-[C;H3:4]>>[O;H0;+0:3]=[C:2]-[O;H1;+1:6]-[C;H2:5]-[C;H3:4].[Cl;-1:10]'],
                 'pKa':[None],
                 'Description':'Nucleophilic addition'},
              6:{'Templates':['[O;H0;+0:3]=[C:2]-[O;H1;+1:6]-[C;H2:5]-[C;H3:4]>>[O;H0;+0:3]=[C:2]-[O;H0;+0:6]-[C;H2:5]-[C;H3:4]'],
                 'pKa':[{'B':-6}],
                 'Description':'Deprotonation'},
        }}},
('Epoxide + amine coupling',):{'Neutral':{'Reagent':['[#7]','[C]1-[O]-[C]1'],'Exclude_reagent':None,
    'Stages':{0:{'Templates':['[#7;H1:1].[C:2]1-[O:3]-[C:4]1>>[#7;H1;+1:1]-[C:2]-[C:4]-[O;H0;-1:3]',
                              '[#7;H2:1].[C:2]1-[O:3]-[C:4]1>>[#7;H2;+1:1]-[C:2]-[C:4]-[O;H0;-1:3]'],
                 'pKa':[None,None],
                 'Description':'Nucleophilic addition'},
              1:{'Templates':['[#7;H1;+1:1]-[C:2]-[C:4]-[O;H0;-1:3]>>[#7;H0;+0:1]-[C:2]-[C:4]-[O;H1;+0:3]',
                              '[#7;H2;+1:1]-[C:2]-[C:4]-[O;H0;-1:3]>>[#7;H1;+0:1]-[C:2]-[C:4]-[O;H1;+0:3]'],
              'pKa':[None,None],
              'Description':'Proton exchange'}}},
'Base-catalyzed':{'Reagent':['[#7]','[C]1-[O]-[C]1'],'Exclude_reagent':None,
    'Stages':{0:{'Templates':['[n;H1:1]>>[n;H0;-1:1]',
                              '[N;H1:1]>>[N;H0;-1:1]',
                              '[N;H2:1]>>[N;H1;-1:1]'],
                 'pKa':[{'B':15},{'B':35},{'B':35}],
                 'Description':'Nitrogen deprotonation'},
              1:{'Templates':['[n;H0;-1:1].[C:2]1-[O:3]-[C:4]1>>[n;H0;+0:1]-[C:2]-[C:4]-[O;H0;-1:3]',
                              '[N;H0;-1:1].[C:2]1-[O:3]-[C:4]1>>[N;H0;+0:1]-[C:2]-[C:4]-[O;H0;-1:3]',
                              '[N;H1;-1:1].[C:2]1-[O:3]-[C:4]1>>[N;H1;+0:1]-[C:2]-[C:4]-[O;H0;-1:3]'],
                              'pKa':[None,None,None],
                              'Description':'Nucleophilic addition'},
              2:{'Templates':['[n;H0;+0:1]-[C:2]-[C:4]-[O;H0;-1:3]>>[n;H0;+0:1]-[C:2]-[C:4]-[O;H1;+0:3]',
                              '[N;H0;+0:1]-[C:2]-[C:4]-[O;H0;-1:3]>>[N;H0;+0:1]-[C:2]-[C:4]-[O;H1;+0:3]',
                              '[N;H1;+0:1]-[C:2]-[C:4]-[O;H0;-1:3]>>[N;H1;+0:1]-[C:2]-[C:4]-[O;H1;+0:3]'],
                              'pKa':[{'A':15},{'A':15},{'A':15}],
                              'Description':'Protonation'},
              }}},
# ('Appel bromination',):{'Reaction':{'Reagent':['[#6]-[O]','[Br]-[C](-[Br])(-[Br])-[Br]','[c]-[P](-[c])-[c]'],'Exclude_reagent':None,
#       'Stages':{0:{'Templates':['[Br:1]-[C:2](-[Br:3])(-[Br:4])-[Br:5].[P:6]>>[Br:1]-[C;H0;-1:2](-[Br:3])-[Br:4].[Br;H0;+0:5]-[P;H0;+1:6]'],
#                    'pKa':[None],
#                    'Description':'Nucleophilic attack on CBr4'},
#                 1:{'Templates':['[Br:1]-[C;H0;-1:2](-[Br:3])-[Br:4].[Br;H0;+0:5]-[P;H0;+1:6].[O;H1;+0:7]-[#6:8]>>[Br:1]-[C;H1;+0:2](-[Br:3])-[Br:4].[Br;H0;+0:5]-[P;H0;+1:6].[O;H0;-1:7]-[#6:8]'],
#                    'pKa':[None],
#                    'Description':'Proton transfer'},
#                 2:{'Templates':['[Br;H0;+0:5]-[P;H0;+1:6].[O;H0;-1:7]-[#6:8]>>[Br;H0;-1:5].[P;H0;+1:6]-[O;H0;+0:7]-[#6:8]'],
#                    'pKa':[None],
#                    'Description':'Formation of P-O bond'},
#                 3:{'Templates':['[Br;H0;-1:5].[P;H0;+1:6]-[O;H0;+0:7]-[#6:8]>>[Br;H0;+0:5]-[#6:8].[P;H0;+0:6]=[O;H0;+0:7]'],
#                    'pKa':[None],
#                    'Description':'Formation of TPPO'},
#                    }}},

# ('Appel chlorination',):{'Reaction':{'Reagent':['[#6]-[O]','[Cl]-[C](-[Cl])(-[Cl])-[Cl]','[c]-[P](-[c])-[c]'],'Exclude_reagent':None,
#       'Stages':{0:{'Templates':['[Cl:1]-[C:2](-[Cl:3])(-[Cl:4])-[Cl:5].[P:6]>>[Cl:1]-[C;H0;-1:2](-[Cl:3])-[Cl:4].[Cl;H0;+0:5]-[P;H0;+1:6]'],
#                    'pKa':[None],
#                    'Description':'Nucleophilic attack on CCl4'},
#                 1:{'Templates':['[Cl:1]-[C;H0;-1:2](-[Cl:3])-[Cl:4].[Cl;H0;+0:5]-[P;H0;+1:6].[O;H1;+0:7]-[#6:8]>>[Cl:1]-[C;H1;+0:2](-[Cl:3])-[Cl:4].[Cl;H0;+0:5]-[P;H0;+1:6].[O;H0;-1:7]-[#6:8]'],
#                    'pKa':[None],
#                    'Description':'Proton transfer'},
#                 2:{'Templates':['[Cl;H0;+0:5]-[P;H0;+1:6].[O;H0;-1:7]-[#6:8]>>[Cl;H0;-1:5].[P;H0;+1:6]-[O;H0;+0:7]-[#6:8]'],
#                    'pKa':[None],
#                    'Description':'Formation of P-O bond'},
#                 3:{'Templates':['[Cl;H0;-1:5].[P;H0;+1:6]-[O;H0;+0:7]-[#6:8]>>[Cl;H0;+0:5]-[#6:8].[P;H0;+0:6]=[O;H0;+0:7]'],
#                    'pKa':[None],
#                    'Description':'Formation of TPPO'},
#                    }}},
('O-Acetylation',):{'Neutral':{'Reagent':['[#6]-[O]','[C]-[C](=[O])-[O]-[C](=[O])-[C]'],'Exclude_reagent':None,
          'Stages':{0:{'Templates':['[#6;!$(C=*):1]-[O;H1;+0:2].[C:3]-[C:4](=[O:5])-[O:6]-[C:7](=[O:8])-[C:9]>>[#6:1]-[O;H1;+1:2]-[C:4](-[C:3])(-[O;H0;-1:5])-[O:6]-[C:7](=[O:8])-[C:9]'],
                       'pKa':[None],
                       'Description':'Nucleophilic addition'},
                    1:{'Templates':['[#6:1]-[O;H1;+1:2]-[C:4](-[C:3])(-[O;H0;-1:5])-[O:6]-[C:7](=[O:8])>>[#6:1]-[O;H1;+1:2]-[C:4](-[C:3])(=[O;H0;+0:5]).[O;H0;-1:6]-[C:7](=[O:8])'],
                       'pKa':[None],
                       'Description':'Tetrahedral intermediate collapse'},
                    2:{'Templates':['[#6:1]-[O;H1;+1:2]-[C:4](-[C:3])(=[O;H0;+0:5]).[O;H0;-1:6]-[C:7](=[O:8])>>[#6:1]-[O;H0;+0:2]-[C:4](-[C:3])(=[O;H0;+0:5]).[O;H1;+0:6]-[C:7](=[O:8])'],
                       'pKa':[None],
                       'Description':'Proton exchange'}}},
      'Base-catalyzed':{'Reagent':['[#6]-[O]','[C]-[C](=[O])-[O]-[C](=[O])-[C]'],'Exclude_reagent':None,
            'Stages':{0:{'Templates':['[c:1]-[O;H1;+0:2]>>[c:1]-[O;H0;-1:2]',
                                      '[C:1]-[O;H1;+0:2]>>[C:1]-[O;H0;-1:2]'],
                         'pKa':[{'B':10},{'B':17}],
                         'Description':'Deprotonation'},
                      1:{'Templates':['[#6;!$(C=*):1]-[O;H0;-1:2].[C:3]-[C:4](=[O:5])-[O:6]-[C:7](=[O:8])-[C:9]>>[#6:1]-[O;H0;+0:2]-[C:4](-[C:3])(-[O;H0;-1:5])-[O:6]-[C:7](=[O:8])-[C:9]'],
                         'pKa':[None,None],
                         'Description':'Nucleophilic addition'},
                      2:{'Templates':['[#6:1]-[O;H0;+0:2]-[C:4](-[C:3])(-[O;H0;-1:5])-[O:6]-[C:7](=[O:8])>>[#6:1]-[O;H0;+0:2]-[C:4](-[C:3])(=[O;H0;+0:5]).[O;H0;-1:6]-[C:7](=[O:8])'],
                         'pKa':[None,None],
                         'Description':'Tetrahedral intermediate collapse'},
                         }}},

('Carboxy ester to carbamoyl',):{'Condensation using DCC': {'Reagent': ['[N]=[C]=[N]','[#7]','[O]=[C]-[O]-[#6]'], 'Exclude_reagent': None,
   'Stages': {0: {'Templates': ['[N;D0;H4;+1:5]>>[N;D0;H3;+0:5]',
      '[N;D1;H3;+1:5]>>[N;D1;H2;+0:5]',
      '[N;D2;H2;+1:5]>>[N;D2;H1;+0:5]',
      '[N;D3;H1;+1:5]>>[N;D3;H0;+0:5]'],
     'pKa': [ {'B': 9.25}, {'B': 10.6}, {'B': 11}, {'B': 10.8}],
     'Description': 'Deprotonation of amine'},

   1: {'Templates': ['[#6:1]-[O;H0;+0:2]-[C;H0;+0:3](-[#6:4])=[O:5].[Li,Na,K:6]-[O;H1;+0:7]>>[#6:1]-[O;H0;-1:2].[O;H1;+0:7]-[C;H0;+0:3](-[#6:4])=[O:5].[Li,Na,K;+1:6]',
                     '[#6:1]-[O;H0;+0:2]-[C;H0;+0:3](-[#6:4])=[O:5].[O;H1;-1:7]>>[#6:1]-[O;H0;-1:2].[O;H1;+0:7]-[C;H0;+0:3](-[#6:4])=[O:5]'],
     'pKa': [None, None],
     'Description': 'Carboxylic acid formation'},

    2: {'Templates': ['[#6:2]-[N;H0;+0:3]=[C;H0;+0:4]=[N;H0;+0:5]-[#6:6].[O;H1;+0:1]-[C;H0;+0:14](-[#6:13])=[O:15]>>[#6:2]-[N;H1;+1:3]=[C;H0;+0:4]=[N;H0;+0:5]-[#6:6].[O;H0;-1:1]-[C;H0;+0:14](-[#6:13])=[O:15]'],
     'pKa': [None],
     'Description': 'Proton exchange'},

    3: {'Templates': ['[#6:2]-[N;H1;+1:3]=[C;H0;+0:4]=[N;H0;+0:5]-[#6:6].[O;H0;-1:1]-[C;H0;+0:14](-[#6:13])=[O:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14](-[#6:13])=[O:15])=[N;H0;+0:5]-[#6:6]'],
     'pKa': [None],
     'Description': 'Formation of a single bond between carboxylic acid and protonated DCC'},

    4: {'Templates': ['[N;H3;+0:8].[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14](-[#6:13])=[O:15])=[N;H0;+0:5]-[#6:6]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14]([N;H3;+1:8])(-[#6:13])-[O;-1:15])=[N;H0;+0:5]-[#6:6]',
        '[*:7]-[N;H2;+0:8].[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14](-[#6:13])=[O:15])=[N;H0;+0:5]-[#6:6]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14]([N;H2;+1:8]-[*:7])(-[#6:13])-[O;-1:15])=[N;H0;+0:5]-[#6:6]',
      '[*:7]-[N;H1;+0:8].[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14](-[#6:13])=[O:15])=[N;H0;+0:5]-[#6:6]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14]([N;H1;+1:8]-[*:7])(-[#6:13])-[O;-1:15])=[N;H0;+0:5]-[#6:6]',],
     'pKa': [None, None],
     'Description': 'Addition of amine (alcohol) into carboxylic acid-DCC complex'},

    5: {'Templates': ['[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14](-[N;+1:8]-[*:7])(-[#6:13])-[O;-1:15])=[N;H0;+0:5]-[#6:6]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[#6:13]-[C;H0;+0:14](-[N;+1:8]-[*:7])=[O;+0:15]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;+0:1]-[C;H0;+0:14](-[N;+1:8])(-[#6:13])-[O;-1:15])=[N;H0;+0:5]-[#6:6]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4]([O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[#6:13]-[C;H0;+0:14](-[N;+1:8])=[O;+0:15]'],
     'pKa': [None,  None],
     'Description': 'Cleavage into amide and urea'},
   6: {'Templates': ['[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H3;+1:8]-[*:7])(-[#6:13])=[O;+0:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H2;+0:8]-[*:7])(-[#6:13])=[O;+0:15]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H2;+1:8]-[*:7])(-[#6:13])=[O;+0:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H1;+0:8]-[*:7])(-[#6:13])=[O;+0:15]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H1;+1:8]-[*:7])(-[#6:13])=[O;+0:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H0;+0:8]-[*:7])(-[#6:13])=[O;+0:15]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H3;+1:8])(-[#6:13])=[O;+0:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H2;+0:8])(-[#6:13])=[O;+0:15]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H2;+1:8])(-[#6:13])=[O;+0:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H1;+0:8])(-[#6:13])=[O;+0:15]',
      '[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](-[O;H0;-1:1])=[N;H0;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H1;+1:8])(-[#6:13])=[O;+0:15]>>[#6:2]-[N;H1;+0:3]-[C;H0;+0:4](=[O;H0;+0:1])-[N;H1;+0:5]-[#6:6].[C;H0;+0:14](-[#7;H0;+0:8])(-[#6:13])=[O;+0:15]'],
     'pKa': [None, None, None, None, None, None],
     'Description': 'Proton exchange between amide and urea'}}},

  'Condensation without catalyst': {'Reagent': ['[#7]','[O]=[C]-[O]-[#6]'], 'Exclude_reagent': ['[N]=[C]=[N]'],
   'Stages': {0: {'Templates': ['[#7;H4;+1:5]>>[#7;H3;+0:5]',
      '[#7;H3;+1:5]>>[#7;H2;+0:5]',
      '[#7;H2;+1:5]>>[#7;H1;+0:5]',
      '[#7;H1;+1:5]>>[#7;H0;+0:5]'],
     'pKa': [ {'B': 9.25}, {'B': 9.25}, {'B': 9.25}, {'B': 9.25}],
     'Description': 'Deprotonation of amine'},
    1: {'Templates': ['[*:4]-[#7;!H0;+0:5].[O:1]-[C;H0;+0:14](-[#6:13])=[O:15]>>[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;+1:5]-[*:4]',
      '[#7;!H0;+0:5].[O:1]-[C;H0;+0:14](-[#6:13])=[O:15]>>[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;+1:5]'],
     'pKa': [None, None],
     'Description': 'Addition of amine into carboxylate'},

    2: {'Templates': ['[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;H3;+1:5]>>[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;H2;+0:5]',
      '[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;H2;+1:5]>>[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;H1;+0:5]',
      '[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;H1;+1:5]>>[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:1])-[#7;H0;+0:5]'],
     'pKa': [{'B': 9.25}, {'B': 9.25}, {'B': 9.25}],
     'Description': 'Deprotonation of amine'},

    3: {'Templates': ['[#6:13]-[C;H0;+0:14](-[O;-1:15])(-[O:2]-[*:16])-[N;+0:5]>>[#6:13]-[C;H0;+0:14](=[O;+0:15])-[N;+0:5].[O;-1:2]-[*:16]'],
     'pKa': [None],
     'Description': 'Hydroxide ion leaves'}}}},




# {'Reaction':{'Reagent':['[N]','[O]=[C]-[O]-[#6]'],'Exclude_reagent':None,
#             'Stages':{0:{'Templates':['[O:1]=[C:2]-[O:3]-[#6:4].[N;H3;+0:5]>>[N;H3;+1:5]-[C:2](-[O;H0;-1:1])-[O:3]-[#6:4]'],
#                          'pKa':[None],
#                          'Description':'Nucleophilic addition'},
#                       1:{'Templates':['[N;H3;+1:5]-[C:2](-[O;H0;-1:1])-[O:3]-[#6:4]>>[N;H2;+0:5]-[C:2](-[O;H1;+0:1])-[O:3]-[#6:4]'],
#                          'pKa':[None],
#                          'Description':'Proton transfer'},
#                       2:{'Templates':['[N;H2;+0:5]-[C:2](-[O;H1;+0:1])-[O:3]-[#6:4]>>[N;H2;+0:5]-[C:2]=[O;H1;+1:1].[O;H0;-1:3]-[#6:4]'],
#                          'pKa':[None],
#                          'Description':'Tetrahedral intermediate collapse'},
#                       3:{'Templates':['[N;H2;+0:5]-[C:2]=[O;H1;+1:1].[O;H0;-1:3]-[#6:4]>>[N;H2;+0:5]-[C:2]=[O;H0;+0:1].[O;H1;+0:3]-[#6:4]'],
#                          'pKa':[None],
#                          'Description':'Proton transfer'},}}},

('Fluoro N-arylation',
'Chloro N-arylation',
'Bromo N-arylation',
'Iodo N-arylation',): {'Reaction': {'Reagent':['[c]-[F,Cl,Br,I]','[#7]'],'Exclude_reagent':None,
      'Stages':{0:{'Templates': ['[N;H1:1].[F,Cl,Br,I:3]-[c:2]:[a:4]>>[N;H1;+1:1]-[c:2](-[F,Cl,Br,I:3])-[a;-1:4]',
                                 '[N;H2:1].[F,Cl,Br,I:3]-[c:2]:[a:4]>>[N;H2;+1:1]-[c:2](-[F,Cl,Br,I:3])-[a;-1:4]'],
          'pKa' : [None],
          'Description': 'Nucleophilic Addition'},
      1: {'Templates': ['[N;H1;+1:1]-[c:2](-[F,Cl,Br,I:3])-[a;-1:4]>>[N;H1;+1:1]-[c:2]:[a;+0:4].[F,Cl,Br,I;-1:3]',
                        '[N;H2;+1:1]-[c:2](-[F,Cl,Br,I:3])-[a;-1:4]>>[N;H2;+1:1]-[c:2]:[a;+0:4].[F,Cl,Br,I;-1:3]'],
          'pKa':[None],
          'Description': 'Elimination'},
      2:{'Templates':['[N;H1;+1:1]-[c:2]:[a;+0:4].[F,Cl,Br,I;-1:3]>>[N;H0;+0:1]-[c:2]:[a;+0:4].[F,Cl,Br,I;H1;+0:3]',
                      '[N;H2;+1:1]-[c:2]:[a;+0:4].[F,Cl,Br,I;-1:3]>>[N;H1;+0:1]-[c:2]:[a;+0:4].[F,Cl,Br,I;H1;+0:3]'],
                      'pKa':[None],
                      'Description':'Proton transfer'}
          
      }},
      },

      #add OTf,OMs
('Alcohol elimination',):{'Acid-catalyzed E1':{'Reagent':None,'Exclude_reagent':None,
                                               'Stages':{0:{'Templates':['[O;H1:1]-[C:2]-[C;H1:3]>>[O;H2;+1:1]-[C:2]-[C;H1:3]',
                                                                     '[O;H1:1]-[C:2]-[C;H2:3]>>[O;H2;+1:1]-[C:2]-[C;H2:3]',
                                                                     '[O;H1:1]-[C:2]-[C;H3:3]>>[O;H2;+1:1]-[C:2]-[C;H3:3]'],
                                                              'pKa':[{'A':0}],
                                                              'Description':'Protonation'},
                                                        1:{'Templates':['[O;H2;+1:1]-[C:2]-[C;H1:3]>>[O;H2;+0:1].[C;+1:2]-[C;H1:3]',
                                                                        '[O;H2;+1:1]-[C:2]-[C;H2:3]>>[O;H2;+0:1].[C;+1:2]-[C;H2:3]',
                                                                        '[O;H2;+1:1]-[C:2]-[C;H3:3]>>[O;H2;+0:1].[C;+1:2]-[C;H3:3]'],
                                                              'pKa':[None],
                                                              'Description':'Carbocation formation'},
                                                        2:{'Templates':['[C;+1:2]-[C;H1:3]>>[C;+0:2]-[C;H0;+0:3]',
                                                                        '[C;+1:2]-[C;H2:3]>>[C;+0:2]-[C;H1;+0:3]',
                                                                        '[C;+1:2]-[C;H3:3]>>[C;+0:2]-[C;H2;+0:3]'],
                                                              'pKa':[{'B':15},{'B':15},{'B':15}],
                                                              'Description':'Elimination'}}}}, # not sure why this isn't parsing


('Carbamate + amine reaction',):{'Neutral':{'Reagent':['[O]-[C](=[O])-[#7]','[#7]'],'Exclude_reagent':None,
                                                  'Stages':{0:{'Templates':['[O:1]-[C:2](=[O:3])-[#7:4].[#7;H1;+0:5]>>[O:1]-[C:2](-[#7;H1;+1:5])(-[O;H0;-1:3])-[#7:4]',
                                                                            '[O:1]-[C:2](=[O:3])-[#7:4].[#7;H2;+0:5]>>[O:1]-[C:2](-[#7;H2;+1:5])(-[O;H0;-1:3])-[#7:4]',
                                                                            '[O:1]-[C:2](=[O:3])-[#7:4].[#7;H3;+0:5]>>[O:1]-[C:2](-[#7;H3;+1:5])(-[O;H0;-1:3])-[#7:4]'],
                                                                            'pKa':[None,None,None],
                                                                            'Description':'Nucleophilic addition'},
                                                            1:{'Templates':['[O:1]-[C:2](-[#7;H1;+1:5])(-[O;H0;-1:3])-[#7:4]>>[O;H0;-1:1].[#7;H1;+1:5]-[C:2](=[O;H0;+0:3])-[#7:4]',
                                                                            '[O:1]-[C:2](-[#7;H2;+1:5])(-[O;H0;-1:3])-[#7:4]>>[O;H0;-1:1].[#7;H2;+1:5]-[C:2](=[O;H0;+0:3])-[#7:4]',
                                                                            '[O:1]-[C:2](-[#7;H3;+1:5])(-[O;H0;-1:3])-[#7:4]>>[O;H0;-1:1].[#7;H3;+1:5]-[C:2](=[O;H0;+0:3])-[#7:4]'],
                                                                            'pKa':[None,None,None],
                                                                            'Description':'Tetrahedral intermediate collapse'},
                                                            2:{'Templates':['[O;H0;-1:1].[#7;H1;+1:5]-[C:2](=[O;H0;+0:3])-[#7:4]>>[O;H1;+0:1].[#7;H0;+0:5]-[C:2](=[O;H0;+0:3])-[#7:4]',
                                                                            '[O;H0;-1:1].[#7;H2;+1:5]-[C:2](=[O;H0;+0:3])-[#7:4]>>[O;H1;+0:1].[#7;H1;+0:5]-[C:2](=[O;H0;+0:3])-[#7:4]',
                                                                            '[O;H0;-1:1].[#7;H3;+1:5]-[C:2](=[O;H0;+0:3])-[#7:4]>>[O;H1;+0:1].[#7;H2;+0:5]-[C:2](=[O;H0;+0:3])-[#7:4]'],
                                                                            'pKa':[None,None,None],
                                                                            'Description':'Deprotonation'}}}},

('O-Ac deprotection',):{'Base-catalyzed':{'Reagent':['[O]-[C](=[O])-[C]'],'Exclude_reagent':None,
                                         'Stages':{0:{'Templates':['[O;H1;+0:5]>>[O;H0;-1:5]',
                                                                   '[O;H2;+0:5]>>[O;H1;-1:5]'],
                                                      'pKa':[{'B':15},{'B':15}],
                                                      'Description':'Deprotonation'},
                                                  1:{'Templates':['[O:1]-[C:2](=[O:3])-[C;H3:4].[O;H0;-1:5]>>[O:1]-[C:2](-[O;H0;-1:3])(-[O;H0;+0:5])-[C;H3:4]',
                                                                  '[O:1]-[C:2](=[O:3])-[C;H3:4].[O;H1;-1:5]>>[O:1]-[C:2](-[O;H0;-1:3])(-[O;H1;+0:5])-[C;H3:4]'],
                                                      'pKa':[None,None],
                                                      'Description':'Nucleophilic addition'},
                                                  2:{'Templates':['[O:1]-[C:2](-[O;H0;-1:3])(-[O;H0;+0:5])-[C;H3:4]>>[O;H0;-1:1].[O;H0;+0:3]=[C:2](-[O;H0;+0:5])-[C;H3:4]',
                                                                  '[O:1]-[C:2](-[O;H0;-1:3])(-[O;H1;+0:5])-[C;H3:4]>>[O;H0;-1:1].[O;H0;+0:3]=[C:2](-[O;H1;+0:5])-[C;H3:4]'],
                                                      'pKa':[None,None],
                                                      'Description':'Tetrahedral intermediate collapse'},
                                                  3:{'Templates':['[O;H0;-1:1]>>[O;H1;+0:1]',
                                                                  '[O;H0;-1:1].[O;H1;+0:5]>>[O;H1;+0:1].[O;H0;-1:5]'],
                                                                  'pKa':[{'B':15},None],
                                                                  'Description':'Protonation'}}}},

('Knorr pyrazole synthesis',):{'Reaction':{'Reagent':['[O]=[C]-[C]-[C]=[O]','[N]-[N]'],'Exclude_reagent':None,
                                          'Stages':{0:{'Templates':['[O:1]=[C:2]-[C:3]-[C:4]=[O:5].[N;H2:6]-[N;H2:7]>>[O;H0;-1:1]-[C:2](-[N;H2;+1:6]-[N;H2;+0:7])-[C:3]-[C:4]=[O:5]',
                                                                     '[O:1]=[C:2]-[C:3]-[C:4]=[O:5].[N;H2:6]-[N;H1:7]-[#6:8]>>[O;H0;-1:1]-[C:2](-[N;H2;+1:6]-[N;H1;+0:7]-[#6:8])-[C:3]-[C:4]=[O:5]'],
                                                       'pKa':[None],
                                                       'Description':'Nucleophilic addition'},
                                                    1:{'Templates':['[O;H0;-1:1]-[C:2](-[N;H2;+1:6]-[N;H2;+0:7])-[C:3]-[C:4]=[O:5]>>[O;H1;+0:1]-[C:2](-[N;H1;+0:6]-[N;H2;+0:7])-[C:3]-[C:4]=[O:5]',
                                                                    '[O;H0;-1:1]-[C:2](-[N;H2;+1:6]-[N;H1;+0:7]-[#6:8])-[C:3]-[C:4]=[O:5]>>[O;H1;+0:1]-[C:2](-[N;H1;+0:6]-[N;H1;+0:7]-[#6:8])-[C:3]-[C:4]=[O:5]'],
                                                       'pKa':[None],
                                                       'Description':'Proton transfer'},
                                                    2:{'Templates':['[O;H1;+0:1]-[C:2](-[N;H1;+0:6]-[N;H2;+0:7])-[C:3]-[C:4]=[O:5]>>[O;H1;-1:1].[C:2](=[N;H1;+1:6]-[N;H2;+0:7])-[C:3]-[C:4]=[O:5]',
                                                                    '[O;H1;+0:1]-[C:2](-[N;H1;+0:6]-[N;H1;+0:7]-[#6:8])-[C:3]-[C:4]=[O:5]>>[O;H1;-1:1].[C:2](=[N;H1;+1:6]-[N;H1;+0:7]-[#6:8])-[C:3]-[C:4]=[O:5]'],
                                                       'pKa':[None],
                                                       'Description':'Hydrazide formation'},
                                                    3:{'Templates':['[O;H1;-1:1].[C:2](=[N;H1;+1:6]-[N;H2;+0:7])-[C:3]-[C:4]=[O:5]>>[O;H2;+0:1].[C:2](=[N;H0;+0:6]-[N;H2;+0:7])-[C:3]-[C:4]=[O:5]',
                                                                    '[O;H1;-1:1].[C:2](=[N;H1;+1:6]-[N;H1;+0:7]-[#6:8])-[C:3]-[C:4]=[O:5]>>[O;H2;+0:1].[C:2](=[N;H0;+0:6]-[N;H1;+0:7]-[#6:8])-[C:3]-[C:4]=[O:5]'],
                                                                    'pKa':[None],
                                                                    'Description':'Proton transfer'},
                                                    4:{'Templates':['[C:2](=[N;H0;+0:6]-[N;H2;+0:7])-[C:3]-[C:4]=[O;H0;+0:5]>>[N;H2;+1:7]1-[N;H0;+0:6]=[C:2]-[C:3]-[C:4]1-[O;H0;-1:5]',
                                                                    '[C:2](=[N;H0;+0:6]-[N;H1;+0:7]-[#6:8])-[C:3]-[C:4]=[O;H0;+0:5]>>[#6:8]-[N;H1;+1:7]1-[N;H0;+0:6]=[C:2]-[C:3]-[C:4]1-[O;H0;-1:5]'],
                                                       'pKa':[None],
                                                       'Description':'Nucleophilic addition'},
                                                    5:{'Templates':['[N;H2;+1:7]1-[N;H0;+0:6]=[C:2]-[C:3]-[C:4]1-[O;H0;-1:5]>>[N;H1;+0:7]1-[N;H0;+0:6]=[C:2]-[C:3]-[C:4]1-[O;H1;+0:5]',
                                                                    '[#6:8]-[N;H1;+1:7]1-[N;H0;+0:6]=[C:2]-[C:3]-[C:4]1-[O;H0;-1:5]>>[#6:8]-[N;H0;+0:7]1-[N;H0;+0:6]=[C:2]-[C:3]-[C:4]1-[O;H1;+0:5]'],
                                                       'pKa':[None],
                                                       'Description':'Proton transfer'},
                                                    6:{'Templates':['[N;H1;+0:7]1-[N;H0;+0:6]=[C:2]-[C:3]-[C:4]1-[O;H1;+0:5]>>[N;H0;+0:6]1=[C:2]-[C:3]-[C:4]=[N;H1;+1:7]1.[O;H1;-1:5]',
                                                                    '[#6:8]-[N;H0;+0:7]1-[N;H0;+0:6]=[C:2]-[C:3]-[C:4]1-[O;H1;+0:5]>>[N;H0;+0:6]1=[C:2]-[C:3]-[C:4]=[N;H0;+1:7]1-[#6:8].[O;H1;-1:5]'],
                                                       'pKa':[None],
                                                       'Description':'Second hydrazide formation'},
                                                    7:{'Templates':['[N;H0;+0:6]1=[C:2]-[C:3]-[C:4]=[N;H1;+1:7]1.[O;H1;-1:5]>>[c:2]1=[n;H0;+0:6]-[n;H1;+0:7]-[c:4]=[c:3]1.[O;H2;+0:5]',
                                                                    '[N;H0;+0:6]1=[C:2]-[C:3]-[C:4]=[N;H0;+1:7]1.[O;H1;-1:5]>>[c:2]1=[n;H0;+0:6]-[n;H0;+0:7](-[#6:8])-[c:4]=[c:3]1.[O;H2;+0:5]'],
                                                       'pKa':[None],
                                                       'Description':'Elimination to form pyrazole'}}}},
('Krapcho decarboxylation',):{'Methyl ester w/LiCl':{'Reagent':['[O]=[C]-[C]-[C](=[O])-[O]-[CH3]','[Cl;-1]'],'Exclude_reagent':None,
                                             'Stages':{0:{'Templates':['[O:1]=[C:2]-[C:3]-[C:4](=[O:5])-[O:6]-[C;H3:7].[Cl;-1:8]>>[O;H0;-1:1]-[C:2]=[C:3].[O:5]=[C:4]=[O:6].[C;H3:7]-[Cl;H0;+0:8]'],
                                                          'pKa':[None],
                                                          'Description':'Decarboxylation' },
                                                1:{'Templates':['[O;H0;-1:1]-[C:2]=[C:3]>>[O;H0;+0:1]=[C:2]-[C:3]'],
                                                   'pKa':[{'A':20}],
                                                   'Description':'Enolate protonation'},
                                                   }},
                            'Methyl ester w/HCl':{'Reagent':['[O]=[C]-[C]-[C](=[O])-[O]-[CH3]','[Cl;-1]'],'Exclude_reagent':None,
                                             'Stages':{0:{'Templates':['[H:10]-[Cl:11]>>[H;+1:10]-[Cl;-1:11]'],
                                                          'pKa':[None],
                                                          'Description':['HCl dissociation']},
                                                       1:{'Templates':['[O:1]=[C:2]-[C:3]-[C:4](=[O:5])-[O:6]-[C;H3:7].[Cl;-1:8]>>[O;H0;-1:1]-[C:2]=[C:3].[O:5]=[C:4]=[O:6].[C;H3:7]-[Cl;H0;+0:8]'],
                                                          'pKa':[None],
                                                          'Description':'Decarboxylation' },
                                                2:{'Templates':['[O;H0;-1:1]-[C:2]=[C:3]>>[O;H0;+0:1]=[C:2]-[C:3]'],
                                                   'pKa':[{'A':20}],
                                                   'Description':'Enolate protonation'},
                                                   }},
                              'Ethyl ester w/LiCl':{'Reagent':['[O]=[C]-[C]-[C](=[O])-[O]-[CH2]-[CH3]','[Cl;-1]'],'Exclude_reagent':None,
                                             'Stages':{0:{'Templates':['[O:1]=[C:2]-[C:3]-[C:4](=[O:5])-[O:6]-[C;H2:7]-[C;H3:9].[Cl;-1:8]>>[O;H0;-1:1]-[C:2]=[C:3].[O:5]=[C:4]=[O:6].[C;H3:9]-[C;H2:7]-[Cl;H0;+0:8]'],
                                                          'pKa':[None],
                                                          'Description':'Decarboxylation' },
                                                1:{'Templates':['[O;H0;-1:1]-[C:2]=[C:3]>>[O;H0;+0:1]=[C:2]-[C:3]'],
                                                   'pKa':[{'A':20}],
                                                  'Description':'Enolate protonation'},}},
                              'Ethyl ester w/HCl':{'Reagent':['[O]=[C]-[C]-[C](=[O])-[O]-[CH2]-[CH3]','[Cl;-1]'],'Exclude_reagent':None,
                                             'Stages':{0:{'Templates':['[H:10]-[Cl:11]>>[H;+1:10]-[Cl;-1:11]'],
                                                          'pKa':[None],
                                                          'Description':['HCl dissociation']},
                                                 1:{'Templates':['[O:1]=[C:2]-[C:3]-[C:4](=[O:5])-[O:6]-[C;H2:7]-[C;H3:9].[Cl;-1:8]>>[O;H0;-1:1]-[C:2]=[C:3].[O:5]=[C:4]=[O:6].[C;H3:9]-[C;H2:7]-[Cl;H0;+0:8]'],
                                                          'pKa':[None],
                                                          'Description':'Decarboxylation' },
                                                2:{'Templates':['[O;H0;-1:1]-[C:2]=[C:3]>>[O;H0;+0:1]=[C:2]-[C:3]'],
                                                   'pKa':[{'A':20}],
                                                   'Description':'Enolate protonation'},                                                                      
                                             }}},
('Carboxylic acid + amidine condensation',):{'Neutral':{'Reagent':['[#7]=[#6]-[#7]','[O]=[C]-[O]'],'Exclude_reagent':None,
                                                       'Stages':{0:{'Templates':['[#7;H2:1]=[#6:2]-[#7:3].[O:4]=[C:5]-[O;H1:6]>>[O;H0;-1:4]-[C:5](-[O;H1:6])-[#7;H2;+1:1]=[#6:2]-[#7:3]',
                                                                                 '[#7;H2:1]=[#6:2]-[#7:3].[O:4]=[C:5]-[O;H0:6]>>[O;H0;-1:4]-[C:5](-[O;H0:6])-[#7;H2;+1:1]=[#6:2]-[#7:3]',
                                                                                 '[#7;H1:1]=[#6:2]-[#7:3].[O:4]=[C:5]-[O;H1:6]>>[O;H0;-1:4]-[C:5](-[O;H1:6])-[#7;H1;+1:1]=[#6:2]-[#7:3]',
                                                                                 '[#7;H1:1]=[#6:2]-[#7:3].[O:4]=[C:5]-[O;H0:6]>>[O;H0;-1:4]-[C:5](-[O;H0:6])-[#7;H1;+1:1]=[#6:2]-[#7:3]',
                                                                                 '[#7;H2:1]-[#6:2]=[#7:3].[O:4]=[C:5]-[O;H1:6]>>[O;H0;-1:4]-[C:5](-[O;H1:6])-[#7;H2;+1:1]-[#6:2]=[#7:3]',
                                                                                 '[#7;H2:1]-[#6:2]=[#7:3].[O:4]=[C:5]-[O;H0:6]>>[O;H0;-1:4]-[C:5](-[O;H0:6])-[#7;H2;+1:1]-[#6:2]=[#7:3]',
                                                                                 '[#7;H1:1]-[#6:2]=[#7:3].[O:4]=[C:5]-[O;H1:6]>>[O;H0;-1:4]-[C:5](-[O;H1:6])-[#7;H1;+1:1]-[#6:2]=[#7:3]',
                                                                                 '[#7;H1:1]-[#6:2]=[#7:3].[O:4]=[C:5]-[O;H0:6]>>[O;H0;-1:4]-[C:5](-[O;H0:6])-[#7;H1;+1:1]-[#6:2]=[#7:3]'],
                                                                    'pKa':[None,None,None,None,None,None,None,None],
                                                                    'Description':'Nucleophilic addition'},
                                                                1:{'Templates':['[O;H0;-1:4]-[C:5](-[O;H1:6])-[#7;H2;+1:1]=[#6:2]-[#7:3]>>[O;H0;-1:4]-[C:5](-[O;H2;+1:6])-[#7;H1;+0:1]=[#6:2]-[#7:3]',
                                                                                '[O;H0;-1:4]-[C:5](-[O;H0:6])-[#7;H2;+1:1]=[#6:2]-[#7:3]>>[O;H0;-1:4]-[C:5](-[O;H1;+1:6])-[#7;H1;+0:1]=[#6:2]-[#7:3]',
                                                                                '[O;H0;-1:4]-[C:5](-[O;H1:6])-[#7;H1;+1:1]=[#6:2]-[#7:3]>>[O;H0;-1:4]-[C:5](-[O;H2;+1:6])-[#7;H0;+0:1]=[#6:2]-[#7:3]',
                                                                                '[O;H0;-1:4]-[C:5](-[O;H0:6])-[#7;H1;+1:1]=[#6:2]-[#7:3]>>[O;H0;-1:4]-[C:5](-[O;H1;+1:6])-[#7;H0;+0:1]=[#6:2]-[#7:3]',
                                                                                '[O;H0;-1:4]-[C:5](-[O;H1:6])-[#7;H2;+1:1]-[#6:2]=[#7:3]>>[O;H0;-1:4]-[C:5](-[O;H2;+1:6])-[#7;H1;+0:1]-[#6:2]=[#7:3]',
                                                                                '[O;H0;-1:4]-[C:5](-[O;H0:6])-[#7;H2;+1:1]-[#6:2]=[#7:3]>>[O;H0;-1:4]-[C:5](-[O;H1;+1:6])-[#7;H1;+0:1]-[#6:2]=[#7:3]',
                                                                                '[O;H0;-1:4]-[C:5](-[O;H1:6])-[#7;H1;+1:1]-[#6:2]=[#7:3]>>[O;H0;-1:4]-[C:5](-[O;H2;+1:6])-[#7;H0;+0:1]-[#6:2]=[#7:3]',
                                                                                '[O;H0;-1:4]-[C:5](-[O;H0:6])-[#7;H1;+1:1]-[#6:2]=[#7:3]>>[O;H0;-1:4]-[C:5](-[O;H1;+1:6])-[#7;H0;+0:1]-[#6:2]=[#7:3]'],
                                                                   'pKa':[None,None,None,None,None,None,None,None],
                                                                   'Description':'Proton transfer'},
                                                                2:{'Templates':['[O;H0;-1:4]-[C:5](-[O;H2;+1:6])-[#7;H1;+0:1]=[#6:2]-[#7:3]>>[O;H0;+0:4]=[C:5]-[#7;H1;+0:1]=[#6:2]-[#7:3].[O;H2;+0:6]',
                                                                                '[O;H0;-1:4]-[C:5](-[O;H1;+1:6])-[#7;H1;+0:1]=[#6:2]-[#7:3]>>[O;H0;+0:4]=[C:5]-[#7;H1;+0:1]=[#6:2]-[#7:3].[O;H1;+0:6]',
                                                                                '[O;H0;-1:4]-[C:5](-[O;H2;+1:6])-[#7;H0;+0:1]=[#6:2]-[#7:3]>>[O;H0;+0:4]=[C:5]-[#7;H0;+0:1]=[#6:2]-[#7:3].[O;H2;+0:6]',
                                                                                '[O;H0;-1:4]-[C:5](-[O;H1;+1:6])-[#7;H0;+0:1]=[#6:2]-[#7:3]>>[O;H0;+0:4]=[C:5]-[#7;H0;+0:1]=[#6:2]-[#7:3].[O;H1;+0:6]',
                                                                                '[O;H0;-1:4]-[C:5](-[O;H2;+1:6])-[#7;H1;+0:1]-[#6:2]=[#7:3]>>[O;H0;+0:4]=[C:5]-[#7;H1;+0:1]-[#6:2]=[#7:3].[O;H2;+0:6]',
                                                                                '[O;H0;-1:4]-[C:5](-[O;H1;+1:6])-[#7;H1;+0:1]-[#6:2]=[#7:3]>>[O;H0;+0:4]=[C:5]-[#7;H1;+0:1]-[#6:2]=[#7:3].[O;H1;+0:6]',
                                                                                '[O;H0;-1:4]-[C:5](-[O;H2;+1:6])-[#7;H0;+0:1]-[#6:2]=[#7:3]>>[O;H0;+0:4]=[C:5]-[#7;H0;+0:1]-[#6:2]=[#7:3].[O;H2;+0:6]',
                                                                                '[O;H0;-1:4]-[C:5](-[O;H1;+1:6])-[#7;H0;+0:1]-[#6:2]=[#7:3]>>[O;H0;+0:4]=[C:5]-[#7;H0;+0:1]-[#6:2]=[#7:3].[O;H1;+0:6]'],
                                                                   'pKa':[None,None,None,None],
                                                                   'Description':'Tetrahedral intermediate collapse'}}}, 
                                              }, # add HATU/HOBt catalyzed 
('Carboxylic acid to alcohol reduction',):{'Borane/THF':{'Reagent':['[O]=[C]-[O]','[B]'],'Exclude_reagent':None,
                                          'Stages':{0:{'Templates':['[O:1]=[C:2]-[O:3]-[H:5].[B;H2:4]-[H:6]>>[O:1]=[C:2]-[O;H0;+0:3]-[B;H2;+0:4].[H:5]-[H:6]'],
                                                       'pKa':[None],
                                                       'Description':'Formation of acyl borate'},
                                                    1:{'Templates':['[O:1]=[C:2]-[O;H0;+0:3]-[B;H2;+0:4].[B;H3:5]>>[B;H3;-1:5]-[O;H0;+0:1]-[C:2]=[O;H0;+1:3]-[B;H2;+0:4]'],
                                                       'pKa':[None],
                                                       'Description':'Addition of another borane'},
                                                    2:{'Templates':['[B;H3;-1:5]-[O;H0;+0:1]-[C:2]=[O;H0;+1:3]-[B;H2;+0:4]>>[B;H2;+0:5]-[O;H0;+0:1]-[C;H1:2]-[O;H0;+0:3]-[B;H2;+0:4]'],
                                                       'pKa':[None],
                                                       'Description':'First addition of hydride'},
                                                    3:{'Templates':['[B;H2;+0:5]-[O;H0;+0:1]-[C;H1:2]-[O;H0;+0:3]-[B;H2;+0:4]>>[B;H2;+0:5]-[O;H0;-1:1].[C;H1:2]=[O;H0;+1:3]-[B;H2;+0:4]'],
                                                       'pKa':[None],
                                                       'Description':'Formation of activated aldehyde'},
                                                    4:{'Templates':['[B;H2;+0:5]-[O;H0;-1:1].[C;H1:2]=[O;H0;+1:3]-[B;H2;+0:4]>>[C;H1:2]=[O;H0;+1:3]-[B;H2;-1:4]-[O;H0;+0:1]-[B;H2;+0:5]'],
                                                       'pKa':[None],
                                                       'Description':'Formation of B-'},
                                                    5:{'Templates':['[C;H1:2]=[O;H0;+1:3]-[B;H2;-1:4]-[O;H0;+0:1]-[B;H2;+0:5]>>[C;H2:2]-[O;H0;+0:3]-[B;H1;+0:4]-[O;H0;+0:1]-[B;H2;+0:5]'],
                                                       'pKa':[None],
                                                       'Description':'Second addition of hydride'},
                                                    6:{'Templates':['[C;H2:2]-[O;H0;+0:3]-[B;H1;+0:4]-[O;H0;+0:1]-[B;H2;+0:5].[O;H2:6]>>[C;H2:2]-[O;H1;+0:3].[O;H1;+0:6]-[B;H1;+0:4]-[O;H0;+0:1]-[B;H2;+0:5]',
                                                                    '[C;H2:2]-[O;H0;+0:3]-[B;H1;+0:4]-[O;H0;+0:1]-[B;H2;+0:5].[O;H1:6]>>[C;H2:2]-[O;H1;+0:3].[O;H0;+0:6]-[B;H1;+0:4]-[O;H0;+0:1]-[B;H2;+0:5]'],
                                                        'pKa':[None, None],
                                                        'Description':'Hydrolysis'}}},
                                          'BF3/NaBH4':{'Reagent':['[B;H4;-1]','[O]=[C]-[O]','[F]-[B](-[F])-[F]'],'Exclude_reagent':None,
                                          'Stages':{0:{'Templates':['[B;H4;-1:8].[F:4]-[B:5](-[F:6])-[F:7]>>[F:4]-[B;H1;-1:5](-[F:6])(-[F:7]).[B;H3;+0:8]'],
                                                       'pKa':[None],
                                                       'Description':'Formation of BH3'},
                                                    1:{'Templates':['[O:1]=[C:2]-[O;H1:3].[B;H3:4]>>[O:1]=[C:2]-[O;H0;+0:3]-[B;H2;+0:4]'],
                                                       'pKa':[None],
                                                       'Description':'Formation of acyl borate'},
                                                    2:{'Templates':['[O:1]=[C:2]-[O;H0;+0:3]-[B;H2;+0:4].[B;H4;-1:9].[F:10]-[B:11](-[F:12])-[F:13]>>[O:1]=[C:2]-[O;H0;+0:3]-[B;H2;+0:4].[F:10]-[B;H1;-1:11](-[F:12])(-[F:13]).[B;H3;+0:9]'],
                                                       'pKa':[None],
                                                       'Description':'Formation of BH3'},
                                                    3:{'Templates':['[O:1]=[C:2]-[O;H0;+0:3]-[B;H2;+0:4].[B;H3:9]>>[B;H3;-1:9]-[O;H0;+0:1]-[C:2]=[O;H0;+1:3]-[B;H2;+0:4]'],
                                                       'pKa':[None],
                                                       'Description':'Addition of another borane'},
                                                    4:{'Templates':['[B;H3;-1:9]-[O;H0;+0:1]-[C:2]=[O;H0;+1:3]-[B;H2;+0:4]>>[B;H2;+0:9]-[O;H0;+0:1]-[C;H1:2]-[O;H0;+0:3]-[B;H2;+0:4]'],
                                                       'pKa':[None],
                                                       'Description':'First addition of hydride'},
                                                    5:{'Templates':['[B;H2;+0:9]-[O;H0;+0:1]-[C;H1:2]-[O;H0;+0:3]-[B;H2;+0:4]>>[B;H2;+0:9]-[O;H0;-1:1].[C;H1:2]=[O;H0;+1:3]-[B;H2;+0:4]'],
                                                       'pKa':[None],
                                                       'Description':'Formation of activated aldehyde'},
                                                    6:{'Templates':['[B;H2;+0:9]-[O;H0;-1:1].[C;H1:2]=[O;H0;+1:3]-[B;H2;+0:4]>>[C;H1:2]=[O;H0;+1:3]-[B;H2;-1:4]-[O;H0;+0:1]-[B;H2;+0:9]'],
                                                       'pKa':[None],
                                                       'Description':'Formation of B-'},
                                                    7:{'Templates':['[C;H1:2]=[O;H0;+1:3]-[B;H2;-1:4]-[O;H0;+0:1]-[B;H2;+0:9]>>[C;H2:2]-[O;H0;+0:3]-[B;H1;+0:4]-[O;H0;+0:1]-[B;H2;+0:9]'],
                                                       'pKa':[None],
                                                       'Description':'Second addition of hydride'},
                                                    8:{'Templates':['[C;H2:2]-[O;H0;+0:3]-[B;H1;+0:4]-[O;H0;+0:1]-[B;H2;+0:9].[O;H2:6]>>[C;H2:2]-[O;H1;+0:3].[O;H1;+0:6]-[B;H1;+0:4]-[O;H0;+0:1]-[B;H2;+0:9]',
                                                                    '[C;H2:2]-[O;H0;+0:3]-[B;H1;+0:4]-[O;H0;+0:1]-[B;H2;+0:9].[O;H1:6]>>[C;H2:2]-[O;H1;+0:3].[O;H0;+0:6]-[B;H1;+0:4]-[O;H0;+0:1]-[B;H2;+0:9]'],
                                                        'pKa':[None, None],
                                                        'Description':'Hydrolysis'},}},
                                            'LAH':{'Reagent':['[O]=[C]-[O]','[Al;+3]'],'Exclude_reagent':None,
                                            'Stages':{0:{'Templates':['[Al;+3:1].[H;-1:2].[H;-1:3].[H;-1:4].[H;-1:5]>>[Al;H4;-1:1]'],
                                                        'pKa':[None],
                                                        'Description':'Interconversion between ionic and covalent forms'},
                                                      1:{'Templates':['[O:6]=[C:7]-[O;H1:8].[Al;H4;-1:1]>>[O:6]=[C:7]-[O;H0;-1:8].[Al;H3;+0:1]'],
                                                         'pKa':[None],
                                                         'Description':'Acid-base reaction'},
                                                      2:{'Templates':['[O:6]=[C:7]-[O;H0;-1:8].[Al;H3;+0:1]>>[Al;H2;+0:1]-[O;H0;+0:6]-[C;H1:7]-[O;H0;-1:8]'],
                                                         'pKa':[None],
                                                         'Description':'First addition of hydride'},
                                                      3:{'Templates':['[Al;H2;+0:1]-[O;H0;+0:6]-[C;H1:7]-[O;H0;-1:8]>>[O;H0;+0:8]=[C;H1:7].[O;H0;-1:6]-[Al;H2;+0:1]'],
                                                         'pKa':[None],
                                                         'Description':'Formation of aldehyde'},
                                                      4:{'Templates':['[O;H0;+0:8]=[C;H1:7].[Al;+3:9].[H;-1:10].[H;-1:11].[H;-1:12].[H;-1:13]>>[O;H0;+0:8]=[C;H1:7].[Al;H4;-1:9]'],
                                                        'pKa':[None],
                                                        'Description':'Interconversion between ionic and covalent forms'},
                                                      5:{'Templates':['[O;H0;+0:8]=[C;H1:7].[Al;H4;-1:9]>>[O;H0;-1:8]-[C;H2:7].[Al;H3;+0:9]'],
                                                         'pKa':[None],
                                                         'Description':'Second addition of hydride'},
                                                      6:{'Templates':['[O;H0;-1:8]-[C;H2:7].[O;H2:14]>>[O;H1;+0:8]-[C;H2:7]',
                                                                      '[O;H0;-1:8]-[C;H2:7]>>[O;H1;+0:8]-[C;H2:7]'],
                                                          'pKa':[None,{'A':16}],
                                                          'Description':'Protonation'}}}},                                                                                 
('Primary ketimine reduction',
'Secondary ketimine reduction',):{'With acid':{'Reagent':['[C]=[N]'],'Exclude_reagent':None,
                                  'Stages':{0:{'Templates':['[N;H0;+0:1]=[C;H0:2].[B;H4;-1:3]>>[N;H0;-1:1]-[C;H1:2].[B;H3;+0:3]',
                                                            '[N;H0;+0:1]=[C;H1:2].[B;H4;-1:3]>>[N;H0;-1:1]-[C;H2:2].[B;H3;+0:3]',
                                                            '[N;H0;+0:1]=[C;H2:2].[B;H4;-1:3]>>[N;H0;-1:1]-[C;H3:2].[B;H3;+0:3]',
                                                            '[N;H1;+0:1]=[C;H0:2].[B;H4;-1:3]>>[N;H1;-1:1]-[C;H1:2].[B;H3;+0:3]',
                                                            '[N;H1;+0:1]=[C;H1:2].[B;H4;-1:3]>>[N;H1;-1:1]-[C;H2:2].[B;H3;+0:3]',
                                                            '[N;H1;+0:1]=[C;H2:2].[B;H4;-1:3]>>[N;H1;-1:1]-[C;H3:2].[B;H3;+0:3]',
                                                            '[N;H0;+0:1]=[C;H0:2].[B;H3;-1:3]>>[N;H0;-1:1]-[C;H1:2].[B;H2;+0:3]',
                                                            '[N;H0;+0:1]=[C;H1:2].[B;H3;-1:3]>>[N;H0;-1:1]-[C;H2:2].[B;H2;+0:3]',
                                                            '[N;H0;+0:1]=[C;H2:2].[B;H3;-1:3]>>[N;H0;-1:1]-[C;H3:2].[B;H2;+0:3]',
                                                            '[N;H1;+0:1]=[C;H0:2].[B;H3;-1:3]>>[N;H1;-1:1]-[C;H1:2].[B;H2;+0:3]',
                                                            '[N;H1;+0:1]=[C;H1:2].[B;H3;-1:3]>>[N;H1;-1:1]-[C;H2:2].[B;H2;+0:3]',
                                                            '[N;H1;+0:1]=[C;H2:2].[B;H3;-1:3]>>[N;H1;-1:1]-[C;H3:2].[B;H2;+0:3]'],
                                                'pKa':[None,None,None,None,None,None,None,None,None,None,None,None],
                                                'Description':'Hydride addition'},
                                            1:{'Templates':['[N;H0;-1:1]-[C;H1:2].[O;H2;+0:4]>>[N;H1;+0:1]-[C;H1:2].[O;H1;-1:4]',
                                                            '[N;H0;-1:1]-[C;H1:2].[O;H1;+0:4]>>[N;H1;+0:1]-[C;H1:2].[O;H0;-1:4]',
                                                            '[N;H0;-1:1]-[C;H2:2].[O;H2;+0:4]>>[N;H1;+0:1]-[C;H2:2].[O;H1;-1:4]',
                                                            '[N;H0;-1:1]-[C;H2:2].[O;H1;+0:4]>>[N;H1;+0:1]-[C;H2:2].[O;H0;-1:4]',
                                                            '[N;H0;-1:1]-[C;H3:2].[O;H2;+0:4]>>[N;H1;+0:1]-[C;H3:2].[O;H1;-1:4]',
                                                            '[N;H0;-1:1]-[C;H3:2].[O;H1;+0:4]>>[N;H1;+0:1]-[C;H3:2].[O;H0;-1:4]',
                                                            '[N;H1;-1:1]-[C;H1:2].[O;H2;+0:4]>>[N;H2;+0:1]-[C;H1:2].[O;H1;-1:4]',
                                                            '[N;H1;-1:1]-[C;H1:2].[O;H1;+0:4]>>[N;H2;+0:1]-[C;H1:2].[O;H0;-1:4]',
                                                            '[N;H1;-1:1]-[C;H2:2].[O;H2;+0:4]>>[N;H2;+0:1]-[C;H2:2].[O;H1;-1:4]',
                                                            '[N;H1;-1:1]-[C;H2:2].[O;H1;+0:4]>>[N;H2;+0:1]-[C;H2:2].[O;H0;-1:4]',
                                                            '[N;H1;-1:1]-[C;H3:2].[O;H2;+0:4]>>[N;H2;+0:1]-[C;H3:2].[O;H1;-1:4]',
                                                            '[N;H1;-1:1]-[C;H3:2].[O;H1;+0:4]>>[N;H2;+0:1]-[C;H3:2].[O;H0;-1:4]',],
                                                  'pKa':[None,None,None,None,None,None,None,None,None,None,None,None],
                                                  'Description':'Protonation'}}}},   
('Carboxylic anhydride + amine reaction',):{'Neutral':{'Reagent':['[O]=[C]-[O]-[C]=[O]','[#7]'],'Exclude_reagent':None,
                                            'Stages':{0:{'Templates':['[O:1]=[C:2]-[O:3]-[C:4]=[O:5].[#7;H1;+0:6]>>[O:1]=[C:2]-[O:3]-[C:4](-[O;H0;-1:5])-[#7;H1;+1:6]',
                                                                      '[O:1]=[C:2]-[O:3]-[C:4]=[O:5].[#7;H2;+0:6]>>[O:1]=[C:2]-[O:3]-[C:4](-[O;H0;-1:5])-[#7;H2;+1:6]',
                                                                      '[O:1]=[C:2]-[O:3]-[C:4]=[O:5].[#7;H3;+0:6]>>[O:1]=[C:2]-[O:3]-[C:4](-[O;H0;-1:5])-[#7;H3;+1:6]'],
                                                          'pKa':[None,None,None],
                                                          'Description':'Nucleophilic addition'},
                                                      1:{'Templates':['[O:1]=[C:2]-[O:3]-[C:4](-[O;H0;-1:5])-[#7;H1;+1:6]>>[O:1]=[C:2]-[O:3]-[C:4](-[O;H1;+0:5])-[#7;H0;+0:6]',
                                                                      '[O:1]=[C:2]-[O:3]-[C:4](-[O;H0;-1:5])-[#7;H2;+1:6]>>[O:1]=[C:2]-[O:3]-[C:4](-[O;H1;+0:5])-[#7;H1;+0:6]',
                                                                      '[O:1]=[C:2]-[O:3]-[C:4](-[O;H0;-1:5])-[#7;H3;+1:6]>>[O:1]=[C:2]-[O:3]-[C:4](-[O;H1;+0:5])-[#7;H2;+0:6]'],
                                                          'pKa':[None,None,None],
                                                          'Description':'Proton transfer'},
                                                      2:{'Templates':['[O:1]=[C:2]-[O:3]-[C:4](-[O;H1;+0:5])-[#7;H0;+0:6]>>[O:1]=[C:2]-[O;H0;-1:3].[C:4](=[O;H1;+1:5])-[#7;H0;+0:6]',
                                                                      '[O:1]=[C:2]-[O:3]-[C:4](-[O;H1;+0:5])-[#7;H1;+0:6]>>[O:1]=[C:2]-[O;H0;-1:3].[C:4](=[O;H1;+1:5])-[#7;H1;+0:6]',
                                                                      '[O:1]=[C:2]-[O:3]-[C:4](-[O;H1;+0:5])-[#7;H2;+0:6]>>[O:1]=[C:2]-[O;H0;-1:3].[C:4](=[O;H1;+1:5])-[#7;H2;+0:6]'],
                                                          'pKa':[None,None,None],
                                                          'Description':'Tetrahedral intermediate collapse'},
                                                      3:{'Templates':['[O:1]=[C:2]-[O;H0;-1:3].[C:4](=[O;H1;+1:5])-[#7;H0;+0:6]>>[O:1]=[C:2]-[O;H1;+0:3].[C:4](=[O;H0;+0:5])-[#7;H0;+0:6]',
                                                                      '[O:1]=[C:2]-[O;H0;-1:3].[C:4](=[O;H1;+1:5])-[#7;H1;+0:6]>>[O:1]=[C:2]-[O;H1;+0:3].[C:4](=[O;H0;+0:5])-[#7;H1;+0:6]',
                                                                      '[O:1]=[C:2]-[O;H0;-1:3].[C:4](=[O;H1;+1:5])-[#7;H2;+0:6]>>[O:1]=[C:2]-[O;H1;+0:3].[C:4](=[O;H0;+0:5])-[#7;H2;+0:6]'],
                                                          'pKa':[None,None,None],
                                                          'Description':'Proton transfer'}}}},
('Tetrazole synthesis',):{'Cycloaddition':{'Reagent':['[#6]#[#7]'],'Exclude_reagent':None,
                                          'Stages':{0:{'Templates':['[#6:1]#[#7:2].[N;H0;-1:3]=[N;H0;+1:4]=[N;H0;-1:5]>>[#6:1]1=[#7;H0;+0:2]-[#7;H0;-1:5]-[#7;H0;+0:4]=[#7;H0;+0:3]1',
                                                                    '[#6:1]#[#7:2].[N;H0;-1:3]=[N;H0;+1:4]=[N;H0;-1:5]>>[#6:1]1=[#7;H0;+0:2]-[#7;H0;-1:3]-[#7;H0;+0:4]=[#7;H0;+0:5]1'],
                                                       'pKa':[None,None],
                                                       'Description':'Cycloaddition'},
                                                   1:{'Templates':['[#6:1]1=[#7;H0;+0:2]-[#7;H0;-1:5]-[#7;H0;+0:4]=[#7;H0;+0:3]1>>[#6:1]1=[#7;H0;+0:2]-[#7;H1;+0:5]-[#7;H0;+0:4]=[#7;H0;+0:3]1',
                                                                   '[#6:1]1=[#7;H0;+0:2]-[#7;H0;-1:3]-[#7;H0;+0:4]=[#7;H0;+0:5]1>>[#6:1]1=[#7;H0;+0:2]-[#7;H1;+0:3]-[#7;H0;+0:4]=[#7;H0;+0:5]1'],
                                                      'pKa':[{'A':5},{'A':5}]}}}},      #none of the reactions i saw had an acid added                                                                                                                                                                                                          

('Phillips benzimidazole condensation',):{'Neutral':{'Reagent':['[N]-[c]:[c]-[N]','[O]=[C]-[O]'],'Exclude_reagent':None,
                                                     'Stages':{0:{'Templates':['[N;H2:1]-[c:2]:[c:3]-[N;H2:4].[O:5]=[C:6]-[O;H1:7]>>[N;H3;+1:1]-[c:2]:[c:3]-[N;H2:4].[O:5]=[C:6]-[O;H0;-1:7]',
                                                                               '[N;H2:1]-[c:2]:[c:3]-[N;H1:4].[O:5]=[C:6]-[O;H1:7]>>[N;H3;+1:1]-[c:2]:[c:3]-[N;H1:4].[O:5]=[C:6]-[O;H0;-1:7]'],
                                                                  'pKa':[None,None],
                                                                  'Description':'Acid-base'},
                                                               1:{'Templates':['[N;H3;+1:1]-[c:2]:[c:3]-[N;H2:4].[O:5]=[C:6]-[O;H0;-1:7]>>[N;H3;+1:1]-[c:2]:[c:3]-[N;H2;+1:4]-[C:6](-[O;H0;-1:5])-[O;H0;-1:7]',
                                                                               '[N;H3;+1:1]-[c:2]:[c:3]-[N;H1:4].[O:5]=[C:6]-[O;H0;-1:7]>>[N;H3;+1:1]-[c:2]:[c:3]-[N;H1;+1:4]-[C:6](-[O;H0;-1:5])-[O;H0;-1:7]'],
                                                                  'pKa':[None,None],
                                                                  'Description':'Nucleophilic addition'},
                                                               2:{'Templates':['[N;H3;+1:1]-[c:2]:[c:3]-[N;H2;+1:4]-[C:6](-[O;H0;-1:5])-[O;H0;-1:7]>>[N;H3;+1:1]-[c:2]:[c:3]-[N;H1;+0:4]-[C:6](-[O;H1;+0:5])-[O;H0;-1:7]',
                                                                               '[N;H3;+1:1]-[c:2]:[c:3]-[N;H1;+1:4]-[C:6](-[O;H0;-1:5])-[O;H0;-1:7]>>[N;H3;+1:1]-[c:2]:[c:3]-[N;H0;+0:4]-[C:6](-[O;H1;+0:5])-[O;H0;-1:7]'],
                                                                  'pKa':[None,None],
                                                                  'Description':'Proton transfer'},
                                                               3:{'Templates':['[N;H3;+1:1]-[c:2]:[c:3]-[N;H1;+0:4]-[C:6](-[O;H1;+0:5])-[O;H0;-1:7]>>[N;H3;+1:1]-[c:2]:[c:3]-[N;H1;+0:4]-[C:6]=[O;H0;+0:7].[O;H1;-1:5]',
                                                                               '[N;H3;+1:1]-[c:2]:[c:3]-[N;H0;+0:4]-[C:6](-[O;H1;+0:5])-[O;H0;-1:7]>>[N;H3;+1:1]-[c:2]:[c:3]-[N;H0;+0:4]-[C:6]=[O;H0;+0:7].[O;H1;-1:5]'],
                                                                  'pKa':[None,None],
                                                                  'Description':'Tetrahedral intermediate collapse'},
                                                               4:{'Templates':['[N;H3;+1:1]-[c:2]:[c:3]-[N;H1;+0:4]-[C:6]=[O;H0;+0:7].[O;H1;-1:5]>>[N;H2;+0:1]-[c:2]:[c:3]-[N;H1;+0:4]-[C:6]=[O;H0;+0:7].[O;H2;+0:5]',
                                                                               '[N;H3;+1:1]-[c:2]:[c:3]-[N;H0;+0:4]-[C:6]=[O;H0;+0:7].[O;H1;-1:5]>>[N;H2;+0:1]-[c:2]:[c:3]-[N;H0;+0:4]-[C:6]=[O;H0;+0:7].[O;H2;+0:5]'],
                                                                  'pKa':[None,None],
                                                                  'Description':'Proton transfer'},
                                                               5:{'Templates':['[N;H2;+0:1]-[c:2]:[c:3]-[N;H1;+0:4]-[C:6]=[O;H0;+0:7]>>[N;H2;+1:1]1-[c:2]:[c:3]-[N;H1;+0:4]-[C:6]1-[O;H0;-1:7]',
                                                                               '[N;H2;+0:1]-[c:2]:[c:3]-[N;H0;+0:4]-[C:6]=[O;H0;+0:7]>>[N;H2;+1:1]1-[c:2]:[c:3]-[N;H0;+0:4]-[C:6]1-[O;H0;-1:7]'],
                                                                  'pKa':[None,None],
                                                                  'Description':'Nucleophilic addition'},
                                                               6:{'Templates':['[N;H2;+1:1]1-[c:2]:[c:3]-[N;H1;+0:4]-[C:6]1-[O;H0;-1:7]>>[N;H1;+0:1]1-[c:2]:[c:3]-[N;H1;+0:4]-[C:6]1-[O;H1;+0:7]',
                                                                               '[N;H2;+1:1]1-[c:2]:[c:3]-[N;H0;+0:4]-[C:6]1-[O;H0;-1:7]>>[N;H1;+0:1]1-[c:2]:[c:3]-[N;H0;+0:4]-[C:6]1-[O;H1;+0:7]'],
                                                                  'pKa':[None,None],
                                                                  'Description':'Proton transfer'},
                                                               7:{'Templates':['[N;H1;+0:1]1-[c:2]:[c:3]-[N;H1;+0:4]-[C:6]1-[O;H1;+0:7]>>[c:2]1:[c:3]-[N;H1;+0:4]-[C:6]=[N;H1;+1:1]1.[O;H1;-1:7]',
                                                                               '[N;H1;+0:1]1-[c:2]:[c:3]-[N;H0;+0:4]-[C:6]1-[O;H1;+0:7]>>[c:2]1:[c:3]-[N;H0;+0:4]-[C:6]=[N;H0;+1:1]1.[O;H1;-1:7]'],
                                                                  'pKa':[None,None],
                                                                  'Description':'Tetrahedral intermediate collapse'},
                                                               8:{'Templates':['[c:2]1:[c:3]-[N;H1;+0:4]-[C:6]=[N;H1;+1:1]1.[O;H1;-1:7]>>[c:2]1:[c:3]-[N;H1;+0:4]-[C:6]=[N;H0;+0:1]1.[O;H2;+0:7]',
                                                                               '[c:2]1:[c:3]-[N;H0;+0:4]-[C:6]=[N;H0;+1:1]1.[O;H1;-1:7]>>[c:2]1:[c:3]-[N;H0;+0:4]-[C:6]=[N;H0;+0:1]1.[O;H2;+0:7]'],
                                                                  'pKa':[None,None],
                                                                  'Description':'Proton transfer'}}}},
('Nitrile reduction',):{'LAH':{'Reagent':['[C]#[N]','[Al;+3]'],'Exclude_reagent':None,
                              'Stages':{0:{'Templates':['[Al;+3:3].[H;-1:6].[H;-1:7].[H;-1:8].[H;-1:9]>>[Al;H4;-1:3]'],
                                           'pKa':[None],
                                           'Description':'Ionic and covalent interconversion'},                                 
                                       1:{'Templates':['[C:1]#[N:2].[Al;H4;-1:3]>>[C;H1:1]=[N;H0;-1:2].[Al;H3;+0:3]'],
                                           'pKa':[None],
                                           'Description':'First hydride addition'},
                                       2:{'Templates':['[C;H1:1]=[N;H0;-1:2].[Al;H3;+0:3]>>[C;H2:1]-[N;H0;-1:2]-[Al;H2;+0:3]'],
                                          'pKa':[None],
                                          'Description':'Second hydride addition'},
                                       3:{'Templates':['[C;H2:1]-[N;H0;-1:2]-[Al;H2;+0:3].[O;H2;+0:4]>>[C;H2:1]-[N;H1;+0:2]-[Al;H2;+0:3].[O;H1;-1:4]'],
                                          'pKa':[None],
                                          'Description':'Protonation'},
                                       4:{'Templates':['[C;H2:1]-[N;H1;+0:2]-[Al;H2;+0:3].[O;H2;+0:5]>>[C;H2:1]-[N;H2;+0:2].[Al;H2;+0:3]-[O;H1;+0:5]'],
                                          'pKa':[None],
                                          'Description':'N-Al hydrolysis'}}},},
                        #add borane                                                                  
('N-Ac deprotection',):{'Base-catalyzed':{'Reagent':['[#7]-[C](=[O])-[C]'],'Exclude_reagent':None,
                                         'Stages':{0:{'Templates':['[O;H1;+0:5]>>[O;H0;-1:5]',
                                                                   '[O;H2;+0:5]>>[O;H1;-1:5]'],
                                                      'pKa':[{'B':15},{'B':15}],
                                                      'Description':'Deprotonation'},
                                                  1:{'Templates':['[#7;H1:1]-[C:2](=[O:3])-[C;H3:4].[O;H0;-1:5]>>[#7;H1:1]-[C:2](-[O;H0;-1:3])(-[O;H0;+0:5])-[C;H3:4]',
                                                                  '[#7;H0:1]-[C:2](=[O:3])-[C;H3:4].[O;H0;-1:5]>>[#7;H0:1]-[C:2](-[O;H0;-1:3])(-[O;H0;+0:5])-[C;H3:4]',
                                                                  '[#7;H1:1]-[C:2](=[O:3])-[C;H3:4].[O;H1;-1:5]>>[#7;H1:1]-[C:2](-[O;H0;-1:3])(-[O;H1;+0:5])-[C;H3:4]',
                                                                  '[#7;H0:1]-[C:2](=[O:3])-[C;H3:4].[O;H1;-1:5]>>[#7;H0:1]-[C:2](-[O;H0;-1:3])(-[O;H1;+0:5])-[C;H3:4]'],
                                                      'pKa':[None,None,None,None],
                                                      'Description':'Nucleophilic addition'},
                                                  2:{'Templates':['[#7;H1:1]-[C:2](-[O;H0;-1:3])(-[O;H0;+0:5])-[C;H3:4]>>[#7;H1;-1:1].[O;H0;+0:3]=[C:2](-[O;H0;+0:5])-[C;H3:4]',
                                                                  '[#7;H0:1]-[C:2](-[O;H0;-1:3])(-[O;H0;+0:5])-[C;H3:4]>>[#7;H0;-1:1].[O;H0;+0:3]=[C:2](-[O;H0;+0:5])-[C;H3:4]',
                                                                  '[#7;H1:1]-[C:2](-[O;H0;-1:3])(-[O;H1;+0:5])-[C;H3:4]>>[#7;H1;-1:1].[O;H0;+0:3]=[C:2](-[O;H1;+0:5])-[C;H3:4]',
                                                                  '[#7;H0:1]-[C:2](-[O;H0;-1:3])(-[O;H1;+0:5])-[C;H3:4]>>[#7;H0;-1:1].[O;H0;+0:3]=[C:2](-[O;H1;+0:5])-[C;H3:4]'],
                                                      'pKa':[None,None,None,None],
                                                      'Description':'Tetrahedral intermediate collapse'},
                                                  3:{'Templates':['[#7;H1;-1:1]>>[#7;H2;+0:1]',
                                                                  '[#7;H0;-1:1]>>[#7;H1;+0:1]',
                                                                  '[#7;H1;-1:1].[O;H1;+0:5]>>[#7;H2;+0:1].[O;H0;-1:5]',
                                                                  '[#7;H0;-1:1].[O;H1;+0:5]>>[#7;H1;+0:1].[O;H0;-1:5]'],
                                                                  'pKa':[{'B':15},{'B':15},None,None],
                                                                  'Description':'Protonation'}}}},
('Lumiere-Barbier method',):{'Reaction':{'Reagent':['[C]-[C](=[O])-[O]-[C](=[O])-[C]','[N]'],'Exclude_reagent':None,
                                        'Stages':{0:{'Templates':['[N;H2:1].[C:2]-[C:3](=[O:4])-[O:5]-[C:6](=[O:7])-[C:8]>>[N;H2;+1:1]-[C:3](-[C:2])(-[O;H0;-1:4])-[O:5]-[C:6](=[O:7])-[C:8]',
                                                                  '[N;H1:1].[C:2]-[C:3](=[O:4])-[O:5]-[C:6](=[O:7])-[C:8]>>[N;H1;+1:1]-[C:3](-[C:2])(-[O;H0;-1:4])-[O:5]-[C:6](=[O:7])-[C:8]'],
                                                     'pKa':[None,None],
                                                     'Description':'Nucleophilic addition'},
                                                1:{'Templates':['[N;H2;+1:1]-[C:3](-[C:2])(-[O;H0;-1:4])-[O:5]-[C:6](=[O:7])-[C:8]>>[N;H1;+0:1]-[C:3](-[C:2])(-[O;H1;+0:4])-[O:5]-[C:6](=[O:7])-[C:8]',
                                                                '[N;H1;+1:1]-[C:3](-[C:2])(-[O;H0;-1:4])-[O:5]-[C:6](=[O:7])-[C:8]>>[N;H0;+0:1]-[C:3](-[C:2])(-[O;H1;+0:4])-[O:5]-[C:6](=[O:7])-[C:8]'],
                                                   'pKa':[None,None],
                                                   'Description':'Proton transfer'},
                                                2:{'Templates':['[N;H1;+0:1]-[C:3](-[C:2])(-[O;H1;+0:4])-[O:5]-[C:6](=[O:7])-[C:8]>>[N;H1;+0:1]-[C:3](-[C:2])=[O;H1;+1:4].[O;H0;-1:5]-[C:6](=[O:7])-[C:8]',
                                                                '[N;H0;+0:1]-[C:3](-[C:2])(-[O;H1;+0:4])-[O:5]-[C:6](=[O:7])-[C:8]>>[N;H0;+0:1]-[C:3](-[C:2])=[O;H1;+1:4].[O;H0;-1:5]-[C:6](=[O:7])-[C:8]'],
                                                   'pKa':[None,None],
                                                   'Description':'Tetrahedral intermediate collapse'},
                                                3:{'Templates':['[N;H1;+0:1]-[C:3](-[C:2])=[O;H1;+1:4].[O;H0;-1:5]-[C:6](=[O:7])-[C:8]>>[N;H1;+0:1]-[C:3](-[C:2])=[O;H0;+0:4].[O;H1;+0:5]-[C:6](=[O:7])-[C:8]',
                                                                '[N;H0;+0:1]-[C:3](-[C:2])=[O;H1;+1:4].[O;H0;-1:5]-[C:6](=[O:7])-[C:8]>>[N;H0;+0:1]-[C:3](-[C:2])=[O;H0;+0:4].[O;H1;+0:5]-[C:6](=[O:7])-[C:8]'],
                                                   'pKa':[None,None],
                                                   'Description':'Proton transfer'}}}},
('Hydroxy to triflyloxy',):{'Alcohol':{'Reagent':['[O]','[F]-[C](-[F])(-[F])-[S](=[O])(=[O])-[O]-[S](=[O])(=[O])-[C](-[F])(-[F])-[F]'],'Exclude_reagent':None,
                                      'Stages':{0:{'Templates':['[O;H1:1].[F:2]-[C:3](-[F:4])(-[F:5])-[S:6](=[O:7])(=[O:8])-[O:9]-[S:10](=[O:11])(=[O:12])-[C:13](-[F:14])(-[F:15])-[F:16]>>[O;H1;+1:1]-[S:6](-[O;H0;-1:7])(=[O:8])(-[C:3](-[F:2])(-[F:4])-[F:5])-[O:9]-[S:10](=[O:11])(=[O:12])-[C:13](-[F:14])(-[F:15])-[F:16]'],
                                                   'pKa':[None],
                                                   'Description':'Nucleophilic addition'},
                                                1:{'Templates':['[O;H1;+1:1]-[S:6](-[O;H0;-1:7])(=[O:8])(-[C:3](-[F:2])(-[F:4])-[F:5])-[O:9]-[S:10](=[O:11])(=[O:12])-[C:13](-[F:14])(-[F:15])-[F:16]>>[O;H1;+1:1]-[S:6](=[O;H0;+0:7])(=[O:8])(-[C:3](-[F:2])(-[F:4])-[F:5]).[O;H0;-1:9]-[S:10](=[O:11])(=[O:12])-[C:13](-[F:14])(-[F:15])-[F:16]'],
                                                   'pKa':[None],
                                                   'Description':'Formation of OTf-'},
                                                2:{'Templates':['[O;H1;+1:1]-[S:6](=[O;H0;+0:7])(=[O:8])(-[C:3](-[F:2])(-[F:4])-[F:5])>>[O;H0;+0:1]-[S:6](=[O;H0;+0:7])(=[O:8])(-[C:3](-[F:2])(-[F:4])-[F:5])'],
                                                   'pKa':[{'B':-5}],
                                                   'Description':'Deprotonation'}}}},
('Isothiocyanate + amine thiourea coupling',):{'Reaction':{'Reagent':['[S]=[C]=[N]','[N]'],'Exclude_reagent':None,
                                             'Stages':{0:{'Templates':['[N;H2:1].[S:2]=[C:3]=[N:4]>>[N;H2;+1:1]-[C:3](-[S;H0;-1:2])=[N:4]',
                                                                       '[N;H1:1].[S:2]=[C:3]=[N:4]>>[N;H1;+1:1]-[C:3](-[S;H0;-1:2])=[N:4]'],
                                                          'pKa':[None,None],
                                                          'Description':'Nucleophilic addition'},
                                                      1:{'Templates':['[N;H2;+1:1]-[C:3](-[S;H0;-1:2])=[N:4]>>[N;H2;+1:1]-[C:3](=[S;H0;+0:2])-[N;H0;-1:4]',
                                                                      '[N;H1;+1:1]-[C:3](-[S;H0;-1:2])=[N:4]>>[N;H1;+1:1]-[C:3](=[S;H0;+0:2])-[N;H0;-1:4]'],
                                                         'pKa':[None,None],
                                                         'Description':'Resonance'},
                                                      2:{'Templates':['[N;H2;+1:1]-[C:3](=[S;H0;+0:2])-[N;H0;-1:4]>>[N;H1;+0:1]-[C:3](=[S;H0;+0:2])-[N;H1;+0:4]',
                                                                      '[N;H1;+1:1]-[C:3](=[S;H0;+0:2])-[N;H0;-1:4]>>[N;H0;+0:1]-[C:3](=[S;H0;+0:2])-[N;H1;+0:4]'],
                                                         'pKa':[None,None],
                                                         'Description':'Proton transfer'}}}},
#add aldehyde to acid, don't see reaction with water though
('Aldehyde Swern oxidation',
 'Ketone Swern oxidation',):{'Reaction':{'Reagent':['[O]','[O]=[S](-[C])-[C]','[Cl]-[C](=[O])-[C](=[O])-[Cl]'],'Exclude_reagent':None,
                                        'Stages':{0:{'Templates':['[O:1]=[S:2](-[C;H3:3])-[C;H3:4].[Cl:5]-[C:6](=[O:7])-[C:8](=[O:9])-[Cl:10]>>[Cl:5]-[C:6](-[O;H0;+0:1]-[S;H0;+1:2](-[C;H3:3])-[C;H3:4])(-[O;H0;-1:7])-[C:8](=[O:9])-[Cl:10]'],
                                                     'pKa':[None],
                                                     'Description':'Nucleophilic addition'},
                                                1:{'Templates':['[Cl:5]-[C:6](-[O;H0;+0:1]-[S;H0;+1:2](-[C;H3:3])-[C;H3:4])(-[O;H0;-1:7])-[C:8](=[O:9])-[Cl:10]>>[Cl;H0;-1:5].[C:6](-[O;H0;+0:1]-[S;H0;+1:2](-[C;H3:3])-[C;H3:4])(=[O;H0;+0:7])-[C:8](=[O:9])-[Cl:10]'],
                                                   'pKa':[None],
                                                   'Description':'Tetrahedral intermediate collapse'},
                                                2:{'Templates':['[Cl;H0;-1:5].[C:6](-[O;H0;+0:1]-[S;H0;+1:2](-[C;H3:3])-[C;H3:4])(=[O;H0;+0:7])-[C:8](=[O:9])-[Cl:10]>>[Cl;H0;+0:5]-[S;H0;+1:2](-[C;H3:3])-[C;H3:4].[O;H0;+0:1]=[C:6]=[O;H0;+0:7].[C;H0;-1:8]#[O;H0;+1:9].[Cl;H0;-1:10]'],
                                                   'pKa':[None],
                                                   'Description':'Dimethylchloro sulfonium formation'},
                                                3:{'Templates':['[Cl;H0;+0:5]-[S;H0;+1:2](-[C;H3:3])-[C;H3:4].[O;H1;+0:11]-[C;H2:12]>>[Cl;H0;-1:5].[S;H0;+1:2](-[C;H3:3])(-[C;H3:4])-[O;H1;+1:11]-[C;H2:12]',
                                                                '[Cl;H0;+0:5]-[S;H0;+1:2](-[C;H3:3])-[C;H3:4].[O;H1;+0:11]-[C;H1:12]>>[Cl;H0;-1:5].[S;H0;+1:2](-[C;H3:3])(-[C;H3:4])-[O;H1;+1:11]-[C;H1:12]'],
                                                   'pKa':[None,None],
                                                   'Description':'Addition to sulfonium'},
                                                4:{'Templates':['[Cl;H0;-1:5].[S;H0;+1:2](-[C;H3:3])(-[C;H3:4])-[O;H1;+1:11]-[C;H2:12]>>[Cl;H1;+0:5].[S;H0;+1:2](-[C;H3:3])(-[C;H3:4])-[O;H0;+0:11]-[C;H2:12]',
                                                               '[Cl;H0;-1:5].[S;H0;+1:2](-[C;H3:3])(-[C;H3:4])-[O;H1;+1:11]-[C;H1:12]>>[Cl;H1;+0:5].[S;H0;+1:2](-[C;H3:3])(-[C;H3:4])-[O;H0;+0:11]-[C;H1:12]'],
                                                'pKa':[None,None],
                                                'Description':'Proton transfer'},

                                                5:{'Templates':[
                                                                '[S;H0;+1:2](-[C;H3:3])(-[C;H3:4])-[O;H0;+0:11]-[C;H2:12].[N;H0:13]>>[S;H0;+1:2](-[C;H2;-1:3])(-[C;H3:4])-[O;H0;+0:11]-[C;H2:12].[N;H1;+1:13]',
                                                                '[S;H0;+1:2](-[C;H3:3])(-[C;H3:4])-[O;H0;+0:11]-[C;H1:12].[N;H0:13]>>[S;H0;+1:2](-[C;H2;-1:3])(-[C;H3:4])-[O;H0;+0:11]-[C;H1:12].[N;H1;+1:13]'],
                                                   'pKa':[None,None],
                                                   'Description':'Sulfur ylide formation'},
                                                6:{'Templates':['[S;H0;+1:2](-[C;H2;-1:3])(-[C;H3:4])-[O;H0;+0:11]-[C;H2:12]>>[C;H3;+0:3]-[S;H0;+0:2]-[C;H3:4].[O;H0;+0:11]=[C;H1:12]',
                                                                '[S;H0;+1:2](-[C;H2;-1:3])(-[C;H3:4])-[O;H0;+0:11]-[C;H1:12]>>[C;H3;+0:3]-[S;H0;+0:2]-[C;H3:4].[O;H0;+0:11]=[C;H0:12]'],
                                                   'pKa':[None,None],
                                                   'Description':'Pseudo-pericyclic elimination'}}}},     
('Amide hydrolysis',):{'Base-catalyzed':{'Reagent':['[O]=[C]-[N]'],'Exclude_reagent':None,
                                        'Stages':{0:{'Templates':['[O:1]=[C:2]-[N;H2:3].[O;H1;-1:4]>>[O;H0;-1:1]-[C:2](-[O;H1;+0:4])-[N;H2;+0:3]',
                                                                  '[O:1]=[C:2]-[N;H1:3].[O;H1;-1:4]>>[O;H0;-1:1]-[C:2](-[O;H1;+0:4])-[N;H1;+0:3]',
                                                                  '[O:1]=[C:2]-[N;H0:3].[O;H1;-1:4]>>[O;H0;-1:1]-[C:2](-[O;H1;+0:4])-[N;H0;+0:3]'],
                                                      'pKa':[None,None,None],
                                                      'Description':'Nucleophilic addition'},
                                                1:{'Templates':['[O;H0;-1:1]-[C:2](-[O;H1;+0:4])-[N;H2;+0:3]>>[O;H0;-1:1]=[C:2](-[O;H1;+0:4]).[N;H2;-1:3]',
                                                               '[O;H0;-1:1]-[C:2](-[O;H1;+0:4])-[N;H1;+0:3]>>[O;H0;-1:1]=[C:2](-[O;H1;+0:4]).[N;H1;-1:3]',
                                                               '[O;H0;-1:1]-[C:2](-[O;H1;+0:4])-[N;H0;+0:3]>>[O;H0;-1:1]=[C:2](-[O;H1;+0:4]).[N;H0;-1:3]'],
                                                   'pKa':[None,None,None],
                                                   'Description':'Tetrahedral intermediate collapse'},
                                                2:{'Templates':['[N;H2;-1:3]>>[N;H3;+0:3]',
                                                               '[N;H1;-1:3]>>[N;H2;+0:3]',
                                                               '[N;H0;-1:3]>>[N;H1;+0:3]'],
                                                   'pKa':[{'A':35},{'A':35},{'A':35}],
                                                   'Description':'Proton transfer'}}},
                        'Acid-catalyzed':{'Reagent':['[O]=[C]-[N]'],'Exclude_reagent':None,
                                          'Stages':{0:{'Templates':['[O:1]=[C:2]-[N;H2:3]>>[O;H1;+1:1]=[C:2]-[N;H2:3]',
                                                                    '[O:1]=[C:2]-[N;H1:3]>>[O;H1;+1:1]=[C:2]-[N;H1:3]',
                                                                    '[O:1]=[C:2]-[N;H0:3]>>[O;H1;+1:1]=[C:2]-[N;H0:3]'],
                                                       'pKa':[{'A':-5},{'A':-5},{'A':-5}],
                                                       'Description':'Protonation'},
                                                   1:{'Templates':['[O;H1;+1:1]=[C:2]-[N;H2:3].[O;H2;+0:4]>>[O;H1;+0:1]-[C:2](-[N;H2;+0:3])-[O;H2;+1:4]',
                                                                   '[O;H1;+1:1]=[C:2]-[N;H1:3].[O;H2;+0:4]>>[O;H1;+0:1]-[C:2](-[N;H1;+0:3])-[O;H2;+1:4]',
                                                                   '[O;H1;+1:1]=[C:2]-[N;H0:3].[O;H2;+0:4]>>[O;H1;+0:1]-[C:2](-[N;H0;+0:3])-[O;H2;+1:4]'],
                                                      'pKa':[None,None,None],
                                                      'Description':'Nucleophilic addition'},
                                                   2:{'Templates':['[O;H1;+0:1]-[C:2](-[N;H2;+0:3])-[O;H2;+1:4]>>[O;H1;+0:1]-[C:2](-[N;H3;+1:3])-[O;H1;+0:4]',
                                                                   '[O;H1;+0:1]-[C:2](-[N;H1;+0:3])-[O;H2;+1:4]>>[O;H1;+0:1]-[C:2](-[N;H2;+1:3])-[O;H1;+0:4]',
                                                                   '[O;H1;+0:1]-[C:2](-[N;H0;+0:3])-[O;H2;+1:4]>>[O;H1;+0:1]-[C:2](-[N;H1;+1:3])-[O;H1;+0:4]'],
                                                      'pKa':[None,None,None],
                                                      'Description':'Proton transfer'},
                                                   3:{'Templates':['[O;H1;+0:1]-[C:2](-[N;H3;+1:3])-[O;H1;+0:4]>>[O;H1;+1:1]=[C:2]-[O;H1;+0:4].[N;H3;+0:3]',
                                                                   '[O;H1;+0:1]-[C:2](-[N;H2;+1:3])-[O;H1;+0:4]>>[O;H1;+1:1]=[C:2]-[O;H1;+0:4].[N;H2;+0:3]',
                                                                   '[O;H1;+0:1]-[C:2](-[N;H1;+1:3])-[O;H1;+0:4]>>[O;H1;+1:1]=[C:2]-[O;H1;+0:4].[N;H1;+0:3]'],
                                                      'pKa':[None,None,None],
                                                      'Description':'Tetrahedral intermediate collapse'},
                                                   4:{'Templates':['[O;H1;+1:1]=[C:2]-[O;H1;+0:4].[N;H3;+0:3]>>[O;H0;+0:1]=[C:2]-[O;H1;+0:4].[N;H4;+1:3]',
                                                                   '[O;H1;+1:1]=[C:2]-[O;H1;+0:4].[N;H2;+0:3]>>[O;H0;+0:1]=[C:2]-[O;H1;+0:4].[N;H3;+1:3]',
                                                                   '[O;H1;+1:1]=[C:2]-[O;H1;+0:4].[N;H1;+0:3]>>[O;H0;+0:1]=[C:2]-[O;H1;+0:4].[N;H2;+1:3]'],
                                                      'pKa':[None,None,None],
                                                      'Description':'Proton transfer'}}}},
('Carboxylic acid + hydrazine condensation',):{'Neutral':{'Reagent':['[O]=[C]-[O]','[N]-[N]'],'Exclude_reagent':None,
                                                         'Stages':{0:{'Templates':['[O:1]=[C:2]-[O;H1:3].[N;H2:4]-[N;H2:5]>>[O;H0;-1:1]-[C:2](-[O;H1:3])-[N;H2;+1:4]-[N;H2:5]',
                                                                                   '[O:1]=[C:2]-[O;H1:3].[N;H2:4]-[N;H1:5]>>[O;H0;-1:1]-[C:2](-[O;H1:3])-[N;H2;+1:4]-[N;H1:5]',
                                                                                   '[O:1]=[C:2]-[O;H1:3].[N;H2:4]-[N;H0:5]>>[O;H0;-1:1]-[C:2](-[O;H1:3])-[N;H2;+1:4]-[N;H0:5]',
                                                                                   '[O:1]=[C:2]-[O;H1:3].[N;H1:4]-[N;H2:5]>>[O;H0;-1:1]-[C:2](-[O;H1:3])-[N;H1;+1:4]-[N;H2:5]',
                                                                                   '[O:1]=[C:2]-[O;H1:3].[N;H1:4]-[N;H1:5]>>[O;H0;-1:1]-[C:2](-[O;H1:3])-[N;H1;+1:4]-[N;H1:5]',
                                                                                   '[O:1]=[C:2]-[O;H1:3].[N;H1:4]-[N;H0:5]>>[O;H0;-1:1]-[C:2](-[O;H1:3])-[N;H1;+1:4]-[N;H0:5]'],
                                                                      'pKa':[None,None,None,None,None,None],
                                                                      'Description':'Nucleophilic addition'},
                                                                  1:{'Templates':['[O;H0;-1:1]-[C:2](-[O;H1:3])-[N;H2;+1:4]-[N;H2:5]>>[O;H1;+0:1]-[C:2](-[O;H1:3])-[N;H1;+0:4]-[N;H2:5]',
                                                                                  '[O;H0;-1:1]-[C:2](-[O;H1:3])-[N;H2;+1:4]-[N;H1:5]>>[O;H1;+0:1]-[C:2](-[O;H1:3])-[N;H1;+0:4]-[N;H1:5]',
                                                                                  '[O;H0;-1:1]-[C:2](-[O;H1:3])-[N;H2;+1:4]-[N;H0:5]>>[O;H1;+0:1]-[C:2](-[O;H1:3])-[N;H1;+0:4]-[N;H0:5]',
                                                                                  '[O;H0;-1:1]-[C:2](-[O;H1:3])-[N;H1;+1:4]-[N;H2:5]>>[O;H1;+0:1]-[C:2](-[O;H1:3])-[N;H0;+0:4]-[N;H2:5]',
                                                                                  '[O;H0;-1:1]-[C:2](-[O;H1:3])-[N;H1;+1:4]-[N;H1:5]>>[O;H1;+0:1]-[C:2](-[O;H1:3])-[N;H0;+0:4]-[N;H1:5]',
                                                                                  '[O;H0;-1:1]-[C:2](-[O;H1:3])-[N;H1;+1:4]-[N;H0:5]>>[O;H1;+0:1]-[C:2](-[O;H1:3])-[N;H0;+0:4]-[N;H0:5]'],
                                                                     'pKa':[None,None,None,None,None,None],
                                                                     'Description':'Proton transfer'},
                                                                  2:{'Templates':['[O;H1;+0:1]-[C:2](-[O;H1:3])-[N;H1;+0:4]-[N;H2:5]>>[O;H1;+1:1]=[C:2]-[N;H1;+0:4]-[N;H2:5].[O;H1;-1:3]',
                                                                                  '[O;H1;+0:1]-[C:2](-[O;H1:3])-[N;H1;+0:4]-[N;H1:5]>>[O;H1;+1:1]=[C:2]-[N;H1;+0:4]-[N;H1:5].[O;H1;-1:3]',
                                                                                  '[O;H1;+0:1]-[C:2](-[O;H1:3])-[N;H1;+0:4]-[N;H0:5]>>[O;H1;+1:1]=[C:2]-[N;H1;+0:4]-[N;H0:5].[O;H1;-1:3]',
                                                                                  '[O;H1;+0:1]-[C:2](-[O;H1:3])-[N;H0;+0:4]-[N;H2:5]>>[O;H1;+1:1]=[C:2]-[N;H0;+0:4]-[N;H2:5].[O;H1;-1:3]',
                                                                                  '[O;H1;+0:1]-[C:2](-[O;H1:3])-[N;H0;+0:4]-[N;H1:5]>>[O;H1;+1:1]=[C:2]-[N;H0;+0:4]-[N;H1:5].[O;H1;-1:3]',
                                                                                  '[O;H1;+0:1]-[C:2](-[O;H1:3])-[N;H0;+0:4]-[N;H0:5]>>[O;H1;+1:1]=[C:2]-[N;H0;+0:4]-[N;H0:5].[O;H1;-1:3]'],
                                                                     'pKa':[None,None,None,None,None,None],
                                                                     'Description':'Tetrahedral intermediate collapse'},
                                                                  3:{'Templates':['[O;H1;+1:1]=[C:2]-[N;H1;+0:4]-[N;H2:5].[O;H1;-1:3]>>[O;H0;+0:1]=[C:2]-[N;H1;+0:4]-[N;H2:5].[O;H2;+0:3]',
                                                                                  '[O;H1;+1:1]=[C:2]-[N;H1;+0:4]-[N;H1:5].[O;H1;-1:3]>>[O;H0;+0:1]=[C:2]-[N;H1;+0:4]-[N;H1:5].[O;H2;+0:3]',
                                                                                  '[O;H1;+1:1]=[C:2]-[N;H1;+0:4]-[N;H0:5].[O;H1;-1:3]>>[O;H0;+0:1]=[C:2]-[N;H1;+0:4]-[N;H0:5].[O;H2;+0:3]',
                                                                                  '[O;H1;+1:1]=[C:2]-[N;H0;+0:4]-[N;H2:5].[O;H1;-1:3]>>[O;H0;+0:1]=[C:2]-[N;H0;+0:4]-[N;H2:5].[O;H2;+0:3]',
                                                                                  '[O;H1;+1:1]=[C:2]-[N;H0;+0:4]-[N;H1:5].[O;H1;-1:3]>>[O;H0;+0:1]=[C:2]-[N;H0;+0:4]-[N;H1:5].[O;H2;+0:3]',
                                                                                  '[O;H1;+1:1]=[C:2]-[N;H0;+0:4]-[N;H0:5].[O;H1;-1:3]>>[O;H0;+0:1]=[C:2]-[N;H0;+0:4]-[N;H0:5].[O;H2;+0:3]'],
                                                                     'pKa':[None,None,None,None,None,None],
                                                                     'Description':'Proton transfer'}}}},

('Oxo to hydroxyimino',):{'Neutral':{'Reagent':['[O]=[C]','[NH2]-[OH]'],'Exclude_reagent':None,
                                    'Stages':{0:{'Templates':['[O:1]=[C:2].[N;H2:3]-[O;H1:4]>>[O;H0;-1:1]-[C:2](-[N;H2;+1:3]-[O;H1;+0:4])'],
                                                 'pKa':[None],
                                                 'Description':'Nucleophilic addition'},
                                             1:{'Templates':['[O;H0;-1:1]-[C:2](-[N;H2;+1:3]-[O;H1;+0:4])>>[O;H1;+0:1]-[C:2](-[N;H1;+0:3]-[O;H1;+0:4])'],
                                                'pKa':[None],
                                                'Description':'Proton transfer'},
                                             2:{'Templates':['[O;H1;+0:1]-[C:2](-[N;H1;+0:3]-[O;H1;+0:4])>>[O;H1;-1:1].[C:2]=[N;H1;+1:3]-[O;H1;+0:4]'],
                                                'pKa':[None],
                                                'Description':'Tetrahedral intermediate collapse'},
                                             3:{'Templates':['[O;H1;-1:1].[C:2]=[N;H1;+1:3]-[O;H1;+0:4]>>[O;H2;+0:1].[C:2]=[N;H0;+0:3]-[O;H1;+0:4]'],
                                                'pKa':[None],
                                                'Description':'Proton transfer'}}}}                                                                                                                                                                                                                                                                                                                                                                  
}
